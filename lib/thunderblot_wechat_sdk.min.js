!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.wechatclient=t()}}(function(){var t;return function t(e,n,i){function r(s,o){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!o&&u)return u(s,!0);if(a)return a(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var h=n[s]={exports:{}};e[s][0].call(h.exports,function(t){var n=e[s][1][t];return r(n||t)},h,h.exports,t,e,n,i)}return n[s].exports}for(var a="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){var n=[],i=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{!i&&o.return&&o.return()}finally{if(r)throw a}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=t("./utils/logger"),u=i(o),l=t("./protobase/uri"),h=i(l),f=t("./protocol/streamSvr/PAnchorStartLive"),c=i(f),d=t("./protocol/streamSvr/PAnchorStartLiveRes"),p=i(d),v=t("./protocol/streamSvr/PAnchorStopLive"),_=i(v),S=t("./protocol/streamSvr/PAnchorStopLiveRes"),y=i(S),m=t("./protobase/ProtoUInt64"),I=i(m),g=t("./utils/timeUtil"),b=i(g),E=t("./protocol/streamSvr/StreamSvrEnum"),A=t("./protocol/streamSvr/StreamAttrDescript"),R=i(A),w=t("./protocol/streamSvr/PS3ChannelPushMsg"),U=i(w),P=t("./protocol/streamSvr/PQueryChannelStreams"),T=i(P),C=t("./protocol/streamSvr/PQueryChannelStreamsRes"),M=i(C),k=t("./apchannel/ApH5"),N=i(k),O=t("long"),L=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(O),x=function(){function t(e,n,i){r(this,t),this.sdk=e,this.appid=n,this.uid=i,this.startNotify=!1,this.isOwnerChannel=!0,this.isUNIQChannel=!1,this.handleDic=new Map,this.forwardLive=new Map,this.audioForward=new Map,this.videoForward=new Map,this.subStreamInfo=new Map,this.addHandle(h.default.URI_STEAM_PAnchorStartLiveRes,this.onPAnchorStartLiveRes.bind(this)),this.addHandle(h.default.URI_STEAM_PAnchorStopLiveRes,this.onPAnchorStopLiveRes.bind(this)),this.addHandle(h.default.URI_STEAM_PQueryChannelStreamsRes,this.onPQueryChannelStreamsRes.bind(this)),this.checkTimes=0,this.running=!1}return s(t,[{key:"onCheckTimer",value:function(t){this.checkTimes++;var e=b.default.now();this.checkTimes%5==0&&this.startNotify&&(this.notifyLive(),this.notifyForwardLive()),this.apH5.onCheckTimer(this.checkTimes,e)}},{key:"checkNotify",value:function(){this.startNotify&&this.notifyLive()}},{key:"addHandle",value:function(t,e){this.handleDic.set(t,e)}},{key:"onProto",value:function(t,e){var n=this.handleDic.get(t);null!==n&&void 0!==n?n(e):u.default.log("StreamSvr.onProto UNKNOWN uri="+t)}},{key:"onPAnchorStartLiveRes",value:function(t){var e=new p.default;e.unmarshall(t),u.default.debug("StreamSvr.onPAnchorStartLiveRes result:"+e.result+" channelId:"+e.channelId+" ctxId:"+JSON.stringify(e.ctxId)+" stream size:"+e.streams.size),e.result&&u.default.info("StreamSvr.onPAnchorStartLiveRes result:"+e.result+" channelId:"+e.channelId+" ctxId:"+JSON.stringify(e.ctxId)+" stream size:"+e.streams.size)}},{key:"onPAnchorStopLiveRes",value:function(t){var e=new y.default;e.unmarshall(t),u.default.info("StreamSvr.onPAnchorStopLiveRes result:"+e.result+" channelId:"+e.channelId+" ctxId:"+JSON.stringify(e.ctxId))}},{key:"onPQueryChannelStreamsRes",value:function(t){var e=new M.default;e.unmarshall(t),u.default.info("StreamSvr.onPQueryChannelStreamsRes: "+JSON.stringify(e));var n=e.appid.low;return this.sdk.trigger("join_room_succ",null),n!=this.appid?void u.default.info("StreamSvr.onPQueryChannelStreamsRes invaild appid:"+n):e.channelId!=this.sdk.channelId?void u.default.info("StreamSvr.onPQueryChannelStreamsRes this channelId:"+e.channelId+" has not subscribe"):void this.updateChannelStreams(n,e.userStreams,e.speakers)}},{key:"onPS3ChannelPushMsg",value:function(t){var e=new U.default;e.unmarshall(t),u.default.debug("StreamSvr.onPS3ChannelPushMsg: "+JSON.stringify(e));var n=e.appid.low;return n!=this.appid?void u.default.info("StreamSvr.onPS3ChannelPushMsg invaild appid:"+n):e.channelId!=this.sdk.channelId?void u.default.info("StreamSvr.onPS3ChannelPushMsg this channelId:"+e.channelId+" has not subscribe"):void this.updateChannelStreams(n,e.userStreams,e.speakers)}},{key:"updateChannelStreams",value:function(t,e,n){var i=this.uid,r=new Map,s=!0,o=!1,l=void 0;try{for(var h,f=e[Symbol.iterator]();!(s=(h=f.next()).done);s=!0){var c=a(h.value,2),d=c[0],p=c[1],v=p.uid.low;if(v!=i)if(r.has(v)){var _=r.get(v);_.set(d,p),r.set(v,_)}else{var _=new Map;_.set(d,p),r.set(v,_)}}}catch(t){o=!0,l=t}finally{try{!s&&f.return&&f.return()}finally{if(o)throw l}}var S=this.subStreamInfo,y=!0,m=!1,I=void 0;try{for(var g,b=r[Symbol.iterator]();!(y=(g=b.next()).done);y=!0){var E=a(g.value,2),A=E[0],_=E[1];if(S.has(A)){var R=!1,w=!0,U=!1,P=void 0;try{for(var T,C=_[Symbol.iterator]();!(w=(T=C.next()).done);w=!0){var M=a(T.value,2),k=M[0],N=M[1];S.get(A).has(k)||(this.sdk.isSubInfo(A,N.streamType)&&(R=!0),S.get(A).set(k,N))}}catch(t){U=!0,P=t}finally{try{!w&&C.return&&C.return()}finally{if(U)throw P}}var O=!0,L=!1,x=void 0;try{for(var D,H=S.get(A)[Symbol.iterator]();!(O=(D=H.next()).done);O=!0){var K=a(D.value,2),k=K[0],N=K[1];_.has(k)||(this.sdk.isSubInfo(A,N.streamType)&&(R=!0),S.get(A).delete(k))}}catch(t){L=!0,x=t}finally{try{!O&&H.return&&H.return()}finally{if(L)throw x}}R&&this.sdk.updateSubscribeInfo(A,_)}else S.set(A,_),this.sdk.addSubscribeInfo(A)}}catch(t){m=!0,I=t}finally{try{!y&&b.return&&b.return()}finally{if(m)throw I}}var V=!0,Y=!1,j=void 0;try{for(var B,G=S[Symbol.iterator]();!(V=(B=G.next()).done);V=!0){var q=a(B.value,2),A=q[0],_=q[1];r.has(A)||(S.delete(A),this.sdk.removeSubscribeInfo(A))}}catch(t){Y=!0,j=t}finally{try{!V&&G.return&&G.return()}finally{if(Y)throw j}}u.default.debug("StreamSvr updateChannelStreams subStreamInfo size: "+this.subStreamInfo.size)}},{key:"getAnchorStreamInfobyUid",value:function(t){if(u.default.debug("StreamSvr getAnchorStreamInfobyUid: "+t),this.subStreamInfo.has(t)){return this.subStreamInfo.get(t)}}},{key:"start",value:function(t){if(this.running)return void u.default.info("StreamSvr start() channelId: "+t+", already started!");u.default.info("StreamSvr.start chanenlId: "+t),this.channelId=t,this.apH5=new N.default(this,this.appid,this.channelId,this.uid,1111),this.apH5.start(),this.checkTimer=setInterval(this.onCheckTimer.bind(this),1e3),this.running=!0}},{key:"stop",value:function(){u.default.info("StreamSvr.stop"),clearInterval(this.checkTimer),this.stopLive(),this.clearForwardLive(),this.apH5&&this.apH5.stop(),this.running=!1}},{key:"updateLiveVersion",value:function(){var t=L.fromString(Date.now().toString());this.Liveversion=new I.default(t.high,t.low)}},{key:"startLive",value:function(t,e,n,i,r){u.default.info("StreamSvr.startLive channelId:"+this.channelId+" groupName:"+n+" videoName:"+e+" audioName:"+t+" videoParam:"+JSON.stringify(i)+" audioParam:"+JSON.stringify(r)),this.ownerVideoParam=i,this.ownerAudioParam=r,this.audioStreamName=t,this.videoStreamName=e,this.isOwnerChannel=!0,this.isUNIQChannel=!1,this.groupName=n,this.startNotify=!0,this.updateLiveVersion(),this.notifyLive()}},{key:"addForwardLive",value:function(t,e,n){u.default.info("StreamSvr.addFowrardLive channelId:"+t+" videoParam:"+e+" audioParam:"+n);var i=new c.default,r=this.uid,a=this.appid;if(i.uid=new I.default(0,r),i.appid=new I.default(0,a),i.version=new I.default(0,Date.now()),i.channelId=t,i.userInfo.userParam.set(E.ChannelUserKeyEnum.CHANNEL_USER_KEY_ROOM_ID,t),i.userInfo.userParam.set(E.ChannelUserKeyEnum.CHANNEL_USER_KEY_IS_OWNER,"1"),i.userInfo.userParam.set(E.ChannelUserKeyEnum.CHANNEL_USER_KEY_UNIQ_CHANNEL,"1"),e&&this.videoStreamName&&""!=this.videoStreamName){this.videoForward[t]=e;var s=this.videoForward[t],o=s.height,l=s.width,h=s.bit_rate,f=s.frame_rate,d=new R.default;d.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_STREAM_NAME,this.videoStreamName),d.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_STREAM_TYPE,""+E.InputSourceTypeEnum.VIDEO),d.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_APPID,""+a),d.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_FRAME_RATE,""+f),d.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_BIT_RATE,""+h),d.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_HEIGHT,""+o),d.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_WIDTH,""+l),d.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_ENCODE_TYPE,""+E.CodecType.VIDEO_H264),i.streams.set(this.videoStreamName,d)}if(n&&this.audioStreamName&&""!=this.audioStreamName){this.audioForward[t]=n;var p=this.audioForward[t],h=p.bit_rate,v=p.sample_rate,_=p.channel,S=new R.default;S.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_STREAM_NAME,this.audioStreamName),S.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_STREAM_TYPE,""+E.InputSourceTypeEnum.AUDIO),S.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_APPID,""+a),S.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_BIT_RATE,""+h),S.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_ENCODE_TYPE,""+E.CodecType.MUSIC_OPUS),S.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_AUDIO_SAMPLE,""+v),S.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_AUDIO_CHANNEL,""+_),i.streams.set(this.audioStreamName,S)}i.speakers.push(i.uid),this.forwardLive.set(t,i)}},{key:"updateForwardlive",value:function(t,e,n){u.default.info("StreamSvr.updateForwardlive channelId:"+t),this.delForwardLive(t),this.addForwardLive(t,e,n)}},{key:"delForwardLive",value:function(t){u.default.info("StreamSvr.delForwardLive channelId:"+t),this.notifyStopForwardLive(t),delete this.forwardLive[t],delete this.videoForward[t],delete this.audioForward[t]}},{key:"clearForwardLive",value:function(){u.default.info("StreamSvr.clearForwardLive size:"+this.forwardLive.size);var t=!0,e=!1,n=void 0;try{for(var i,r=this.forwardLive[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var s=a(i.value,1),o=s[0];this.notifyStopForwardLive(o),this.delForwardLive(o)}}catch(t){e=!0,n=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw n}}}},{key:"notifyLive",value:function(){u.default.debug("StreamSvr.NotifyLive version:"+this.Liveversion.low+" channelId:"+this.channelId+" videoParam:"+JSON.stringify(this.ownerVideoParam)+" audioParam:"+JSON.stringify(this.ownerAudioParam));var t=new c.default,e=this.uid,n=this.appid;if(t.uid=new I.default(0,e),t.appid=new I.default(0,n),t.version=this.Liveversion,t.channelId=this.channelId,t.userInfo.userParam.set(E.ChannelUserKeyEnum.CHANNEL_USER_KEY_ROOM_ID,this.channelId),t.userInfo.userParam.set(E.ChannelUserKeyEnum.CHANNEL_USER_KEY_IS_OWNER,"1"),t.userInfo.userParam.set(E.ChannelUserKeyEnum.CHANNEL_USER_KEY_UNIQ_CHANNEL,"1"),this.videoStreamName&&""!=this.videoStreamName){var i=this.ownerVideoParam.width,r=this.ownerVideoParam.height,a=this.ownerVideoParam.bit_rate,s=this.ownerVideoParam.frame_rate,o=new R.default;o.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_STREAM_NAME,this.videoStreamName),o.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_STREAM_TYPE,""+E.InputSourceTypeEnum.VIDEO),o.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_APPID,""+n),o.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_FRAME_RATE,""+s),o.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_BIT_RATE,""+a),o.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_WIDTH,""+i),o.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_HEIGHT,""+r),o.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_ENCODE_TYPE,""+E.CodecType.VIDEO_H264),t.streams.set(this.videoStreamName,o)}if(this.audioStreamName&&""!=this.audioStreamName){var a=this.ownerAudioParam.bit_rate,l=this.ownerAudioParam.sample_rate,h=this.ownerAudioParam.channel,f=new R.default;f.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_STREAM_NAME,this.audioStreamName),f.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_STREAM_TYPE,""+E.InputSourceTypeEnum.AUDIO),f.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_APPID,""+n),f.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_BIT_RATE,""+a),f.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_ENCODE_TYPE,""+E.CodecType.MUSIC_OPUS),f.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_AUDIO_SAMPLE,""+l),f.attr.set(E.StreamAttrKeyEnum.STREAM_ATTR_KEY_AUDIO_CHANNEL,""+h),t.streams.set(this.audioStreamName,f)}t.speakers.push(t.uid),this.apH5&&this.apH5.sendStreamSvr(this.channelId,t.marshall())}},{key:"notifyForwardLive",value:function(){u.default.debug("StreamSvr.NotifyForwardLive :"+this.forwardLive.size);var t=!0,e=!1,n=void 0;try{for(var i,r=this.forwardLive[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var s=a(i.value,2),o=s[0],l=s[1];this.apH5&&this.apH5.sendStreamSvr(o,l.marshall())}}catch(t){e=!0,n=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw n}}}},{key:"stopLive",value:function(){1==this.startNotify&&(this.startNotify=!1,this.notifyStopLive())}},{key:"notifyStopLive",value:function(){u.default.info("StreamSvr.stopLive channelId:"+this.channelId);var t=new _.default,e=this.uid,n=this.appid;t.uid=new I.default(0,e),t.appid=new I.default(0,n);var i=L.fromString(Date.now().toString());t.version=new I.default(i.high,i.low),t.channelId=this.channelId,this.audioStreamName&&""!=this.audioStreamName&&t.streams.push(this.audioStreamName),this.videoStreamName&&""!=this.videoStreamName&&t.streams.push(this.videoStreamName),this.apH5&&this.apH5.sendStreamSvr(this.channelId,t.marshall())}},{key:"notifyStopForwardLive",value:function(t){u.default.info("StreamSvr.stopForwardLive channelId:"+this.channelId);var e=new _.default,n=this.uid,i=this.appid;e.uid=new I.default(0,n),e.appid=new I.default(0,i),e.version=new I.default(0,Date.now()),e.channelId=t,e.streams.push(this.audioStreamName),e.streams.push(this.videoStreamName),this.apH5&&this.apH5.sendStreamSvr(t,e.marshall())}},{key:"queryChannel",value:function(){var t=new T.default;t.appid=new I.default(0,this.appid),t.channelId=this.channelId,t.fromUid=new I.default(0,this.uid),u.default.info("StreamSvr.queryChannel:"+JSON.stringify(t)),this.apH5&&this.apH5.sendStreamSvr(this.channelId,t.marshall())}},{key:"clearSubscribeInfo",value:function(){this.subStreamInfo.clear()}}]),t}();n.default=x,e.exports=n.default},{"./apchannel/ApH5":3,"./protobase/ProtoUInt64":7,"./protobase/uri":9,"./protocol/streamSvr/PAnchorStartLive":36,"./protocol/streamSvr/PAnchorStartLiveRes":37,"./protocol/streamSvr/PAnchorStopLive":38,"./protocol/streamSvr/PAnchorStopLiveRes":39,"./protocol/streamSvr/PQueryChannelStreams":40,"./protocol/streamSvr/PQueryChannelStreamsRes":41,"./protocol/streamSvr/PS3ChannelPushMsg":42,"./protocol/streamSvr/StreamAttrDescript":43,"./protocol/streamSvr/StreamSvrEnum":44,"./utils/logger":46,"./utils/timeUtil":47,long:50}],2:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i;n.ClientType=i,function(t){t[t.PC_YY=0]="PC_YY",t[t.WEB_YY=1]="WEB_YY",t[t.ANDROID_YY=2]="ANDROID_YY",t[t.IOS_YY=3]="IOS_YY",t[t.ALL_YY=4]="ALL_YY",t[t.WP_YY=5]="WP_YY",t[t.WEBSOCKET_YY_H5=8]="WEBSOCKET_YY_H5"}(i||(n.ClientType=i={}));var r;n.AP_LINK_STATE=r,function(t){t[t.FAILED=-1]="FAILED",t[t.INIT=0]="INIT",t[t.START=1]="START",t[t.CONNECTING=2]="CONNECTING",t[t.CONNECTED=3]="CONNECTED",t[t.READY=5]="READY",t[t.DISCONNECTING=6]="DISCONNECTING",t[t.NO_IP=7]="NO_IP"}(r||(n.AP_LINK_STATE=r={}));var a;n.SVR_CHAN_STATE=a,function(t){t[t.JOIN=1]="JOIN",t[t.JOINSUCC=2]="JOINSUCC",t[t.LEAVE=3]="LEAVE",t[t.LEAVESUCC=4]="LEAVESUCC"}(a||(n.SVR_CHAN_STATE=a={}));var s;n.LoginRetryProc=s,function(t){t[t.E_LOGIN_SUCCESS=0]="E_LOGIN_SUCCESS",t[t.E_INVALID=1]="E_INVALID",t[t.E_ALREADY_EXIST=2]="E_ALREADY_EXIST",t[t.E_USER_NOT_FOUND=3]="E_USER_NOT_FOUND"}(s||(n.LoginRetryProc=s={}));var o;n.RouteDataMask=o,function(t){t[t.ROUTE_SESSIONID_MASK=1]="ROUTE_SESSIONID_MASK",t[t.HASH_KEY_MASK=2]="HASH_KEY_MASK",t[t.ALLOC_SERVICE_MASK=4]="ALLOC_SERVICE_MASK"}(o||(n.RouteDataMask=o={}))},{}],3:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=t("./ApEnum"),o=t("../utils/logger"),u=i(o),l=t("./../protobase/ProtoUnmarshall"),h=i(l),f=t("../protocol/ap/PSvcPing"),c=i(f),d=t("../protocol/ap/PSvcLoginReq"),p=i(d),v=t("../protocol/ap/PSvcLogoutReq"),_=i(v),S=t("../protocol/ap/PSvcRouteReq"),y=i(S),m=t("../protocol/ap/PSvcRouteRes"),I=i(m),g=t("../protobase/uri"),b=i(g),E=t("../protocol/ap/PSvcSubsGroupReq"),A=i(E),R=t("../protocol/ap/PSvcLoginRes"),w=i(R),U=t("../protocol/ap/PSvcSubsGroupRes"),P=i(U),T=t("../protocol/ap/PSvcPong"),C=i(T),M=t("../protocol/ap/PSvcLogoutRes"),k=i(M),N=t("../utils/timeUtil"),O=i(N),L=t("../protocol/ap/PSvcBroadcast"),x=i(L),D=t("../utils/utils"),H=i(D),K=t("../utils/ProtoLink"),V=i(K),Y=function(){function t(e,n,i,a,o){r(this,t),this.label="ApH5",this.streamSvr=e,this.appid=n,this.channelId=i,this.channelIdhash=H.default.hash_string(this.appid+"-"+this.channelId),this.uid=a,this.svn=o,this.handleDic=new Map,this.linkState=s.AP_LINK_STATE.INIT,this.sendBuf=[],this.g_seq=0,this.instId=Math.round(4294967295*Math.random()),this.channState=s.SVR_CHAN_STATE.LEAVESUCC,this.joinContext={},this.leaveContext={},this.innerBcGroups={},this.tryCnt=0,this.addHandle(b.default.PSvcSubsGroupResURI,this.onPSvcSubsGroupRes.bind(this)),this.addHandle(b.default.PSvcLoginResURI,this.onPSvcLoginRes.bind(this)),this.addHandle(b.default.PSvcPongURI,this.onPSvcPong.bind(this)),this.addHandle(b.default.PSvcLogoutResURI,this.onPSvcLogoutRes.bind(this)),this.addHandle(b.default.PSvcBroadcastURI,this.onPSvcBroadcast.bind(this)),this.addHandle(b.default.PSvcRouteResURI,this.onPSvcRouteRes.bind(this))}return a(t,[{key:"destroy",value:function(){u.default.log("ApH5.destroy")}},{key:"onPSvcBroadcast",value:function(t){var e=new x.default;e.unmarshall(t);var n=e.groupType.toString64()+"_"+e.groupId.toString64();if(u.default.debug("ApH5.onPSvcBroadcast:"+e.toString()+" bcKey="+n),this.innerBcGroups[n]){var i=new Uint8Array(e.data.byteLength);i.set(e.data,0),e.data=null;var r=new DataView(i.buffer),a=new h.default(r);switch(a.uri){case b.default.URI_STEAM_PS3ChannelPushMsg:this.streamSvr.onPS3ChannelPushMsg(a)}}}},{key:"onPSvcLogoutRes",value:function(t){var e=new k.default;e.unmarshall(t),u.default.log("ApH5.onPSvcLogoutRes success."+JSON.stringify(e))}},{key:"onPSvcPong",value:function(t){u.default.debug("ApH5.onPSvcPong"),(new C.default).unmarshall(t),this.pingCnt=0}},{key:"onPSvcLoginRes",value:function(t){var e=new w.default;e.unmarshall(t),200==e.resCode?u.default.log("ApH5.onPSvcLoginRes success:"):(u.default.error("ApH5.onPSvcLoginRes error:"+JSON.stringify(e)),this.apLink?this.apLink.destroy():u.default.error("ApH5.onPSvcLoginRes link has close"))}},{key:"onPSvcSubsGroupRes",value:function(t){var e=new P.default;e.unmarshall(t),200==e.resCode?(u.default.log("ApH5.onPSvcSubsGroupRes success"),this.tryCnt=0,this.joinContext.context==e.context&&(u.default.log("ApH5.onPSvcSubsGroupRes join channel success"),this.channState===s.SVR_CHAN_STATE.JOIN&&(this.channState=s.SVR_CHAN_STATE.JOINSUCC),this.streamSvr.queryChannel(),this.streamSvr.checkNotify()),this.leaveContext.context==e.context&&(u.default.log("ApH5.onPSvcSubsGroupRes leave channel success"),this.linkState===s.SVR_CHAN_STATE.LEAVE&&(this.channState=s.SVR_CHAN_STATE.LEAVESUCC))):u.default.error("ApH5.onPSvcSubsGroupRes error:"+JSON.stringify(e))}},{key:"onPSvcRouteRes",value:function(t){var e=new I.default;e.unmarshall(t);var n=new Uint8Array(e.data.byteLength);n.set(e.data,0),e.data=null;var i=new DataView(n.buffer),r=new h.default(i);this.streamSvr.onProto(r.uri,r)}},{key:"getSeqId",value:function(){return this.g_seq+=1,this.g_seq}},{key:"start",value:function(){this.linkState=s.AP_LINK_STATE.START,this.connectAp()}},{key:"stop",value:function(){this.linkState=s.AP_LINK_STATE.INIT,this.leaveChannel(),this.apLink&&(this.apLink.destroy(),this.apLink=null)}},{key:"addHandle",value:function(t,e){this.handleDic.set(t,e)}},{key:"onProto",value:function(t,e){var n=this.handleDic.get(t);null!==n&&void 0!==n?n(e):u.default.log("ApH5.onProto UNKNOWN uri="+t)}},{key:"onCheckTimer",value:function(t,e){this.linkState!==s.AP_LINK_STATE.INIT&&(this.checkConnect(),this.checkPing(e,t),this.checkChannel(t),this.apLink&&this.apLink.onCheckTimer(e))}},{key:"checkPing",value:function(t,e){if(this.linkState===s.AP_LINK_STATE.READY&&e%5==0){if(this.pingCnt>=3)return u.default.warn("ApH5.onPingTimer ping time out"),this.apLink.destroy(),void(this.pingCnt=0);this.pingCnt++,this.ping(t)}}},{key:"checkConnect",value:function(){this.linkState==s.AP_LINK_STATE.DISCONNECTING&&this.connectAp()}},{key:"checkChannel",value:function(t){this.linkState==s.AP_LINK_STATE.READY&&t%5==0&&(this.channState===s.SVR_CHAN_STATE.JOIN&&(this.tryCnt++,this.joinContext={},this.joinChannelBc()),this.channState===s.SVR_CHAN_STATE.LEAVE&&(this.tryCnt++,this.leaveContext={},this.tryCnt>5&&(this.channState=s.SVR_CHAN_STATE.LEAVESUCC,this.tryCnt=0)))}},{key:"onConnected",value:function(){this.apLink&&(u.default.log("ApH5.onConnected"),this.linkState=s.AP_LINK_STATE.CONNECTED,this.linkState=s.AP_LINK_STATE.READY,this.joinChannel(),this.sendForTraceUser())}},{key:"onClose",value:function(){u.default.log("ApH5.onClosed"),this.linkState=s.AP_LINK_STATE.DISCONNECTING,this.apLink=null,this.clearSendBuf(),this.channState===s.SVR_CHAN_STATE.JOINSUCC&&(this.channState=s.SVR_CHAN_STATE.JOIN)}},{key:"onError",value:function(){u.default.log("ApH5.onError"),this.linkState=s.AP_LINK_STATE.DISCONNECTING,this.apLink=null,this.clearSendBuf(),this.channState===s.SVR_CHAN_STATE.JOINSUCC&&(this.channState=s.SVR_CHAN_STATE.JOIN)}},{key:"onData",value:function(t,e){var n=new h.default(e);switch(t){case 0:break;default:this.onProto(t,n)}}},{key:"ping",value:function(t){u.default.debug("ApH5.sendPing now:"+t);var e=new c.default;e.context=this.getSeqId().toString(),this.send(e.marshall())}},{key:"loginAp",value:function(){var t=new p.default,e=this.getSeqId();t.context=e.toString(),t.uid=this.uid,t.appid=this.appid,t.instId=this.instId,t.seqId=e,t.clientHeaders.set("SCKTerminal","web"),t.clientHeaders.set("SCKSvcSdkVer",this.svn.toString()),u.default.log("ApH5.loginAp start to login ap:"+JSON.stringify(t)),this.send(t.marshall())}},{key:"clearSendBuf",value:function(){this.sendBuf.length>500&&(this.sendBuf=[])}},{key:"flushBuf",value:function(){var t=this.sendBuf.length;if(0!=t){u.default.log("ApH5.flushBuf len="+t);for(var e=0;e<t;++e){var n=this.sendBuf[e];if(n.origin)this.send(n.data);else{var i=this.wrapApRouter(n);this.send(i.buf)}}}this.sendBuf=[]}},{key:"wrapApRouter",value:function(t){var e=t.appid,n=t.svcName,i=t.fnName,r=t.routeArgs,a=t.clientHeaders,s=t.protoType,o=new y.default;t.preAllocSeq?o.context=t.preAllocSeq:o.context=this.getSeqId().toString(),o.uid=0,o.appid=e,o.instId=this.instId,o.svcName=n,o.traceId="wetchatMini_"+o.instId.toString()+"_"+o.context,i&&(o.fnName=i),s&&(o.protoType=s),o.data=t.data,o.dataCRC=0,r&&(o.routeArgs=r),a&&(o.clientHeaders=a);var l=o.marshall();return u.default.debug("ApH5.wrapApRouter send service route request:"+o.toString()),{buf:l,seqId:o.context}}},{key:"send",value:function(t){this.apLink&&this.apLink.send(t)}},{key:"ready",value:function(){return this.apLink&&this.linkState==s.AP_LINK_STATE.READY}},{key:"sendApRouter",value:function(t){if(this.ready()){var e=this.wrapApRouter(t);this.send(e.buf)}else{var e=Object.assign({},t);e.preAllocSeq=this.getSeqId().toString(),e.fnName=t.fnName,e.uri=t.uri,this.sendBuf.push(e)}}},{key:"connectAp",value:function(){var e=this.appid,n=Math.floor(1e6*Math.random());this.ws="wss://"+t.kApHost+"/websocket?appid="+e+"&version="+encodeURIComponent(this.svn.toString())+"&uuid="+encodeURIComponent(n.toString()),this.apLink&&this.apLink.destroy(),this.apLink=new V.default(this),u.default.log("ApH5.connect start to connect ws server. url="+this.ws),this.linkState=s.AP_LINK_STATE.CONNECTING,this.apLink.connect(this.ws)}},{key:"subscribeBc",value:function(t){var e=this.getSeqId(),n=new A.default;n.context=e.toString(),n.appid=this.appid,t.subs&&(n.joinGroups=t.subs,this.joinContext={subReqStartTs:O.default.now(),context:n.context}),t.unsubs&&(n.leaveGroups=t.unsubs,this.leaveContext={subReqStartTs:O.default.now(),context:n.context}),u.default.log("ApH5.subscribeBc "+JSON.stringify(n));var i=n.marshall();if(this.ready())this.send(i);else{var r={data:i,origin:!0};this.sendBuf.push(r)}}},{key:"joinChannelBc",value:function(){var t=this.channelIdhash,e={subs:[{grpType:2147483686,grpId:t}]};this.innerBcGroups[H.default.number2ProtoUInt64(2147483686).toString64()+"_"+H.default.number2ProtoUInt64(this.channelIdhash).toString64()]=1,u.default.log("ApH5.joinChannelBc innerBcGroups="+JSON.stringify(this.innerBcGroups)),this.subscribeBc(e)}},{key:"leaveChannelBc",value:function(){var t=this.channelId,e={unsubs:[{grpType:2147483686,grpId:t}]};u.default.log("ApH5.leaveChannelBc"),this.subscribeBc(e)}},{key:"logoutAp",value:function(){var t=new _.default;t.context=this.getSeqId().toString(),t.uid=this.uid,t.appid=this.appid,t.instId=this.instId,u.default.log("ApH5.logout "+JSON.stringify(t)),this.send(t.marshall())}},{key:"joinChannel",value:function(){u.default.info("ApH5 join channel :"+this.channelId+" channelhash:"+this.channelIdhash),this.channState=s.SVR_CHAN_STATE.JOIN,this.joinChannelBc()}},{key:"sendForTraceUser",value:function(){u.default.debug("ApH5.sendForTraceUser:"),this.sendApRouter({appid:this.appid,svcName:"svcLog",fnName:this.uid.toString(),data:""})}},{key:"sendStreamSvr",value:function(t,e){var n=new Map;n.set("channelid",t),this.sendApRouter({appid:this.appid,svcName:"Service_SimpleStreamSvr",data:e,routeArgs:n})}},{key:"leaveChannel",value:function(){this.channState!=s.SVR_CHAN_STATE.JOINSUCC&&u.default.info("ApH5.leaveChannel has not join channel success :"+this.channelId),this.channState=s.SVR_CHAN_STATE.LEAVE,this.leaveChannelBc()}}]),t}();Y.kApHost="web-ap-service.jocloud.com",n.default=Y,e.exports=n.default},{"../protobase/uri":9,"../protocol/ap/PSvcBroadcast":16,"../protocol/ap/PSvcLoginReq":17,"../protocol/ap/PSvcLoginRes":18,"../protocol/ap/PSvcLogoutReq":19,"../protocol/ap/PSvcLogoutRes":20,"../protocol/ap/PSvcPing":21,"../protocol/ap/PSvcPong":22,"../protocol/ap/PSvcRouteReq":23,"../protocol/ap/PSvcRouteRes":24,"../protocol/ap/PSvcSubsGroupReq":25,"../protocol/ap/PSvcSubsGroupRes":26,"../utils/ProtoLink":45,"../utils/logger":46,"../utils/timeUtil":47,"../utils/utils":48,"./../protobase/ProtoUnmarshall":8,"./ApEnum":2}],4:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a,s=function(){function t(t,e){var n=[],i=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{!i&&o.return&&o.return()}finally{if(r)throw a}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=t("./utils/logger"),l=i(u),h=t("./utils/timeUtil"),f=i(h),c=t("./protobase/uri"),d=i(c),p=t("./protocol/PLiveAvpPing"),v=i(p),_=t("./protocol/PLiveAvpPingRes"),S=i(_),y=t("./utils/utils"),m=i(y),I=t("./protobase/ProtoUnmarshall"),g=i(I),b=t("./protocol/PLiveUpdateToken"),E=i(b),A=t("./protocol/PLiveSdkAuthResNotify"),R=i(A),w=t("./protocol/PLiveBizAuthResNotify"),U=i(w),P=t("./StreamSvr"),T=i(P),C=t("./protocol/rtmp/PRTMPLoginAvpProxy"),M=i(C),k=t("./protobase/ProtoUInt64"),N=i(k),O=t("./protocol/rtmp/PRTMPLoginAvpProxyRes"),L=i(O),x=t("./protocol/rtmp/PRTMPStartPublishRes"),D=i(x),H=t("./protocol/rtmp/PRTMPSubscribeRes"),K=i(H),V=t("./protocol/rtmp/PRTMPSubscribe"),Y=i(V),j=t("./protocol/streamSvr/AnchorStreamInfo"),B=i(j),G=t("./utils/ProtoLink"),q=i(G),J=t("eventemitter2"),F=t("./protocol/rtmp/PRTMPStartPublish"),W=i(F),z=t("./protocol/streamSvr/StreamSvrEnum"),Q=t("./protocol/PLiveLeaveAvpProxyTcp"),Z=i(Q);n.AVP_CONN_STATUS=a,function(t){t[t.INIT=0]="INIT",t[t.START=1]="START",t[t.CONNECTING=2]="CONNECTING",t[t.CONNECTED=3]="CONNECTED",t[t.LOGIN=4]="LOGIN",t[t.DISCONNECTED=5]="DISCONNECTED"}(a||(n.AVP_CONN_STATUS=a={}));var X=function(){function t(){r(this,t),this.label="ClientSdk",this.version="1.01",this.versionTime="2020-7-15 17:06",this.videoParam={width:400,height:600,frame_rate:24,bit_rate:1e3,codec:100},this.audioParam={sample_rate:44100,bit_rate:40,channel:2,codec:1},this.publish_param={},this.interact_param={},this.anchorStreamInfo=new Map,this.subStreamInfo=new Map,this.observer=new J.EventEmitter2,this.protoHandlers=new Map,this.protoHandlers.set(d.default.URI_RTMP_PRTMPLoginAvpProxyRes,this.onRTMPLoginAvpRes.bind(this)),this.protoHandlers.set(d.default.URI_AVP_PLiveSdkAuthResNotify,this.onSdkAuthResNotify.bind(this)),this.protoHandlers.set(d.default.URI_RTMP_PRTMPStartPublishRes,this.onRTMPStartPublishRes.bind(this)),this.protoHandlers.set(d.default.URI_RTMP_PRTMPSubscribeRes,this.onRTMPSubscribeRes.bind(this)),this.protoHandlers.set(d.default.URI_AVP_PLiveAvpPingRes,this.onAvpPingRes.bind(this)),this.protoHandlers.set(d.default.URI_AVP_PLiveBizAuthResNotify,this.onBizAuthResNotify.bind(this)),l.default.log("ClientSdk constructor sdk version:"+this.version+" time:"+this.versionTime)}return o(t,[{key:"init",value:function(t){var e=Number(t);if(isNaN(e)){var n={code:100,reason:"invalid appid"};return this.trigger("init_fail",n),void l.default.log("ClientSdk init appid err: "+e)}l.default.log("ClientSdk init appid: "+e),this.hasJoinChannel=!1,this.appid=e,this.uid=0,this.checkTimes=0,this.contraints={},this.avpConnStatus=a.INIT,this.ispublish=!1,this.connectTimeStamp=0}},{key:"destroy",value:function(){l.default.log("ClientSdk.destroy"),this.timer&&clearInterval(this.timer)}},{key:"on",value:function(t,e){this.observer.on(t,e)}},{key:"off",value:function(t,e){this.observer.removeListener(t,e)}},{key:"trigger",value:function(t){for(var e=this,n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];setTimeout(function(){return e.emit.apply(e,[t].concat(i))},0)}},{key:"emit",value:function(t){for(var e,n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];(e=this.observer).emit.apply(e,[t].concat(i))}},{key:"chooseUseArea",value:function(t){var e=2===t?"sslproxy.jocloud.com:4443":"sslproxy-rtc.jocloud.com:4443";l.default.debug("chooseUseArea, userArea: "+t+", baseUrl:"+e)
;var n="wss://"+e+"/livesystem/"+this.appid+"_"+this.channelId+".rvp?uid="+this.uid+"&uuid="+Math.floor(1e6*Math.random())+"&clientType=11&cfgK1=2&cfgV1=48&cfgK2=3&cfgV2=3&roomId="+this.channelId+"&sdkVersion=201905221525&clientAppid="+this.appid;return l.default.log("chooseUseArea, wss: "+n),this.wss=n,n}},{key:"connectAvp",value:function(){this.chooseUseArea(0),this.avpConnStatus!=a.CONNECTING?(this.link&&this.link.destroy(),this.link=new q.default(this),this.avpConnStatus=a.CONNECTING,this.connectTimeStamp=f.default.now(),this.link.connect(this.wss)):l.default.log("clientSdk.connect websocket is connecting...")}},{key:"start",value:function(){this.avpConnStatus=a.START,this.connectAvp(),this.timer=setInterval(this.onCheckTimer.bind(this),1e3),l.default.log("ClientSdk.start appid:"+this.appid+", uid:"+this.uid)}},{key:"stop",value:function(){this.sendLeaveRtmp(),this.avpConnStatus=a.INIT,this.link&&(this.link.destroy(),this.link=null),this.timer&&clearInterval(this.timer)}},{key:"send",value:function(t){!this.link||this.avpConnStatus!=a.CONNECTED&&this.avpConnStatus!=a.LOGIN?l.default.warn("clientSdk.send failed wsState="+this.avpConnStatus):this.link.send(t)}},{key:"checkAvpConn",value:function(){this.avpConnStatus==a.DISCONNECTED&&this.connectAvp()}},{key:"checkAvpPing",value:function(t,e){if(this.avpConnStatus==a.LOGIN&&e%5==0){if(this.pingCnt>=3)return l.default.warn("ClientSdk.onPingTimer ping time out"),void(this.pingCnt=0);l.default.debug("ClientSdk.sendPing"),this.pingCnt++,this.ping(t)}}},{key:"sendLeaveRtmp",value:function(){var t=new Z.default;t.appid=this.appid,t.uid=this.uid,this.send(t.marshall()),l.default.info("ClientSdk.sendLeaveRtmp:"+JSON.stringify(t))}},{key:"ping",value:function(t){this.pingCnt++;var e=new v.default;e.appid=this.appid,e.uid=this.uid,e.stampc=t,l.default.debug("ClientSdk.ping avp:"+JSON.stringify(e)),this.link.send(e.marshall())}},{key:"joinRoom",value:function(t){var e=t.uid,n=t.roomId,i=t.token;return"number"!=typeof e?void l.default.error("webrtc.joinRoom fail:Input uid Invalid: "+e):"string"!=typeof n||""===n?void l.default.error("webrtc.joinRoom fail: Input roomId Invalid: "+n):("string"==typeof i&&""!==i||l.default.info("webrtc.joinRoom fail: Input token Invalid: "+i),l.default.info("ClientSdk.joinRoom:"+JSON.stringify(t)),this.channelId=n,this.uid=e,this.liveToken=i,this.videoStreamName="v_"+this.uid+"_"+this.channelId+"_0_0",this.audioStreamName="a_"+this.uid+"_"+this.channelId+"_0_0",this.videoStreamKey=String(this.appid)+"_"+String(this.videoStreamName),this.audioStreamKey=String(this.appid)+"_"+String(this.audioStreamName),this.streamSvr=new T.default(this,this.appid,this.uid),this.start(),void(this.hasJoinChannel=!0))}},{key:"resetChannelId",value:function(){this.channelId="",this.audioStreamKey="",this.audioStreamName="",this.videoStreamKey="",this.videoStreamName="",this.ispublish=!1}},{key:"leaveRoom",value:function(){l.default.info("ClientSdk.leaveRoom"),this.unpublishMedia(),this.resetChannelId(),this.stop(),this.streamSvr&&this.streamSvr.stop(),this.clearSubscribe(),this.hasJoinChannel=!1,this.ispublish=!1}},{key:"stopLiveInteratct",value:function(){l.default.log("ClientSdk.stopLiveInteratct"),this.streamSvr.clearForwardLive()}},{key:"onConnected",value:function(){this.avpConnStatus=a.CONNECTED,l.default.log("ClientSdk.onConnected"),this.sendRTMPLogin()}},{key:"onData",value:function(t,e){var n=new g.default(e),i=this.protoHandlers.get(t);if(void 0!==i)i(n);else{if(3841288==t)return;l.default.log("ClientSdk.onData unknown uri="+(t>>8&4294967295)+"/"+(255&t))}}},{key:"onError",value:function(t){if(l.default.info("ClientSdk.onError avp status:"+this.avpConnStatus),null===this.link)return void l.default.info("ClientSdk.onError with err socket avp status:"+this.avpConnStatus);this.avpConnStatus!=a.INIT&&(this.avpConnStatus=a.DISCONNECTED),this.link=null}},{key:"onClose",value:function(){l.default.log("ClientSdk.onClose"),this.avpConnStatus!==a.INIT&&(this.avpConnStatus=a.DISCONNECTED),this.link=null}},{key:"onCheckTimer",value:function(){var t=f.default.now();this.checkTimes++,this.checkAvpConn(),this.checkAvpPing(t,this.checkTimes),this.link&&this.link.onCheckTimer(t)}},{key:"onAvpPingRes",value:function(t){var e=new S.default;e.unmarshall(t),this.pingCnt=0,this.connectTimeStamp=f.default.now(),l.default.debug("ClientSdk.onAvpPingRes proxyType="+e.peerType+" time="+e.stamps)}},{key:"sendRTMPLogin",value:function(){var t=new M.default;t.appid=new N.default(0,this.appid),t.uid=new N.default(0,this.uid),t.cookie="",t.audioCodecType=new Uint32Array(1),t.channelId=this.channelId,t.loginStamp=f.default.now(),t.proxyType=12,t.videoGroupId=54321,t.audioCodecType[0]=1,t.liveToken=this.liveToken,l.default.log("ClientSdk try to login:"+JSON.stringify(t)),this.send(t.marshall())}},{key:"onRTMPLoginAvpRes",value:function(t){var e=new L.default;e.unmarshall(t);var n=m.default.inet_ntoa(e.wlanIp),i=e.wlanPort;if(e.reject>0&&5!=e.reject)return l.default.log("ClientSdk.onRTMPLoginVpRes uid="+e.uid.low+" reject:"+e.reject+", close... selfIp="+n+" port:"+i),this.trigger("join_room_fail",{reason:"avp_reject"}),void this.leaveRoom();l.default.log("ClientSdk.onRTMPLoginVpRes appid="+e.appid.low+" uid="+e.uid.low+" reject="+e.reject+" selfIp="+n+" port:"+i),this.avpConnStatus=a.LOGIN,this.streamSvr.start(this.channelId),this.streamSvr.clearSubscribeInfo(),this.ispublish&&this.publishMedia(this.publish_param)}},{key:"publishMedia",value:function(t){if(l.default.info("ClientSdk.publishMedia param:"+JSON.stringify(t)),Object.assign(this.publish_param,t),this.anchorStreamInfo=new Map,this.publish_param.video){var e=new B.default;e.uid.low=this.uid,e.streamType=z.StreamTypeEnum.VIDEO_STREAM,e.codeRate=600,this.anchorStreamInfo.set(this.videoStreamName,e)}if(this.publish_param.audio){var n=new B.default;n.uid.low=this.uid,n.streamType=z.StreamTypeEnum.AUDIO_STREAM,n.codeRate=40,this.anchorStreamInfo.set(this.audioStreamName,n)}var i=new W.default;i.appid=new N.default(0,this.appid),i.speakerUid=new N.default(0,this.uid),i.isAudioGroup=!1,i.channelId=this.channelId,i.publishStreams=this.anchorStreamInfo,this.send(i.marshall()),l.default.log("ClientSdk.publishMedia"+JSON.stringify(i)),this.ispublish=!0}},{key:"enableLocalMedia",value:function(t){l.default.info("ClientSdk.enableLocalMedia:"+JSON.stringify(t)),t.video&&(this.publish_param.video=!0,this.publishMedia(this.publish_param)),t.audio&&(this.publish_param.audio=!0,this.publishMedia(this.publish_param))}},{key:"disableLocalMedia",value:function(t){if(l.default.info("ClientSdk.disableLocalMedia:"+JSON.stringify(t)),!this.ispublish)return void l.default.error("ClientSdk.disableLocalMedia has not publish");t.video&&(this.publish_param.video=!1,this.publish_param.audio?(this.publishMedia(this.publish_param),this.startLive()):this.unpublishMedia()),t.audio&&(this.publish_param.audio=!1,this.publish_param.video?this.startLive():this.unpublishMedia())}},{key:"disableRemoteMedia",value:function(t,e){l.default.log("ClientSdk.disableRemoteMedia uid:"+t+" param:"+JSON.stringify(e));var n=this.streamSvr.getAnchorStreamInfobyUid(Number(t));if(!n)return void l.default.log("ClientSdk.disableRemoteMedia uid has not published any stream in this channel: "+t);var i=this.subStreamInfo.get(Number(t));if(!i)return void l.default.log("ClientSdk.disableRemoteMedia uid has has not subscribe: "+t);i.has_video=!1,i.has_audio=!1,e.video&&(i.video=!1),e.audio&&(i.audio=!1);var r=new Map,a=!0,o=!1,u=void 0;try{for(var h,f=n[Symbol.iterator]();!(a=(h=f.next()).done);a=!0){var c=s(h.value,2),d=c[0],p=c[1];if(p.streamType===z.StreamTypeEnum.VIDEO_STREAM){if(e.video)continue;i.video&&(r.set(d,p),i.has_video=!0)}if(p.streamType===z.StreamTypeEnum.AUDIO_STREAM){if(e.audio)continue;i.audio&&(r.set(d,p),i.has_audio=!0)}}}catch(t){o=!0,u=t}finally{try{!a&&f.return&&f.return()}finally{if(o)throw u}}var v=new Y.default;v.appid=new N.default(0,this.appid),v.uid=new N.default(0,this.uid),v.subscribe=!0,v.isAudioGroup=!1,v.channelId=this.channelId;var _=new N.default(0,t);v.userStreams.set(_,r),this.send(v.marshall()),l.default.log("ClientSdk.disableRemoteMedia:"+JSON.stringify(v))}},{key:"enableRemoteMedia",value:function(t,e){l.default.log("ClientSdk.enableRemoteMedia:"+JSON.stringify(e));var n=this.streamSvr.getAnchorStreamInfobyUid(Number(t));if(!n)return void l.default.log("ClientSdk.enableRemoteMedia uid has not published any stream in this channel: "+t);var i=this.subStreamInfo.get(Number(t));if(!i)return void l.default.log("ClientSdk.enableRemoteMedia uid has has not subscribe: "+t);i.has_video=!1,i.has_audio=!1,e.video&&(i.video=!0),e.audio&&(i.audio=!0);var r=new Map,a=!0,o=!1,u=void 0;try{for(var h,f=n[Symbol.iterator]();!(a=(h=f.next()).done);a=!0){var c=s(h.value,2),d=c[0],p=c[1];p.streamType===z.StreamTypeEnum.VIDEO_STREAM&&e.video&&i.video&&(r.set(d,p),i.has_video=!0),p.streamType===z.StreamTypeEnum.AUDIO_STREAM&&e.audio&&(r.set(d,p),i.has_audio=!0)}}catch(t){o=!0,u=t}finally{try{!a&&f.return&&f.return()}finally{if(o)throw u}}var v=new Y.default;v.appid=new N.default(0,this.appid),v.uid=new N.default(0,this.uid),v.subscribe=!0,v.isAudioGroup=!1,v.channelId=this.channelId;var _=new N.default(0,t);v.userStreams.set(_,r),this.send(v.marshall()),l.default.log("ClientSdk.enableRemoteMedia:"+JSON.stringify(v))}},{key:"onRTMPStartPublishRes",value:function(t){var e=new D.default;e.unmarshall(t),l.default.log("ClientSdk.onRTMPStartPublishRes appid="+e.appid+" uid="+e.speakerUid+" rtmpUrl"+e.rtmpUrl),this.trigger("update_publish_url",{url:e.rtmpUrl}),this.startLive()}},{key:"startLive",value:function(){l.default.log("ClientSdk.startLive param:"+JSON.stringify(this.publish_param));var t=void 0,e=void 0,n=void 0,i=void 0;if(this.publish_param.audio&&(t=this.audioParam,n=this.audioStreamName),this.publish_param.video&&(e=this.videoParam,i=this.videoStreamName),this.streamSvr.startLive(n,i,"",e,t),this.interact_param.channelInfos){var r=!0,a=!1,s=void 0;try{for(var o,u=this.interact_param[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var h=o.value,f=h.channelId;this.streamSvr.updateForwardlive(f,e,t)}}catch(t){a=!0,s=t}finally{try{!r&&u.return&&u.return()}finally{if(a)throw s}}}}},{key:"unpublishMedia",value:function(){this.ispublish=!1,l.default.log("ClientSdk.unpublishMedia"),this.publish_param={},this.interact_param={},this.streamSvr&&(this.streamSvr.stopLive(),this.streamSvr.clearForwardLive())}},{key:"addSubscribeInfo",value:function(t){l.default.info("ClientSdk addSubscribeInfo uid: "+t),this.trigger("remote_stream_add",{uid:t})}},{key:"removeSubscribeInfo",value:function(t){t!=this.uid&&(l.default.info("ClientSdk.removeSubscribeInfo uid: "+t),this.trigger("remote_stream_remove",{uid:t}),this.subStreamInfo.delete(t))}},{key:"isSubInfo",value:function(t,e){var n=this.subStreamInfo.get(t);if(n){if(e===z.StreamTypeEnum.VIDEO_STREAM&&n.video)return!0;if(e===z.StreamTypeEnum.AUDIO_STREAM&&n.audio)return!0}return!1}},{key:"updateSubscribeInfo",value:function(t,e){l.default.log("ClientSdk.updateSubscribeInfo uid:"+t+", stream size:"+e.size);var n=this.subStreamInfo.get(t);n.has_video=!1,n.has_audio=!1;var i=new Y.default;i.appid=new N.default(0,this.appid),i.uid=new N.default(0,this.uid),i.subscribe=!0,i.isAudioGroup=!1,i.channelId=this.channelId;var r=new Map,a=!0,o=!1,u=void 0;try{for(var h,f=e[Symbol.iterator]();!(a=(h=f.next()).done);a=!0){var c=s(h.value,2),d=c[0],p=c[1];p.streamType===z.StreamTypeEnum.VIDEO_STREAM&&n.video&&(r.set(d,p),n.has_video=!0),p.streamType===z.StreamTypeEnum.AUDIO_STREAM&&n.audio&&(r.set(d,p),n.has_audio=!0)}}catch(t){o=!0,u=t}finally{try{!a&&f.return&&f.return()}finally{if(o)throw u}}var v=new N.default(0,t);i.userStreams.set(v,r),this.send(i.marshall())}},{key:"subscribeMedia",value:function(t){if(l.default.info("ClientSdk.subscribeMedia param:"+JSON.stringify(t)),!t.uid&&"number"!=typeof t.uid)return void l.default.error("ClientSdk.subscribeMedia fail: invalid uid ");var e=t.uid;if(e===this.uid)return void l.default.error("ClientSdk.subscribeMedia fail: unable to subscribe owner uid "+e);var n=this.streamSvr.getAnchorStreamInfobyUid(e);if(!n)return void l.default.error("ClientSdk.subscribeMedia uid has not published any stream in this channel: "+e);t.has_video=!1,t.has_audio=!1;var i=new Y.default;i.appid=new N.default(0,this.appid),i.uid=new N.default(0,this.uid),i.subscribe=!0,i.isAudioGroup=!1,i.channelId=this.channelId;var r=new N.default(0,e),a=new Map,o=!0,u=!1,h=void 0;try{for(var f,c=n[Symbol.iterator]();!(o=(f=c.next()).done);o=!0){var d=s(f.value,2),p=d[0],v=d[1];v.streamType===z.StreamTypeEnum.VIDEO_STREAM&&t.video&&(a.set(p,v),t.has_video=!0),v.streamType===z.StreamTypeEnum.AUDIO_STREAM&&t.audio&&(a.set(p,v),t.has_audio=!0)}}catch(t){u=!0,h=t}finally{try{!o&&c.return&&c.return()}finally{if(u)throw h}}i.userStreams.set(r,a);var _={};Object.assign(_,t),this.subStreamInfo.set(e,_),this.send(i.marshall()),l.default.debug("ClientSdk.subscribeMedia:"+JSON.stringify(i))}},{key:"unsubscribeMedia",value:function(t){if(l.default.info("ClientSdk.unsubscribeMedia param:"+JSON.stringify(t)),!t.uid&&"number"!=typeof t.uid)return void l.default.error("ClientSdk.unsubscribeMedia fail: invalid uid ");var e=t.uid;if(e===this.uid)return void l.default.error("ClientSdk.unsubscribeMedia fail: unable to unsubscribe owner uid "+e);this.subStreamInfo.delete(e)}},{key:"clearSubscribe",value:function(){l.default.info("ClientSdk.clearSubscribe");var t=!0,e=!1,n=void 0;try{for(var i,r=this.subStreamInfo[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var a=s(i.value,2),o=a[0];a[1];this.subStreamInfo.delete(o)}}catch(t){e=!0,n=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw n}}}},{key:"interactLive",value:function(t){if(l.default.info("ClientSdk.interactLive\tparam:"+JSON.stringify(t)),!this.ispublish)return void l.default.error("ClientSdk.interactLive fail: has not publish");this.interact_param=t;var e=!0,n=!1,i=void 0;try{for(var r,a=t.channelInfos[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value;l.default.info("ClientSdk.interactLive channelInfos:"+JSON.stringify(s));var o=s.channelId,u=void 0,h=void 0;this.publish_param.audio&&(u=this.videoParam),this.publish_param.video&&(h=this.audioParam),this.streamSvr.addForwardLive(o,u,h)}}catch(t){n=!0,i=t}finally{try{!e&&a.return&&a.return()}finally{if(n)throw i}}}},{key:"stopInteractLive",value:function(){this.streamSvr.clearForwardLive()}},{key:"onRTMPSubscribeRes",value:function(t){var e=new K.default;e.unmarshall(t),l.default.log("ClientSdk.onRTMPSubscribeRes="+JSON.stringify(e)+" size="+e.streamResInfos.size);var n=!0,i=!1,r=void 0;try{for(var a,o=e.streamResInfos[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=s(a.value,2),h=u[0],f=u[1],c=this.subStreamInfo.get(h.low);c&&(c.url=f.rtmpUrl,this.trigger("remote_stream_subscribed",c))}}catch(t){i=!0,r=t}finally{try{!n&&o.return&&o.return()}finally{if(i)throw r}}}},{key:"checkSendUpdateToken",value:function(){if(l.default.log("ClientSdk updateSdkToken, token:"+this.liveToken),""!==this.liveToken){var t=new E.default;t.appid=this.appid,t.uid=this.uid,t.token=this.liveToken,this.link.send(t.marshall())}}},{key:"onSdkAuthResNotify",value:function(t){var e=new R.default;e.unmarshall(t),l.default.log("ClientSdk.onSdkAuthResNotify uid:"+e.uid+", result:"+e.sdkAuthResult),e.sdkAuthResult}},{key:"onBizAuthResNotify",value:function(t){(new U.default).unmarshall(t)}},{key:"setLoggerLevel",value:function(t){l.default.setLevel(t)}}]),t}();n.ClientSdk=X,n.default=X},{"./StreamSvr":1,"./protobase/ProtoUInt64":7,"./protobase/ProtoUnmarshall":8,"./protobase/uri":9,"./protocol/PLiveAvpPing":10,"./protocol/PLiveAvpPingRes":11,"./protocol/PLiveBizAuthResNotify":12,"./protocol/PLiveLeaveAvpProxyTcp":13,"./protocol/PLiveSdkAuthResNotify":14,"./protocol/PLiveUpdateToken":15,"./protocol/rtmp/PRTMPLoginAvpProxy":27,"./protocol/rtmp/PRTMPLoginAvpProxyRes":28,"./protocol/rtmp/PRTMPStartPublish":29,"./protocol/rtmp/PRTMPStartPublishRes":30,"./protocol/rtmp/PRTMPSubscribe":32,"./protocol/rtmp/PRTMPSubscribeRes":33,"./protocol/streamSvr/AnchorStreamInfo":34,"./protocol/streamSvr/StreamSvrEnum":44,"./utils/ProtoLink":45,"./utils/logger":46,"./utils/timeUtil":47,"./utils/utils":48,eventemitter2:49}],5:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]||arguments[0];i(this,t),this.hasHeader=e,this.segments=[],this.data=null,this.totalLen=0,this.uri=0,this.hasHeader&&(this.pushUInt32(10),this.pushUInt32(this.uri),this.pushUInt16(200))}return r(t,[{key:"destroy",value:function(){}},{key:"marshall",value:function(){if(0===this.segments.length)return null;this.data=new Uint8Array(this.totalLen);for(var t=0,e=0;e<this.segments.length;++e){var n=this.segments[e];this.data.set(n,t),t+=n.length}return this.hasHeader&&(this.replaceUInt32(0,this.totalLen),this.replaceUInt32(4,this.uri)),this.data}},{key:"setUri",value:function(t){this.uri=t}},{key:"replaceUInt32",value:function(t,e){new DataView(this.data.buffer).setUint32(t,e,!0)}},{key:"pushUInt8",value:function(t){var e=new Uint8Array(1);new DataView(e.buffer).setUint8(0,t),this.segments.push(e),this.totalLen++}},{key:"pushBool",value:function(t){this.pushUInt8(t?1:0)}},{key:"pushUInt16",value:function(t){var e=new Uint8Array(2);new DataView(e.buffer).setUint16(0,t,!0),this.segments.push(e),this.totalLen+=2}},{key:"pushUInt32",value:function(t){var e=new Uint8Array(4);new DataView(e.buffer).setUint32(0,t,!0),this.segments.push(e),this.totalLen+=4}},{key:"pushUInt64",value:function(t){var e=new Uint8Array(8),n=new DataView(e.buffer);n.setUint32(0,t.low,!0),n.setUint32(4,t.high,!0),this.segments.push(e),this.totalLen+=8}},{key:"pushUGID",value:function(t){this.pushUInt16(12),this.pushUInt32(t.sid),this.pushUInt32(t.appId),this.pushUInt32(t.channelId)}},{key:"pushUint8Array",value:function(t){this.pushUInt16(t.length),this.segments.push(t),this.totalLen+=t.length}},{key:"pushUint8ArrayWithoutLen",value:function(t){this.segments.push(t),this.totalLen+=t.length}},{key:"pushUint8Array32",value:function(t){this.pushUInt32(t.length),this.segments.push(t),this.totalLen+=t.length}},{key:"pushUIntArray",value:function(t){this.pushUInt32(t.length);for(var e=0;e<t.length;e++)this.pushUInt32(t[e])}},{key:"pushString",value:function(t){this.pushUInt16(t.length);for(var e=new Uint8Array(t.length),n=new DataView(e.buffer),i=0;i<t.length;++i)n.setUint8(i,t.charCodeAt(i));this.segments.push(e),this.totalLen+=t.length}},{key:"pushString32",value:function(t){this.pushUInt32(t.length);for(var e=new Uint8Array(t.length),n=new DataView(e.buffer),i=0;i<t.length;++i)n.setUint8(i,t.charCodeAt(i));this.segments.push(e),this.totalLen+=t.length}},{key:"pushUInt32AndUInt32Map",value:function(t){this.pushUInt32(t.size);var e=!0,n=!1,i=void 0;try{for(var r,a=t[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value;this.pushUInt32(s[0]),this.pushUInt32(s[1])}}catch(t){n=!0,i=t}finally{try{!e&&a.return&&a.return()}finally{if(n)throw i}}}}]),t}();n.default=a,e.exports=n.default},{}],6:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],n=arguments.length<=1||void 0===arguments[1]?0:arguments[1],r=arguments.length<=2||void 0===arguments[2]?0:arguments[2];i(this,t),this.sid=e,this.appId=n,this.channelId=r}return r(t,[{key:"fromString",value:function(t){if(this.sid=0,this.appId=0,this.channelId=0,-1!==t.toString().indexOf("-")){var e=t.split("-");return this.sid=parseInt(e[0])||0,this.appId=parseInt(e[1])||0,this.channelId=parseInt(e[2])||0,!0}return!1}},{key:"toString",value:function(){return this.sid+"-"+this.appId+"-"+this.channelId}},{key:"equal",value:function(t){return this.toString()===t.toString()}},{key:"toBigint",value:function(){return 4294967296*this.sid+this.appId}}]),t}();n.default=a,e.exports=n.default},{}],7:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],n=arguments.length<=1||void 0===arguments[1]?0:arguments[1];i(this,t),this.high=e,this.low=n}return r(t,[{key:"destroy",value:function(){}},{key:"equal",value:function(t){return null!==t&&(this.low===t.low&&this.high===t.high)}},{key:"toString64",value:function(){var t=Number(this.high).toString(16),e=Number(this.low).toString(16);if(e.length<8)for(var n=8-e.length;n;)e="0"+e,n--;return t+e}}]),t}();n.default=a,e.exports=n.default},{}],8:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=t("./ProtoUInt64"),o=i(s),u=t("./ProtoUGID"),l=i(u),h=function(){function t(e){var n=arguments.length<=1||void 0===arguments[1]||arguments[1];r(this,t),this.view=e,this.pos=0,this.len=0,this.uri=0,this.resCode=0,!0===n&&(this.len=this.popUInt32(),this.uri=this.popUInt32(),this.resCode=this.popUInt16())}return a(t,[{key:"destroy",value:function(){}},{key:"bytesAvailable",value:function(){return this.view.byteLength-this.pos}},{key:"popBool",value:function(){if(this.pos+1>this.view.byteLength)return!1;var t=this.view.getUint8(this.pos);return this.pos++,"1"===t.toString()}},{key:"popUInt8",value:function(){if(this.pos+1>this.view.byteLength)return 0;var t=this.view.getUint8(this.pos);return this.pos++,t}},{key:"popUInt16",value:function(){if(this.pos+2>this.view.byteLength)return 0;var t=this.view.getUint16(this.pos,!0);return this.pos+=2,t}},{key:"popUInt32",value:function(){if(this.pos+4>this.view.byteLength)return 0;var t=this.view.getUint32(this.pos,!0);return this.pos+=4,t}},{key:"popUInt64",value:function(){if(this.pos+8>this.view.byteLength)return new o.default;var t=this.view.getUint32(this.pos,!0);this.pos+=4;var e=this.view.getUint32(this.pos,!0);return this.pos+=4,new o.default(e,t)}},{key:"popUGID",value:function(){var t=(this.popUInt16(),this.popUInt32()),e=this.popUInt32(),n=this.popUInt32();return new l.default(t,e,n)}},{key:"popUint8Array",value:function(){var t=this.popUInt16();if(this.pos+t>this.view.byteLength)return null;var e=new Uint8Array(this.view.buffer,this.pos,t);return this.pos+=t,e}},{key:"popUint8Array32",value:function(){var t=this.popUInt32();if(this.pos+t>this.view.byteLength)return null;var e=new Uint8Array(this.view.buffer,this.pos,t);return this.pos+=t,e}},{key:"popUInt32Vector",value:function(){var t=this.popUInt32();if(this.pos+4*t>this.view.byteLength)return null;for(var e=[],n=0;n<t;n++)e.push(this.popUInt32());return e}},{key:"popUInt16Vector",value:function(){var t=this.popUInt32();if(this.pos+2*t>this.view.byteLength)return null;for(var e=[],n=0;n<t;n++)e.push(this.popUInt16());return e}},{key:"popString",value:function(){var t=this.popUInt16();if(this.pos+t>this.view.byteLength)return null;for(var e="",n=0;n<t;++n)e+=String.fromCharCode(this.popUInt8());return e}}]),t}();n.default=h,e.exports=n.default},{"./ProtoUGID":6,"./ProtoUInt64":7}],9:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={URI_VIDEO_PNotifyCurrentCdnStream:2739202,URI_VIDEO_PNotifyCurrentStream4:2675714,URI_VIDEO_PSubscribeStream3:2667266,URI_VIDEO_PSubscribeStreamRes3:2667522,URI_VIDEO_PVideoSyncSpeakerTime3:2674690,URI_VIDEO_PStreamData3:2666754,URI_VIDEO_PStopStream3:2666498,URI_VIDEO_PForceConnectVideoProxy3:2685442,URI_VIDEO_PPullStreamData:2694146,URI_VIDEO_PResendStreamData4:2689026,URI_VIDEO_PResendStreamDataFailAck:2694402,URI_VIDEO_PVideoProxyPing3:2669570,URI_VIDEO_PVideoProxyPingRes4:2683650,URI_VIDEO_PNotifyMultiVideo:2746370,URI_VIDEO_PLoginAndSubscribe:4097282,URI_VIDEO_PLoginAndSubscribeRes:4097538,URI_VIDEO_PNotifyUplinkRecvCount3:2672642,URI_VIDEO_PP2pVideoPing3:2671874,URI_VIDEO_PVideoBroadcast3:2672130,URI_VIDEO_PUpdateVideoConfig2:2569474,URI_VIDEO_PVideoQualityStatistics:2591746,URI_AUDIO_PLoginMediaProxy2:227586,URI_AUDIO_PLoginMediaProxyRes2:233218,URI_AUDIO_PMediaProxyPing:208386,URI_AUDIO_PMediaProxyPingRes:208642,URI_AUDIO_PP2pPing3:41218,URI_AUDIO_PReSendVoice2:22530,URI_AUDIO_PChatQualityVoiceExRes:71682,URI_AUDIO_PFastAccessVoice:821250,URI_AUDIO_PVoiceNak:27138,URI_AUDIO_PVoicePacketSet:27394,URI_AUDIO_PFastAccessCfg:227842,URI_MCS_PLoginVp:258,URI_MCS_PLoginVpRes:514,URI_AVP_PLiveLoginAvpProxy:7680264,URI_AVP_PLiveLoginAvpProxyRes:7680520,URI_AVP_PLiveLeaveAvpProxyTcp:7680776,URI_AVP_PLiveAvpPing:7683080,URI_AVP_PLiveAvpPingRes:7683336,URI_AVP_PLiveNotifyPublishStatus:7701e3,URI_AVP_PLiveNotifyPublishStatusRes:7701256,URI_AVP_PLiveNotifyStreamStatus:7681800,URI_AVP_PLiveStopStream:7703048,URI_AVP_PLiveSubscribe:7681288,URI_AVP_PLiveSubscribeRes:7681544,URI_AVP_PLiveStopPublishStream:7682824,URI_AVP_PLiveStartPublish:7682312,URI_AVP_PLiveStartPublishRes:7682568,URI_AVP_PLiveUpdateToken:7708424,URI_AVP_PLiveSdkAuthResNotify:7708680,URI_AVP_PLiveBizAuthResNotify:7708936,URI_WEBRTC_POffer:3840264,URI_WEBRTC_PAnswer:3840520,URI_WEBRTC_PCandidate:3840776,URI_WEBRTC_PCandidateRes:3841032,URI_WEBRTC_PEvent:3841800,URI_WEBRTC_PMessage:3842056,URI_AP_PApRouteData:333,URI_AP_PApRouteDataRes:589,URI_AP_PApLogin:845,URI_AP_PApLoginRes:1101,URI_AP_PApPing:1357,URI_AP_PApPingRes:1613,URI_STEAM_PAnchorStartLive:256080,URI_STEAM_PAnchorStartLiveRes:256336,URI_STEAM_PAnchorStopLive:256592,URI_STEAM_PAnchorStopLiveRes:256848,URI_STEAM_PS3ChannelPushMsg:257104,URI_STEAM_PQueryChannelStreams:260944,URI_STEAM_PQueryChannelStreamsRes:261200,PSvcLoginReqURI:1446744,PSvcLoginResURI:1447e3,PSvcLogoutReqURI:1447256,PSvcLogoutResURI:1447512,PSvcPingURI:1447768,PSvcPongURI:1448024,PSvcRouteReqURI:1449304,PSvcRouteResURI:1449560,PSvcSubsGroupReqURI:1450328,PSvcSubsGroupResURI:1450584,PSvcBroadcastURI:1450840,URI_RTMP_PRTMPLoginAvpProxy:7734292,URI_RTMP_PRTMPLoginAvpProxyRes:7734548,URI_RTMP_PRTMPSubscribe:7734804,URI_RTMP_PRTMPSubscribeRes:7735060,URI_RTMP_PRTMPStartPublish:7735316,URI_RTMP_PRTMPStartPublishRes:7735572,URI_RTMP_PPRTMPStopPublish:7735828,URI_RTMP_PRTMPStopPublishRes:7736084},e.exports=n.default},{}],10:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=t("../protobase/ProtoMarshall"),o=i(s),u=t("../protobase/uri"),l=i(u),h=function(){function t(){r(this,t),this.vipUser=0,this.vipProxy=0,this.availPeers=0,this.uid=0,this.appid=0,this.stampc=0,this.loginStamp=0,this.uplinkBw=0,this.bPunched=!1,this.streamKey=""}return a(t,[{key:"marshall",value:function(){var t=new o.default;return t.setUri(l.default.URI_AVP_PLiveAvpPing),t.pushUInt8(this.vipUser),t.pushUInt8(this.vipProxy),t.pushUInt16(this.availPeers),t.pushUInt32(this.uid),t.pushUInt32(this.appid),t.pushUInt32(this.stampc),t.pushUInt32(this.loginStamp),t.pushUInt32(this.uplinkBw),t.pushUInt8(this.bPunched),t.pushString(this.streamKey),t.marshall()}}]),t}();n.default=h,e.exports=n.default},{"../protobase/ProtoMarshall":5,"../protobase/uri":9}],11:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=function(){function t(){i(this,t),this.stampc=0,this.stamps=0,this.proxyRtt=0,this.wanIp=0,this.wanPort=0,this.reserved=0,this.peerType=0}return r(t,[{key:"unmarshall",value:function(t){this.stampc=t.popUInt32(),this.stamps=t.popUInt32(),this.proxyRtt=t.popUInt32(),this.wanIp=t.popUInt32(),this.wanPort=t.popUInt16(),this.reserved=t.popUInt32(),this.peerType=t.popUInt8()}}]),t}();n.default=a,e.exports=n.default},{}],12:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=function(){function t(){i(this,t),this.appid=0,this.uid=0,this.bPublish=!0,this.streamName="",this.groupName="",this.bizAuthResult=0}return r(t,[{key:"unmarshall",value:function(t){this.appid=t.popUInt32(),this.uid=t.popUInt32(),this.bPublish=t.popBool(),this.streamName=t.popString(),this.groupName=t.popString(),this.bizAuthResult=t.popUInt32()}}]),t}();n.default=a,e.exports=n.default},{}],13:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=t("../protobase/ProtoMarshall"),o=i(s),u=t("../protobase/uri"),l=i(u),h=function(){function t(){r(this,t),this.uid=0,this.appid=0}return a(t,[{key:"marshall",value:function(){var t=new o.default;return t.setUri(l.default.URI_AVP_PLiveLeaveAvpProxyTcp),t.pushUInt32(this.uid),t.pushUInt32(this.appid),t.marshall()}}]),t}();n.default=h,e.exports=n.default},{"../protobase/ProtoMarshall":5,"../protobase/uri":9}],14:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=function(){function t(){i(this,t),this.appid=0,this.uid=0,this.sdkAuthResult=0}return r(t,[{key:"unmarshall",value:function(t){this.appid=t.popUInt32(),this.uid=t.popUInt32(),this.sdkAuthResult=t.popUInt32()}}]),t}();n.default=a,e.exports=n.default},{}],15:[function(t,e,n){"use strict";function i(t){
return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=t("../protobase/ProtoMarshall"),o=i(s),u=t("../protobase/uri"),l=i(u),h=function(){function t(){r(this,t),this.appid=0,this.uid=0,this.token="",this.bizAuthExtInfo=""}return a(t,[{key:"marshall",value:function(){var t=new o.default;return t.setUri(l.default.URI_AVP_PLiveUpdateToken),t.pushUInt32(this.appid),t.pushUInt32(this.uid),t.pushString(this.token),t.pushString(this.bizAuthExtInfo),t.marshall()}}]),t}();n.default=h,e.exports=n.default},{"../protobase/ProtoMarshall":5,"../protobase/uri":9}],16:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=function(){function t(){i(this,t),this.appid=0,this.groupType=null,this.groupId=null,this.svcName="",this.fnName="",this.protoType="",this.data=null,this.dataCRC=0,this.serverId=null,this.seqId=null,this.traceId=""}return r(t,[{key:"unmarshall",value:function(t){this.appid=t.popUInt32(),this.groupType=t.popUInt64(),this.groupId=t.popUInt64(),this.svcName=t.popString(),this.fnName=t.popString(),this.protoType=t.popString(),this.data=t.popUint8Array32(),this.dataCRC=t.popUInt32(),this.serverId=t.popUInt64(),this.seqId=t.popUInt64(),this.traceId=t.popString()}},{key:"toString",value:function(){return"appid="+this.appid+" groupType="+JSON.stringify(this.groupType)+" groupId="+JSON.stringify(this.groupId)+" svcName="+this.svcName+" fnName="+this.fnName+" protoType="+this.protoType+" dataCRC="+this.dataCRC+" serverId="+JSON.stringify(this.serverId)+" seqId="+JSON.stringify(this.seqId)+" traceId="+this.traceId}}]),t}();n.default=a,e.exports=n.default},{}],17:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){var n=[],i=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{!i&&o.return&&o.return()}finally{if(r)throw a}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=t("../../protobase/ProtoMarshall"),u=i(o),l=t("../../protobase/uri"),h=i(l),f=t("long"),c=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(f),d=function(){function t(){r(this,t),this.context="",this.uid=0,this.appid=0,this.instId=0,this.seqId=0,this.user="",this.password="",this.otp="",this.clientHeaders=new Map}return s(t,[{key:"marshall",value:function(){var t=new u.default;t.setUri(h.default.PSvcLoginReqURI),t.pushString(this.context);var e=c.fromString(this.uid.toString());t.pushUInt32(e.low),t.pushUInt32(e.high),t.pushUInt32(this.appid),t.pushUInt32(this.instId);var n=c.fromString(this.seqId.toString());t.pushUInt32(n.low),t.pushUInt32(n.high),t.pushString(this.user),t.pushString(this.password),t.pushString(this.otp),t.pushUInt32(this.clientHeaders.size);var i=!0,r=!1,s=void 0;try{for(var o,l=this.clientHeaders[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var f=a(o.value,2),d=f[0],p=f[1];t.pushString(d),t.pushString(p)}}catch(t){r=!0,s=t}finally{try{!i&&l.return&&l.return()}finally{if(r)throw s}}return t.marshall()}}]),t}();n.default=d,e.exports=n.default},{"../../protobase/ProtoMarshall":5,"../../protobase/uri":9,long:50}],18:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=function(){function t(){i(this,t),this.context="",this.resCode=0,this.resMsg="",this.serverHeaders=new Map}return r(t,[{key:"unmarshall",value:function(t){this.context=t.popString(),this.resCode=t.popUInt32(),this.resMsg=t.popString();for(var e=t.popUInt32(),n=0;n<e;n++){var i=t.popString(),r=t.popString();this.serverHeaders.set(i,r)}}}]),t}();n.default=a,e.exports=n.default},{}],19:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=t("../../protobase/ProtoMarshall"),o=i(s),u=t("../../protobase/uri"),l=i(u),h=t("long"),f=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(h),c=function(){function t(){r(this,t),this.context="",this.uid=0,this.appid=0,this.instId=0}return a(t,[{key:"marshall",value:function(){var t=new o.default;t.setUri(l.default.PSvcLogoutReqURI),t.pushString(this.context);var e=f.fromString(this.uid.toString());return t.pushUInt32(e.low),t.pushUInt32(e.high),t.pushUInt32(this.appid),t.pushUInt32(this.instId),t.marshall()}}]),t}();n.default=c,e.exports=n.default},{"../../protobase/ProtoMarshall":5,"../../protobase/uri":9,long:50}],20:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=function(){function t(){i(this,t),this.context="",this.resCode=0,this.resMsg=""}return r(t,[{key:"unmarshall",value:function(t){this.context=t.popString(),this.resCode=t.popUInt32(),this.resMsg=t.popString()}}]),t}();n.default=a,e.exports=n.default},{}],21:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=t("../../protobase/ProtoMarshall"),o=i(s),u=t("../../protobase/uri"),l=i(u),h=function(){function t(){r(this,t),this.context=""}return a(t,[{key:"marshall",value:function(){var t=new o.default;return t.setUri(l.default.PSvcPingURI),t.pushString(this.context),t.marshall()}}]),t}();n.default=h,e.exports=n.default},{"../../protobase/ProtoMarshall":5,"../../protobase/uri":9}],22:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=function(){function t(){i(this,t),this.context="",this.timestamp=null}return r(t,[{key:"unmarshall",value:function(t){this.context=t.popString(),this.timestamp=t.popUInt64()}}]),t}();n.default=a,e.exports=n.default},{}],23:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){var n=[],i=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{!i&&o.return&&o.return()}finally{if(r)throw a}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=t("../../protobase/ProtoMarshall"),u=i(o),l=t("../../protobase/uri"),h=i(l),f=t("long"),c=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(f),d=t("../../utils/utils"),p=i(d),v=function(){function t(){r(this,t),this.context="",this.uid=0,this.appid=0,this.instId=0,this.svcName="",this.fnName="",this.protoType="",this.data=null,this.dataCRC=0,this.routeArgs=new Map,this.clientHeaders=new Map,this.traceId=""}return s(t,[{key:"marshall",value:function(){var t=new u.default;t.setUri(h.default.PSvcRouteReqURI),t.pushString(this.context);var e=c.fromString(this.uid.toString());t.pushUInt32(e.low),t.pushUInt32(e.high),t.pushUInt32(this.appid),t.pushUInt32(this.instId),t.pushString(this.svcName),t.pushString(this.fnName),t.pushString(this.protoType),"string"==typeof this.data?t.pushString32(this.data):t.pushUint8Array32(this.data),t.pushUInt32(this.dataCRC),t.pushUInt32(this.routeArgs.size);var n=!0,i=!1,r=void 0;try{for(var s,o=this.routeArgs[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var l=a(s.value,2),f=l[0],d=l[1];t.pushString(f),t.pushString(d)}}catch(t){i=!0,r=t}finally{try{!n&&o.return&&o.return()}finally{if(i)throw r}}t.pushUInt32(this.clientHeaders.size);var p=!0,v=!1,_=void 0;try{for(var S,y=this.clientHeaders[Symbol.iterator]();!(p=(S=y.next()).done);p=!0){var m=a(S.value,2),f=m[0],d=m[1];t.pushString(f),t.pushString(d)}}catch(t){v=!0,_=t}finally{try{!p&&y.return&&y.return()}finally{if(v)throw _}}return t.pushString(this.traceId),t.marshall()}},{key:"toString",value:function(){return"context="+this.context+" uid="+this.uid+" appid="+this.appid+" instId="+this.instId+" svcName="+this.svcName+" fnName="+this.fnName+" traceId="+this.traceId+" clientHeaders="+p.default.stringfyMap(this.clientHeaders)}}]),t}();n.default=v,e.exports=n.default},{"../../protobase/ProtoMarshall":5,"../../protobase/uri":9,"../../utils/utils":48,long:50}],24:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=t("../../utils/utils"),s=function(t){return t&&t.__esModule?t:{default:t}}(a),o=function(){function t(){i(this,t),this.context="",this.resCode=0,this.resMsg="",this.svcName="",this.fnName="",this.protoType="",this.data=null,this.dataCRC=0,this.serverHeaders=new Map,this.traceId=""}return r(t,[{key:"unmarshall",value:function(t){this.context=t.popString(),this.resCode=t.popUInt32(),this.resMsg=t.popString(),this.svcName=t.popString(),this.fnName=t.popString(),this.protoType=t.popString(),this.data=t.popUint8Array32(),this.dataCRC=t.popUInt32();for(var e=t.popUInt32(),n=0;n<e;n++)this.serverHeaders.set(t.popString(),t.popString());this.traceId=t.popString()}},{key:"toString",value:function(){return"context="+this.context+" resCode="+this.resCode+" resMsg="+this.resMsg+" svcName="+this.svcName+" fnName="+this.fnName+" traceId="+this.traceId+" serverHeaders="+s.default.stringfyMap(this.serverHeaders)}}]),t}();n.default=o,e.exports=n.default},{"../../utils/utils":48}],25:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=t("../../protobase/ProtoMarshall"),o=i(s),u=t("../../protobase/uri"),l=i(u),h=t("long"),f=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(h),c=function(){function t(){r(this,t),this.context="",this.appid=0,this.joinGroups=new Array,this.leaveGroups=new Array}return a(t,[{key:"marshall",value:function(){var t=new o.default;t.setUri(l.default.PSvcSubsGroupReqURI),t.pushString(this.context),t.pushUInt32(this.appid);var e=this.joinGroups.length;if(0==e)t.pushUInt32(0);else{t.pushUInt32(e);for(var n=0;n<e;n++){var i=f.fromString(this.joinGroups[n].grpType.toString());t.pushUInt32(i.low),t.pushUInt32(i.high);var r=f.fromString(this.joinGroups[n].grpId.toString());t.pushUInt32(r.low),t.pushUInt32(r.high)}}if(0==(e=this.leaveGroups.length))t.pushUInt32(0);else{t.pushUInt32(e);for(var n=0;n<e;n++){var i=f.fromString(this.leaveGroups[n].grpType.toString());t.pushUInt32(i.low),t.pushUInt32(i.high);var r=f.fromString(this.leaveGroups[n].grpId.toString());t.pushUInt32(r.low),t.pushUInt32(r.high)}}return t.marshall()}}]),t}();n.default=c,e.exports=n.default},{"../../protobase/ProtoMarshall":5,"../../protobase/uri":9,long:50}],26:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=function(){function t(){i(this,t),this.context="",this.resCode=0}return r(t,[{key:"unmarshall",value:function(t){this.context=t.popString(),this.resCode=t.popUInt32()}}]),t}();n.default=a,e.exports=n.default},{}],27:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=t("../../protobase/ProtoMarshall"),o=i(s),u=t("../../protobase/uri"),l=i(u),h=function(){function t(){r(this,t),this.version=0,this.clientType=9,this.commandType=0,this.loginStamp=0,this.sdkVersion=0,this.serviceType=0,this.oriUserArea=0,this.destUserArea=0,this.videoGroupId=0,this.sceneId=0,this.proxyType=0,this.uid=null,this.appid=null,this.isAnchorSystem=!1,this.channelId=null,this.cookie=null,this.liveToken=null,this.audioCodecType=null}return a(t,[{key:"destroy",value:function(){}},{key:"marshall",value:function(){var t=new o.default;return t.setUri(l.default.URI_RTMP_PRTMPLoginAvpProxy),t.pushUInt8(this.version),t.pushUInt8(this.clientType),t.pushUInt8(this.commandType),t.pushUInt32(this.loginStamp),t.pushUInt32(this.sdkVersion),t.pushUInt32(this.serviceType),t.pushUInt32(this.oriUserArea),t.pushUInt32(this.destUserArea),t.pushUInt32(this.videoGroupId),t.pushUInt32(this.sceneId),t.pushUInt32(this.proxyType),t.pushUInt64(this.uid),t.pushUInt64(this.appid),t.pushUInt8(this.isAnchorSystem),t.pushString(this.channelId),t.pushString(this.cookie),t.pushString(this.liveToken),t.pushUIntArray(this.audioCodecType),t.marshall()}}]),t}();n.default=h,e.exports=n.default},{"../../protobase/ProtoMarshall":5,"../../protobase/uri":9}],28:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=function(){function t(){i(this,t),this.reject=0,this.firstViewer=0,this.wlanPort=0,this.clientAreaType=0,this.proxyAreaType=0,this.wlanIp=0,this.uid=null,this.appid=null,this.isAnchorSystem=!1,this.channelId=null}return r(t,[{key:"unmarshall",value:function(t){this.reject=t.popUInt8(),this.firstViewer=t.popUInt8(),this.wlanPort=t.popUInt16(),this.clientAreaType=t.popUInt16(),this.proxyAreaType=t.popUInt16(),this.wlanIp=t.popUInt32(),this.uid=t.popUInt64(),this.appid=t.popUInt64(),this.isAnchorSystem=t.popBool(),this.channelId=t.popString()}}]),t}();n.default=a,e.exports=n.default},{}],29:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){var n=[],i=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{!i&&o.return&&o.return()}finally{if(r)throw a}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=t("../../protobase/ProtoMarshall"),u=i(o),l=t("../../protobase/uri"),h=i(l),f=function(){function t(){r(this,t),this.speakerUid=null,this.appid=null,this.isAudioGroup=!1,this.channelId=null,this.publishStreams=new Map,this.streams=new Map,this.groupKeys=[],this.configMap=new Map}return s(t,[{key:"marshall",value:function(){var t=new u.default;t.setUri(h.default.URI_RTMP_PRTMPStartPublish),t.pushUInt64(this.speakerUid),t.pushUInt64(this.appid),t.pushBool(this.isAudioGroup),t.pushString(this.channelId),t.pushUInt32(this.publishStreams.size);var e=!0,n=!1,i=void 0;try{for(var r,s=this.publishStreams[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var o=a(r.value,2),l=o[0],f=o[1];t.pushString(l),t.pushUint8ArrayWithoutLen(f.marshall())}}catch(t){n=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(n)throw i}}t.pushUInt32(this.streams.size);var c=!0,d=!1,p=void 0;try{for(var v,_=this.streams.entries()[Symbol.iterator]();!(c=(v=_.next()).done);c=!0){var S=a(v.value,2),l=S[0],y=S[1];t.pushString(l),t.pushUint8ArrayWithoutLen(y.marshall())}}catch(t){d=!0,p=t}finally{try{!c&&_.return&&_.return()}finally{if(d)throw p}}t.pushUInt32(this.groupKeys.length);for(var m=0;m<this.groupKeys.length;++m)t.pushString(this.groupKeys[m]);t.pushUInt32(this.configMap.size);var I=!0,g=!1,b=void 0;try{for(var E,A=this.configMap.entries()[Symbol.iterator]();!(I=(E=A.next()).done);I=!0){var R=a(E.value,2),w=R[0],U=R[1];t.pushUInt16(w),t.pushUInt32(U)}}catch(t){g=!0,b=t}finally{try{!I&&A.return&&A.return()}finally{if(g)throw b}}return t.marshall()}}]),t}();n.default=f,e.exports=n.default},{"../../protobase/ProtoMarshall":5,"../../protobase/uri":9}],30:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=t("../../protocol/streamSvr/StreamAttrDescript"),s=function(t){return t&&t.__esModule?t:{default:t}}(a),o=function(){function t(){i(this,t),this.status=0,this.speakerUid=null,this.appid=null,this.channelId=null,this.rtmpUrl=null,this.streams=new Map,this.extend=new Map}return r(t,[{key:"unmarshall",value:function(t){this.status=t.popUInt32(),this.speakerUid=t.popUInt64(),this.appid=t.popUInt64(),this.channelId=t.popString(),this.rtmpUrl=t.popString();for(var e=t.popUInt32(),n=0;n<e;n++){var i=t.popString(),r=new s.default;r.unmarshall(t),this.streams.set(i,r)}for(var a=t.popUInt32(),n=0;n<a;n++){var o=t.popUInt32(),u=t.popString();this.extend.set(o,u)}}}]),t}();n.default=o,e.exports=n.default},{"../../protocol/streamSvr/StreamAttrDescript":43}],31:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=function(){function t(){i(this,t),this.resCode=0,this.rtmpUrl=null}return r(t,[{key:"marshall",value:function(){}},{key:"unmarshall",value:function(t){this.resCode=t.popUInt16(),this.rtmpUrl=t.popString()}}]),t}();n.default=a,e.exports=n.default},{}],32:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){var n=[],i=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{!i&&o.return&&o.return()}finally{if(r)throw a}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=t("../../protobase/uri"),u=i(o),l=t("../../protobase/ProtoMarshall"),h=i(l),f=function(){function t(){r(this,t),this.option=0,this.uid=null,this.appid=null,this.subscribe=!1,this.isAudioGroup=!1,this.channelId=null,this.userStreams=new Map}return s(t,[{key:"marshall",value:function(){var t=new h.default;t.setUri(u.default.URI_RTMP_PRTMPSubscribe),t.pushUInt32(this.option),t.pushUInt64(this.uid),t.pushUInt64(this.appid),t.pushBool(this.subscribe),t.pushBool(this.isAudioGroup),t.pushString(this.channelId),t.pushUInt32(this.userStreams.size);var e=!0,n=!1,i=void 0;try{for(var r,s=this.userStreams.entries()[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var o=a(r.value,2),l=o[0],f=o[1];t.pushUInt64(l),t.pushUInt32(f.size);var c=!0,d=!1,p=void 0;try{for(var v,_=f[Symbol.iterator]();!(c=(v=_.next()).done);c=!0){var S=a(v.value,2),y=S[0],m=S[1];t.pushString(y),t.pushUint8ArrayWithoutLen(m.marshall())}}catch(t){d=!0,p=t}finally{try{!c&&_.return&&_.return()}finally{if(d)throw p}}}}catch(t){n=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(n)throw i}}return t.marshall()}}]),t}();n.default=f,e.exports=n.default},{"../../protobase/ProtoMarshall":5,"../../protobase/uri":9}],33:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=t("./PRTMPStreamResInfo"),s=function(t){return t&&t.__esModule?t:{default:t}}(a),o=function(){function t(){i(this,t),this.uid=null,this.appid=null,this.subscribe=!1,this.isAudioGroup=!1,this.channelId=null,this.streamResInfos=new Map}return r(t,[{key:"unmarshall",value:function(t){this.uid=t.popUInt64(),this.appid=t.popUInt64(),this.subscribe=t.popBool(),this.isAudioGroup=t.popBool(),this.channelId=t.popString();for(var e=t.popUInt32();e--;){var n=t.popUInt64(),i=new s.default;i.unmarshall(t),this.streamResInfos.set(n,i)}}}]),t}();n.default=o,e.exports=n.default},{"./PRTMPStreamResInfo":31}],34:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){var n=[],i=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{!i&&o.return&&o.return()}finally{if(r)throw a}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=t("../../protobase/ProtoUInt64"),u=i(o),l=t("../../protobase/ProtoMarshall"),h=i(l),f=function(){function t(){r(this,t),this.uid=new u.default(0,0),this.streamType=0,this.codeRate=0,this.extend=new Map}return s(t,[{key:"marshall",value:function(){var t=new h.default(!1);t.pushUInt64(this.uid),t.pushUInt32(this.streamType),t.pushUInt32(this.codeRate),t.pushUInt32(this.extend.size);var e=!0,n=!1,i=void 0;try{for(var r,s=this.extend.entries()[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var o=a(r.value,2),u=o[0],l=o[1];t.pushUInt32(u),t.pushString(l)}}catch(t){n=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(n)throw i}}return t.marshall()}},{key:"unmarshall",value:function(t){this.uid=t.popUInt64(),this.streamType=t.popUInt32(),this.codeRate=t.popUInt32();for(var e=t.popUInt32(),n=0;n<e;n++){var i=t.popUInt32(),r=t.popString();this.extend.set(i,r)}}}]),t}();n.default=f,e.exports=n.default},{"../../protobase/ProtoMarshall":5,"../../protobase/ProtoUInt64":7}],35:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){var n=[],i=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{!i&&o.return&&o.return()}finally{if(r)throw a}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=t("../../protobase/ProtoMarshall"),o=function(t){return t&&t.__esModule?t:{default:t}}(s),u=function(){function t(){i(this,t),this.userParam=new Map}return a(t,[{key:"marshall",value:function(){var t=new o.default(!1);t.pushUInt32(this.userParam.size);var e=!0,n=!1,i=void 0;try{for(var a,s=this.userParam.entries()[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){var u=r(a.value,2),l=u[0],h=u[1];t.pushUInt32(l),t.pushString(h)}}catch(t){n=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(n)throw i}}return t.marshall()}}]),t}();n.default=u,e.exports=n.default},{"../../protobase/ProtoMarshall":5}],36:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){var n=[],i=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{!i&&o.return&&o.return()}finally{if(r)throw a}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=t("../../protobase/uri"),u=i(o),l=t("../../protobase/ProtoMarshall"),h=i(l),f=t("../../protobase/ProtoUInt64"),c=i(f),d=t("./ChannelUserInfo"),p=i(d),v=function(){function t(){r(this,t),this.uri=u.default.URI_STEAM_PAnchorStartLive,this.uid=new c.default(0,0),this.appid=new c.default(0,0),this.version=new c.default(0,0),this.ctxId=new c.default(0,0),this.userInfo=new p.default,this.streams=new Map,this.speakers=[],this.extend=new Map}return s(t,[{key:"marshall",value:function(){var t=new h.default;t.setUri(u.default.URI_STEAM_PAnchorStartLive),t.pushUInt64(this.uid),t.pushUInt64(this.appid),t.pushUInt64(this.version),t.pushUInt64(this.ctxId),t.pushString(this.channelId),t.pushUint8ArrayWithoutLen(this.userInfo.marshall()),t.pushUInt32(this.streams.size);var e=!0,n=!1,i=void 0;try{for(var r,s=this.streams.entries()[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var o=a(r.value,2),l=o[0],f=o[1];t.pushString(l),t.pushUint8ArrayWithoutLen(f.marshall())}}catch(t){n=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(n)throw i}}t.pushUInt32(this.speakers.length);for(var c=0;c<this.speakers.length;++c)t.pushUInt64(this.speakers[c]);t.pushUInt32(this.extend.size);var d=!0,p=!1,v=void 0;try{for(var _,S=this.extend.entries()[Symbol.iterator]();!(d=(_=S.next()).done);d=!0){var y=a(_.value,2),m=y[0],I=y[1];t.pushUInt32(m),t.pushString(I)}}catch(t){p=!0,v=t}finally{try{!d&&S.return&&S.return()}finally{if(p)throw v}}return t.marshall()}}]),t}();n.default=v,e.exports=n.default},{"../../protobase/ProtoMarshall":5,"../../protobase/ProtoUInt64":7,"../../protobase/uri":9,"./ChannelUserInfo":35}],37:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=t("./AnchorStreamInfo"),o=i(s),u=t("../../protobase/ProtoUInt64"),l=i(u),h=function(){function t(){r(this,t),
this.result=0,this.ctxId=new l.default(0,0),this.streams=new Map}return a(t,[{key:"unmarshall",value:function(t){this.result=t.popUInt32(),this.ctxId=t.popUInt64(),this.channelId=t.popString();for(var e=t.popUInt32(),n=0;n<e;n++){var i=t.popString(),r=new o.default;r.unmarshall(t),this.streams.set(i,r)}}}]),t}();n.default=h,e.exports=n.default},{"../../protobase/ProtoUInt64":7,"./AnchorStreamInfo":34}],38:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){var n=[],i=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{!i&&o.return&&o.return()}finally{if(r)throw a}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=t("../../protobase/ProtoMarshall"),u=i(o),l=t("../../protobase/uri"),h=i(l),f=t("../../protobase/ProtoUInt64"),c=i(f),d=function(){function t(){r(this,t),this.uri=h.default.URI_STEAM_PAnchorStopLive,this.uid=new c.default(0,0),this.appid=new c.default(0,0),this.version=new c.default(0,0),this.ctxId=new c.default(0,0),this.streams=[],this.extend=new Map}return s(t,[{key:"marshall",value:function(){var t=new u.default;t.setUri(h.default.URI_STEAM_PAnchorStopLive),t.pushUInt64(this.uid),t.pushUInt64(this.appid),t.pushUInt64(this.version),t.pushUInt64(this.ctxId),t.pushString(this.channelId),t.pushUInt32(this.streams.length);for(var e=0;e<this.streams.length;++e)t.pushString(this.streams[e]);t.pushUInt32(this.extend.size);var n=!0,i=!1,r=void 0;try{for(var s,o=this.extend.entries()[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var l=a(s.value,2),f=l[0],c=l[1];t.pushUInt32(f),t.pushString(c)}}catch(t){i=!0,r=t}finally{try{!n&&o.return&&o.return()}finally{if(i)throw r}}return t.marshall()}}]),t}();n.default=d,e.exports=n.default},{"../../protobase/ProtoMarshall":5,"../../protobase/ProtoUInt64":7,"../../protobase/uri":9}],39:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=t("../../protobase/ProtoUInt64"),s=function(t){return t&&t.__esModule?t:{default:t}}(a),o=function(){function t(){i(this,t),this.result=0,this.ctxId=new s.default(0,0)}return r(t,[{key:"unmarshall",value:function(t){this.result=t.popUInt32(),this.ctxId=t.popUInt64(),this.channelId=t.popString()}}]),t}();n.default=o,e.exports=n.default},{"../../protobase/ProtoUInt64":7}],40:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){var n=[],i=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{!i&&o.return&&o.return()}finally{if(r)throw a}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=t("../../protobase/ProtoMarshall"),u=i(o),l=t("../../protobase/uri"),h=i(l),f=t("../../protobase/ProtoUInt64"),c=i(f),d=function(){function t(){r(this,t),this.uri=h.default.URI_STEAM_PQueryChannelStreams,this.fromUid=new c.default(0,0),this.appid=new c.default(0,0),this.ctxId=new c.default(0,0),this.extend=new Map}return s(t,[{key:"marshall",value:function(){var t=new u.default;t.setUri(h.default.URI_STEAM_PQueryChannelStreams),t.pushString(this.channelId),t.pushUInt64(this.appid),t.pushUInt64(this.fromUid),t.pushUInt64(this.ctxId),t.pushUInt32(this.extend.size);var e=!0,n=!1,i=void 0;try{for(var r,s=this.extend.entries()[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var o=a(r.value,2),l=o[0],f=o[1];t.pushUInt32(l),t.pushString(f)}}catch(t){n=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(n)throw i}}return t.marshall()}}]),t}();n.default=d,e.exports=n.default},{"../../protobase/ProtoMarshall":5,"../../protobase/ProtoUInt64":7,"../../protobase/uri":9}],41:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=t("./AnchorStreamInfo"),o=i(s),u=t("../../protobase/ProtoUInt64"),l=i(u),h=function(){function t(){r(this,t),this.appid=new l.default(0,0),this.version=new l.default(0,0),this.exist=!1,this.isAudioGroup=!1,this.ctxId=new l.default(0,0),this.userStreams=new Map,this.speakers=[]}return a(t,[{key:"unmarshall",value:function(t){this.channelId=t.popString(),this.appid=t.popUInt64(),this.version=t.popUInt64(),this.exist=t.popBool(),this.isAudioGroup=t.popBool(),this.ctxId=t.popUInt64();for(var e=t.popUInt32(),n=0;n<e;n++){var i=t.popString(),r=new o.default;r.unmarshall(t),this.userStreams.set(i,r)}for(var a=t.popUInt32(),n=0;n<a;n++){var s=t.popUInt64();this.speakers.push(s)}}}]),t}();n.default=h,e.exports=n.default},{"../../protobase/ProtoUInt64":7,"./AnchorStreamInfo":34}],42:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=t("./AnchorStreamInfo"),o=i(s),u=t("../../protobase/ProtoUInt64"),l=i(u),h=function(){function t(){r(this,t),this.userStreams=new Map,this.appid=new l.default(0,0),this.timestamp=new l.default(0,0),this.stopped=!1,this.isAudioGroup=!1,this.userStreams=new Map,this.speakers=[]}return a(t,[{key:"unmarshall",value:function(t){this.channelId=t.popString(),this.appid=t.popUInt64(),this.timestamp=t.popUInt64(),this.stopped=t.popBool(),this.isAudioGroup=t.popBool();for(var e=t.popUInt32(),n=0;n<e;n++){var i=t.popString(),r=new o.default;r.unmarshall(t),this.userStreams.set(i,r)}for(var a=t.popUInt32(),n=0;n<a;n++){var s=t.popUInt64();this.speakers.push(s)}}}]),t}();n.default=h,e.exports=n.default},{"../../protobase/ProtoUInt64":7,"./AnchorStreamInfo":34}],43:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){var n=[],i=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{!i&&o.return&&o.return()}finally{if(r)throw a}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=t("../../protobase/ProtoMarshall"),o=function(t){return t&&t.__esModule?t:{default:t}}(s),u=function(){function t(){i(this,t),this.attr=new Map}return a(t,[{key:"marshall",value:function(){var t=new o.default(!1);t.pushUInt32(this.attr.size);var e=!0,n=!1,i=void 0;try{for(var a,s=this.attr.entries()[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){var u=r(a.value,2),l=u[0],h=u[1];t.pushUInt32(l),t.pushString(h)}}catch(t){n=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(n)throw i}}return t.marshall()}},{key:"unmarshall",value:function(t){for(var e=t.popUInt32(),n=0;n<e;n++){var i=t.popUInt32(),r=t.popString();this.attr.set(i,r)}}}]),t}();n.default=u,e.exports=n.default},{"../../protobase/ProtoMarshall":5}],44:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i;n.InputSourceTypeEnum=i,function(t){t[t.VIDEO=1]="VIDEO",t[t.AUDIO=2]="AUDIO",t[t.GROUP=3]="GROUP"}(i||(n.InputSourceTypeEnum=i={}));var r;n.StreamAttrEnum=r,function(t){t[t.ORI_STREAM=1]="ORI_STREAM",t[t.TRANS_CODE_STREAM=2]="TRANS_CODE_STREAM",t[t.MIX_STREAM=3]="MIX_STREAM"}(r||(n.StreamAttrEnum=r={}));var a;n.CodecType=a,function(t){t[t.CODEC_NONE=-1]="CODEC_NONE",t[t.VOICE_MID=0]="VOICE_MID",t[t.MUSIC_MID=1]="MUSIC_MID",t[t.VOICE_HIGHER=2]="VOICE_HIGHER",t[t.VOICE_HIGH=3]="VOICE_HIGH",t[t.VOICE_HIGHER_JITTER=4]="VOICE_HIGHER_JITTER",t[t.MUSIC_MID_JITTER=5]="MUSIC_MID_JITTER",t[t.VOICE_MID_AND_MUSIC_MID=7]="VOICE_MID_AND_MUSIC_MID",t[t.VOICE_HIGH_AND_MUSIC_MID=8]="VOICE_HIGH_AND_MUSIC_MID",t[t.VOICE_HIGHER_AND_MUSIC_MID_JITTER=9]="VOICE_HIGHER_AND_MUSIC_MID_JITTER",t[t.VOICE_HIGHER_AND_MUSIC_MID=10]="VOICE_HIGHER_AND_MUSIC_MID",t[t.VOICE_HIGHER_QUALITY1_AND_MUSIC_MID=11]="VOICE_HIGHER_QUALITY1_AND_MUSIC_MID",t[t.VOICE_LOW_FOR_MOBILE=21]="VOICE_LOW_FOR_MOBILE",t[t.VOICE_HIGHER_QUALITY1=22]="VOICE_HIGHER_QUALITY1",t[t.VOICE_LOW_FOR_MOBILE_QUALITY2=23]="VOICE_LOW_FOR_MOBILE_QUALITY2",t[t.MUSIC_MID_1_32KBR=24]="MUSIC_MID_1_32KBR",t[t.MUSIC_MID_1_40KBR=25]="MUSIC_MID_1_40KBR",t[t.MUSIC_MID_1_48KBR=26]="MUSIC_MID_1_48KBR",t[t.MUSIC_MID_2_24KBR=27]="MUSIC_MID_2_24KBR",t[t.MUSIC_MID_2_32KBR=28]="MUSIC_MID_2_32KBR",t[t.MUSIC_MID_2_40KBR=29]="MUSIC_MID_2_40KBR",t[t.MUSIC_MID_2_48KBR=30]="MUSIC_MID_2_48KBR",t[t.MUSIC_MID_2_24KBR_VBR=31]="MUSIC_MID_2_24KBR_VBR",t[t.MUSIC_MID_2_32KBR_VBR=32]="MUSIC_MID_2_32KBR_VBR",t[t.MUSIC_MID_2_40KBR_VBR=33]="MUSIC_MID_2_40KBR_VBR",t[t.MUSIC_MID_2_48KBR_VBR=34]="MUSIC_MID_2_48KBR_VBR",t[t.MUSIC_AAC_44100HZ_STEREO_128KBPS=35]="MUSIC_AAC_44100HZ_STEREO_128KBPS",t[t.MUSIC_AAC_44100HZ_STEREO_160KBPS=36]="MUSIC_AAC_44100HZ_STEREO_160KBPS",t[t.MUSIC_AAC_44100HZ_STEREO_192KBPS=37]="MUSIC_AAC_44100HZ_STEREO_192KBPS",t[t.MUSIC_ELD_AAC_44100HZ_STEREO=38]="MUSIC_ELD_AAC_44100HZ_STEREO",t[t.MUSIC_ELD_AAC_SBR_44100HZ_STEREO=39]="MUSIC_ELD_AAC_SBR_44100HZ_STEREO",t[t.MUSIC_AAC_48000HZ_STEREO=40]="MUSIC_AAC_48000HZ_STEREO",t[t.MUSIC_AAC_44100HZ_MONO=41]="MUSIC_AAC_44100HZ_MONO",t[t.MUSIC_OPUS=50]="MUSIC_OPUS",t[t.VIDEO_H264=100]="VIDEO_H264",t[t.VIDEO_H265=101]="VIDEO_H265"}(a||(n.CodecType=a={}));var s;n.StreamTypeEnum=s,function(t){t[t.VIDEO_STREAM=1]="VIDEO_STREAM",t[t.AUDIO_STREAM=2]="AUDIO_STREAM",t[t.MIX_VIDEO_STREAM=3]="MIX_VIDEO_STREAM",t[t.MIX_AUDIO_STREAM=4]="MIX_AUDIO_STREAM",t[t.SINGLE_MIX_VIDEO_STREAM=5]="SINGLE_MIX_VIDEO_STREAM",t[t.SINGLE_MIX_AUDIO_STREAM=6]="SINGLE_MIX_AUDIO_STREAM"}(s||(n.StreamTypeEnum=s={}));var o;n.AnchorStartLiveKeyEnum=o,function(t){t[t.EXTEND_KEY_AUDIO_GROUP=2]="EXTEND_KEY_AUDIO_GROUP"}(o||(n.AnchorStartLiveKeyEnum=o={}));var u;n.StreamInfoKeyEnum=u,function(t){t[t.STREAM_INFO_KEY_ENCODE=1]="STREAM_INFO_KEY_ENCODE"}(u||(n.StreamInfoKeyEnum=u={}));var l;n.PAnchorStopLiveKeyEnum=l,function(t){t[t.EXTEND_KEY_IS_OWNER=1]="EXTEND_KEY_IS_OWNER",t[t.EXTEND_KEY_AUDIO_GROUP=2]="EXTEND_KEY_AUDIO_GROUP"}(l||(n.PAnchorStopLiveKeyEnum=l={}));var h;n.ChannelUserKeyEnum=h,function(t){t[t.CHANNEL_USER_KEY_ROOM_ID=1]="CHANNEL_USER_KEY_ROOM_ID",t[t.CHANNEL_USER_KEY_IS_OWNER=2]="CHANNEL_USER_KEY_IS_OWNER",t[t.CHANNEL_USER_KEY_UNIQ_CHANNEL=3]="CHANNEL_USER_KEY_UNIQ_CHANNEL",t[t.CHANNEL_USER_KEY_MIC_NO=4]="CHANNEL_USER_KEY_MIC_NO",t[t.CHANNEL_USER_KEY_LAYOUT_H=5]="CHANNEL_USER_KEY_LAYOUT_H",t[t.CHANNEL_USER_KEY_LAYOUT_W=6]="CHANNEL_USER_KEY_LAYOUT_W",t[t.CHANNEL_USER_KEY_LAYOUT_X=7]="CHANNEL_USER_KEY_LAYOUT_X",t[t.CHANNEL_USER_KEY_LAYOUT_Y=8]="CHANNEL_USER_KEY_LAYOUT_Y",t[t.CHANNEL_USER_KEY_LAYOUT_GLOBAL_H=9]="CHANNEL_USER_KEY_LAYOUT_GLOBAL_H",t[t.CHANNEL_USER_KEY_LAYOUT_GLOBAL_W=10]="CHANNEL_USER_KEY_LAYOUT_GLOBAL_W",t[t.CHANNEL_USER_KEY_LAYOUT_CROP=11]="CHANNEL_USER_KEY_LAYOUT_CROP",t[t.CHANNEL_USER_KEY_LAYOUT_CROPRECT_X=12]="CHANNEL_USER_KEY_LAYOUT_CROPRECT_X",t[t.CHANNEL_USER_KEY_LAYOUT_CROPRECT_Y=13]="CHANNEL_USER_KEY_LAYOUT_CROPRECT_Y",t[t.CHANNEL_USER_KEY_LAYOUT_CROPRECT_W=14]="CHANNEL_USER_KEY_LAYOUT_CROPRECT_W",t[t.CHANNEL_USER_KEY_LAYOUT_CROPRECT_H=15]="CHANNEL_USER_KEY_LAYOUT_CROPRECT_H",t[t.CHANNEL_USER_KEY_QUALITY_LEVEL=16]="CHANNEL_USER_KEY_QUALITY_LEVEL"}(h||(n.ChannelUserKeyEnum=h={}));var f;n.StreamAttrKeyEnum=f,function(t){t[t.STREAM_ATTR_KEY_STREAM_NAME=1]="STREAM_ATTR_KEY_STREAM_NAME",t[t.STREAM_ATTR_KEY_STREAM_TYPE=2]="STREAM_ATTR_KEY_STREAM_TYPE",t[t.STREAM_ATTR_KEY_APPID=3]="STREAM_ATTR_KEY_APPID",t[t.STREAM_ATTR_KEY_FRAME_RATE=4]="STREAM_ATTR_KEY_FRAME_RATE",t[t.STREAM_ATTR_KEY_BIT_RATE=5]="STREAM_ATTR_KEY_BIT_RATE",t[t.STREAM_ATTR_KEY_HEIGHT=6]="STREAM_ATTR_KEY_HEIGHT",t[t.STREAM_ATTR_KEY_WIDTH=7]="STREAM_ATTR_KEY_WIDTH",t[t.STREAM_ATTR_KEY_ENCODE_TYPE=8]="STREAM_ATTR_KEY_ENCODE_TYPE",t[t.STREAM_ATTR_KEY_AUDIO_SAMPLE=9]="STREAM_ATTR_KEY_AUDIO_SAMPLE",t[t.STREAM_ATTR_KEY_AUDIO_CHANNEL=10]="STREAM_ATTR_KEY_AUDIO_CHANNEL"}(f||(n.StreamAttrKeyEnum=f={}))},{}],45:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=t("./logger"),o=i(s),u=t("./timeUtil"),l=i(u),h=function(){function t(e){r(this,t),this.linkHanlder=e,this.link=null,this.connected=!1,this.lastRecvTick=0}return a(t,[{key:"destroy",value:function(){this.reset(),this.linkHanlder=null}},{key:"isConnected",value:function(){return this.connected}},{key:"getPrefix",value:function(){return"["+this.linkHanlder.label+"]"}},{key:"connect",value:function(t){var e=this;this.reset(),o.default.log(this.getPrefix()+" ProtoLink.connect addr="+t),this.lastRecvTick=l.default.now(),this.link=wx.connectSocket({url:t,success:function(n){o.default.debug(e.getPrefix()+" success to connect url="+t)},fail:function(n){o.default.debug(e.getPrefix()+" fail to connect url="+t)},complete:function(){o.default.debug(e.getPrefix()+"  complete to connect url="+t)}}),this.link.onOpen(function(){e.lastRecvTick=l.default.now(),e.connected=!0,e.linkHanlder&&e.linkHanlder.onConnected()}),this.link.onMessage(function(t){e.lastRecvTick=l.default.now(),t.data instanceof ArrayBuffer?e.processArrayBuffer(t.data):e.processText(t.data)}),this.link.onClose(function(){e.connected=!1,e.reset(),e.linkHanlder&&(e.linkHanlder.onClose(),o.default.warn(e.getPrefix()+" ProtoLink.onClose"),e.linkHanlder=null)}),this.link.onError(function(t){e.connected=!1,e.reset(),e.linkHanlder&&(e.linkHanlder.onError(t),o.default.warn(e.getPrefix()+" ProtoLink.onError event="+JSON.stringify(t)),e.linkHanlder=null)})}},{key:"reset",value:function(){this.link&&(this.connected=!1,this.link.close({success:function(t){o.default.info("link wss close:"+JSON.stringify(t))}}),this.link=null,o.default.warn(" ProtoLink.reset: ws connection close."))}},{key:"onCheckTimer",value:function(t){this.onTimeOut(t)}},{key:"onTimeOut",value:function(t){if(t-this.lastRecvTick>1e4)return this.connected=!1,this.reset(),void(this.linkHanlder&&(this.linkHanlder.onClose(),o.default.warn(this.getPrefix()+" ProtoLink connect time out handler"),this.linkHanlder=null))}},{key:"send",value:function(t){this.link&&this.connected&&this.link.send({data:t.buffer,success:function(){},fail:function(t){null!=this&&void 0!==this&&(this.connected=!1,this.ws=null,this.linkHandler&&(this.linkHandler.onError(t),o.default.error(this.getPrefix()+" ProtoLink.send sendSocketMessage err="+JSON.stringify(t)),this.linkHandler=null))}})}},{key:"processText",value:function(t){o.default.log(this.getPrefix()+" ProtoLink.processText data="+t)}},{key:"processArrayBuffer",value:function(t){for(var e=new DataView(t),n=0,i=0,r=0;n+10<t.byteLength;){if(i=e.getUint32(n,!0),n+i>t.byteLength||i<10)return void o.default.error(this.getPrefix()+" ProtoLink.processArrayBuffer length error pktLen="+i+" bufferLen="+t.byteLength);r=e.getUint32(n+4,!0);var a=new DataView(t,n,i);this.linkHanlder&&this.linkHanlder.onData(r,a),n+=i}}}]),t}();n.default=h,e.exports=n.default},{"./logger":46,"./timeUtil":47}],46:[function(t,e,n){"use strict";function i(t){var e=t.toString().length,n=void 0;switch(e){case 1:n="00"+t;break;case 2:n="0"+t;break;default:n=t}return n}function r(){var t=new Date;return"h5svc-yy "+t.toLocaleTimeString("en-US",{hour12:!1})+"."+i(t.getMilliseconds())+":"}function a(t,e){t=t.split("."),e=e.split(".");for(var n=Math.max(t.length,e.length);t.length<n;)t.push("0");for(;e.length<n;)e.push("0");for(var i=0;i<n;i++){var r=parseInt(t[i]),a=parseInt(e[i]);if(r>a)return 1;if(r<a)return-1}return 0}Object.defineProperty(n,"__esModule",{value:!0});var s=0,o=function(){if("undefined"==typeof window&&wx){var t=wx.getSystemInfoSync().SDKVersion;if(a(t,"2.1.0")>=0)return wx.getLogManager().log("I can use wx log. SDKVersion="+t),!0}return!1}(),u={_data:[],_length:0,_visible:!1,debug:function(t){s<=-1&&(t=r()+t,u.record(t,"debug"),console.debug(t),o&&wx.getLogManager(1).debug(t))},log:function(t){s<=0&&(t=r()+t,u.record(t,"log"),console.log(t),o&&wx.getLogManager(1).log(t))},info:function(t){s<=1&&(t=r()+t,u.record(t,"info"),console.info(t),o&&wx.getLogManager(1).info(t))},warn:function(t){s<=2&&(t=r()+t,u.record(t,"warn"),console.warn(t),o&&wx.getLogManager(1).warn(t))},error:function(t){s<=3&&(t=r()+t,u.record(t,"error"),console.error(t),o&&wx.getLogManager(1).warn(t))},setLevel:function(t){console.log(r()+"set level from "+s+" to "+t),s=t},record:function(t,e){if(!o&&(1100===u._length&&(u._data.splice(0,100),u._length=1e3),u._length++,u._data.push(t+" ["+e+"]"),u._visible)){var n=document.getElementById("__h5playerLogWin");n.value+=t+"\r\n",n.scrollTop=1e4}},getLog:function(){return u._data},setLogVisible:function(t){u._visible=t;var e=document.getElementById("__h5playerLogWin");if(t){e||(e=document.createElement("textarea"),e.id="__h5playerLogWin",e.style.display="block",e.style.position="absolute",e.style.top="0",e.style.width="500px",e.style.height="300px",document.body.appendChild(e));for(var n="",i=0;i<u._length;i++)n+=u._data[i]+"\r\n";e.value=n,e.scrollTop=1e4}else e&&(e.style.display="none")}};n.default=u,e.exports=n.default},{}],47:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=0,r={now:function(){0===i&&(i=Date.now()-1);var t=Date.now()-i;return t>4294967295?(i+=4294967295,Date.now()-i):t},utc:function(){return Math.round(Date.now()/1e3)}};n.default=r,e.exports=n.default},{}],48:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){var n=[],i=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{!i&&o.return&&o.return()}finally{if(r)throw a}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=t("./../protobase/ProtoUInt64"),o=function(t){return t&&t.__esModule?t:{default:t}}(s),u=t("long"),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(u),h=function(){function t(){i(this,t)}return a(t,null,[{key:"inet_ntoa",value:function(t){var e=void 0,n=void 0,i=void 0,r=void 0,a=new Uint8Array(4),s=new DataView(a.buffer);return s.setUint32(0,t),e=s.getUint8(0),n=s.getUint8(1),i=s.getUint8(2),r=s.getUint8(3),r+"."+i+"."+n+"."+e}},{key:"isBiggerUint",value:function(t,e){if(t===e)return!1;if(t>e){var n=t-e;return n<2147483647}var n=e-t;return!(n<2147483647)}},{key:"isEqualOrBiggerUint",value:function(t,e){if(t===e)return!0;if(t>e){var n=t-e;return n<2147483647}var n=e-t;return!(n<2147483647)}},{key:"isBiggerUint8",value:function(t,e){if(t===e)return!1;if(t>e){var n=t-e;return n<127}var n=e-t;return!(n<127)}},{key:"getUintMax",value:function(){return 4294967295}},{key:"isUintMax",value:function(t){return 4294967295===t}},{key:"getIntMax",value:function(){return 2147483647}},{key:"getIntMin",value:function(){return-1*this.getIntMax()}},{key:"isUint64Max",value:function(t){return 4294967295===t.high&&4294967295===t.low}},{key:"uint2ip",value:function(t){var e=void 0,n=void 0,i=void 0,r=void 0;return e=255&t,n=t>>8&255,i=t>>16&255,r=t>>24&255,e+"."+n+"."+i+"."+r}},{key:"ip2uint",value:function(t){var e=t.split(".");return(parseInt(e[3])<<24)+(parseInt(e[2])<<16)+(parseInt(e[1])<<8)+parseInt(e[0])>>>0}},{key:"hash_string",value:function(t){for(var e=4058174404,n=0;n<t.length;n++){e<<=1;e+=t.charCodeAt(n)}var i=2147483647&e;return-2147483648==(2147483648&e)&&(i+=2147483648),i}},{key:"number2ProtoUInt64",value:function(e){if(e<=t.getUintMax())return new o.default(0,e);var n=l.fromString(e.toString());return new o.default(n.high,n.low)}},{key:"stringfyMap",value:function(e){var n=t.map2Object(e);return JSON.stringify(n)}},{key:"map2Object",value:function(e){var n={},i=!0,a=!1,s=void 0;try{for(var o,u=e[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var l=r(o.value,2),h=l[0],f=l[1];t.isMap(f)?n[h]=t.map2Object(f):n[h]=f}}catch(t){a=!0,s=t}finally{try{!i&&u.return&&u.return()}finally{if(a)throw s}}return n}},{key:"isMap",value:function(t){return"map"==Object.prototype.toString.call(t).match(/^\[object (.*)\]$/)[1].toLowerCase()}}]),t}();n.default=h,e.exports=n.default},{"./../protobase/ProtoUInt64":7,long:50}],49:[function(e,n,i){!function(e){function r(){this._events={},this._conf&&a.call(this,this._conf)}function a(t){t?(this._conf=t,t.delimiter&&(this.delimiter=t.delimiter),this._events.maxListeners=t.maxListeners!==e?t.maxListeners:f,t.wildcard&&(this.wildcard=t.wildcard),t.newListener&&(this.newListener=t.newListener),t.verboseMemoryLeak&&(this.verboseMemoryLeak=t.verboseMemoryLeak),this.wildcard&&(this.listenerTree={})):this._events.maxListeners=f}function s(t,e){var n="(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.";this.verboseMemoryLeak?(n+=" Event name: %s.",console.error(n,t,e)):console.error(n,t),console.trace&&console.trace()}function o(t){this._events={},this.newListener=!1,this.verboseMemoryLeak=!1,a.call(this,t)}function u(t,e,n,i){if(!n)return[];var r,a,s,o,l,h,f,c=[],d=e.length,p=e[i],v=e[i+1];if(i===d&&n._listeners){if("function"==typeof n._listeners)return t&&t.push(n._listeners),[n];for(r=0,a=n._listeners.length;r<a;r++)t&&t.push(n._listeners[r]);return[n]}if("*"===p||"**"===p||n[p]){if("*"===p){for(s in n)"_listeners"!==s&&n.hasOwnProperty(s)&&(c=c.concat(u(t,e,n[s],i+1)));return c}if("**"===p){f=i+1===d||i+2===d&&"*"===v,f&&n._listeners&&(c=c.concat(u(t,e,n,d)));for(s in n)"_listeners"!==s&&n.hasOwnProperty(s)&&("*"===s||"**"===s?(n[s]._listeners&&!f&&(c=c.concat(u(t,e,n[s],d))),c=c.concat(u(t,e,n[s],i))):c=s===v?c.concat(u(t,e,n[s],i+2)):c.concat(u(t,e,n[s],i)));return c}c=c.concat(u(t,e,n[p],i+1))}if(o=n["*"],o&&u(t,e,o,i+1),l=n["**"])if(i<d){l._listeners&&u(t,e,l,d);for(s in l)"_listeners"!==s&&l.hasOwnProperty(s)&&(s===v?u(t,e,l[s],i+2):s===p?u(t,e,l[s],i+1):(h={},h[s]=l[s],u(t,e,{"**":h},i+1)))}else l._listeners?u(t,e,l,d):l["*"]&&l["*"]._listeners&&u(t,e,l["*"],d);return c}function l(t,n){t="string"==typeof t?t.split(this.delimiter):t.slice();for(var i=0,r=t.length;i+1<r;i++)if("**"===t[i]&&"**"===t[i+1])return;for(var a=this.listenerTree,o=t.shift();o!==e;){if(a[o]||(a[o]={}),a=a[o],0===t.length)return a._listeners?("function"==typeof a._listeners&&(a._listeners=[a._listeners]),a._listeners.push(n),!a._listeners.warned&&this._events.maxListeners>0&&a._listeners.length>this._events.maxListeners&&(a._listeners.warned=!0,s.call(this,a._listeners.length,o))):a._listeners=n,!0;o=t.shift()}return!0}var h=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},f=10;o.EventEmitter2=o,o.prototype.delimiter=".",o.prototype.setMaxListeners=function(t){t!==e&&(this._events||r.call(this),this._events.maxListeners=t,this._conf||(this._conf={}),this._conf.maxListeners=t)},o.prototype.event="",o.prototype.once=function(t,e){return this.many(t,1,e),this},o.prototype.many=function(t,e,n){function i(){0==--e&&r.off(t,i),n.apply(this,arguments)}var r=this;if("function"!=typeof n)throw new Error("many only accepts instances of Function");return i._origin=n,this.on(t,i),r},o.prototype.emit=function(){this._events||r.call(this);var t=arguments[0];if("newListener"===t&&!this.newListener&&!this._events.newListener)return!1;var e,n,i,a,s,o=arguments.length;if(this._all&&this._all.length){if(s=this._all.slice(),o>3)for(e=new Array(o),a=0;a<o;a++)e[a]=arguments[a];for(i=0,n=s.length;i<n;i++)switch(this.event=t,o){case 1:s[i].call(this,t);break;case 2:s[i].call(this,t,arguments[1]);break;case 3:s[i].call(this,t,arguments[1],arguments[2]);break;default:s[i].apply(this,e)}}if(this.wildcard){s=[];var l="string"==typeof t?t.split(this.delimiter):t.slice();u.call(this,s,l,this.listenerTree,0)}else{if("function"==typeof(s=this._events[t])){switch(this.event=t,o){case 1:s.call(this);break;case 2:s.call(this,arguments[1]);break;case 3:s.call(this,arguments[1],arguments[2]);break;default:for(e=new Array(o-1),a=1;a<o;a++)e[a-1]=arguments[a];s.apply(this,e)}return!0}s&&(s=s.slice())}if(s&&s.length){if(o>3)for(e=new Array(o-1),a=1;a<o;a++)e[a-1]=arguments[a];for(i=0,n=s.length;i<n;i++)switch(this.event=t,o){case 1:s[i].call(this);break;case 2:s[i].call(this,arguments[1]);break;case 3:s[i].call(this,arguments[1],arguments[2]);break;default:s[i].apply(this,e)}return!0}if(!this._all&&"error"===t)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},o.prototype.emitAsync=function(){this._events||r.call(this);var t=arguments[0];if("newListener"===t&&!this.newListener&&!this._events.newListener)return Promise.resolve([!1]);var e,n,i,a,s,o=[],l=arguments.length;if(this._all){if(l>3)for(e=new Array(l),a=1;a<l;a++)e[a]=arguments[a];for(i=0,n=this._all.length;i<n;i++)switch(this.event=t,l){case 1:o.push(this._all[i].call(this,t));break;case 2:o.push(this._all[i].call(this,t,arguments[1]));break;case 3:o.push(this._all[i].call(this,t,arguments[1],arguments[2]));break;default:o.push(this._all[i].apply(this,e))}}if(this.wildcard){s=[];var h="string"==typeof t?t.split(this.delimiter):t.slice();u.call(this,s,h,this.listenerTree,0)}else s=this._events[t];if("function"==typeof s)switch(this.event=t,l){case 1:o.push(s.call(this));break;case 2:o.push(s.call(this,arguments[1]));break;case 3:o.push(s.call(this,arguments[1],arguments[2]));break;default:for(e=new Array(l-1),a=1;a<l;a++)e[a-1]=arguments[a];o.push(s.apply(this,e))}else if(s&&s.length){if(l>3)for(e=new Array(l-1),a=1;a<l;a++)e[a-1]=arguments[a];for(i=0,n=s.length;i<n;i++)switch(this.event=t,l){case 1:o.push(s[i].call(this));break;case 2:o.push(s[i].call(this,arguments[1]));break;case 3:o.push(s[i].call(this,arguments[1],arguments[2]));break;default:o.push(s[i].apply(this,e))}}else if(!this._all&&"error"===t)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(o)},o.prototype.on=function(t,e){if("function"==typeof t)return this.onAny(t),this;if("function"!=typeof e)throw new Error("on only accepts instances of Function");return this._events||r.call(this),this.emit("newListener",t,e),this.wildcard?(l.call(this,t,e),this):(this._events[t]?("function"==typeof this._events[t]&&(this._events[t]=[this._events[t]]),this._events[t].push(e),!this._events[t].warned&&this._events.maxListeners>0&&this._events[t].length>this._events.maxListeners&&(this._events[t].warned=!0,s.call(this,this._events[t].length,t))):this._events[t]=e,this)},o.prototype.onAny=function(t){if("function"!=typeof t)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),this._all.push(t),this},o.prototype.addListener=o.prototype.on,o.prototype.off=function(t,n){function i(t){if(t!==e){var n=Object.keys(t);for(var r in n){var a=n[r],s=t[a];s instanceof Function||"object"!=typeof s||null===s||(Object.keys(s).length>0&&i(t[a]),0===Object.keys(s).length&&delete t[a])}}}if("function"!=typeof n)throw new Error("removeListener only takes instances of Function");var r,a=[];if(this.wildcard){var s="string"==typeof t?t.split(this.delimiter):t.slice();a=u.call(this,null,s,this.listenerTree,0)}else{if(!this._events[t])return this;r=this._events[t],a.push({_listeners:r})}for(var o=0;o<a.length;o++){var l=a[o];if(r=l._listeners,h(r)){for(var f=-1,c=0,d=r.length;c<d;c++)if(r[c]===n||r[c].listener&&r[c].listener===n||r[c]._origin&&r[c]._origin===n){f=c;break}if(f<0)continue;return this.wildcard?l._listeners.splice(f,1):this._events[t].splice(f,1),0===r.length&&(this.wildcard?delete l._listeners:delete this._events[t]),this.emit("removeListener",t,n),this}(r===n||r.listener&&r.listener===n||r._origin&&r._origin===n)&&(this.wildcard?delete l._listeners:delete this._events[t],this.emit("removeListener",t,n))}return i(this.listenerTree),this},o.prototype.offAny=function(t){var e,n=0,i=0;if(t&&this._all&&this._all.length>0){for(e=this._all,n=0,i=e.length;n<i;n++)if(t===e[n])return e.splice(n,1),this.emit("removeListenerAny",t),this}else{for(e=this._all,n=0,i=e.length;n<i;n++)this.emit("removeListenerAny",e[n]);this._all=[]}return this},o.prototype.removeListener=o.prototype.off,o.prototype.removeAllListeners=function(t){if(0===arguments.length)return!this._events||r.call(this),this;if(this.wildcard)for(var e="string"==typeof t?t.split(this.delimiter):t.slice(),n=u.call(this,null,e,this.listenerTree,0),i=0;i<n.length;i++){var a=n[i];a._listeners=null}else this._events&&(this._events[t]=null);return this},o.prototype.listeners=function(t){if(this.wildcard){var e=[],n="string"==typeof t?t.split(this.delimiter):t.slice();return u.call(this,e,n,this.listenerTree,0),e}return this._events||r.call(this),this._events[t]||(this._events[t]=[]),h(this._events[t])||(this._events[t]=[this._events[t]]),this._events[t]},o.prototype.listenerCount=function(t){return this.listeners(t).length},o.prototype.listenersAny=function(){return this._all?this._all:[]},
"function"==typeof t&&t.amd?t(function(){return o}):"object"==typeof i?n.exports=o:window.EventEmitter2=o}()},{}],50:[function(t,e,n){function i(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}function r(t){return!0===(t&&t.__isLong__)}function a(t,e){var n,i,r;return e?(t>>>=0,(r=0<=t&&t<256)&&(i=c[t])?i:(n=o(t,(0|t)<0?-1:0,!0),r&&(c[t]=n),n)):(t|=0,(r=-128<=t&&t<128)&&(i=f[t])?i:(n=o(t,t<0?-1:0,!1),r&&(f[t]=n),n))}function s(t,e){if(isNaN(t))return e?m:y;if(e){if(t<0)return m;if(t>=v)return A}else{if(t<=-_)return R;if(t+1>=_)return E}return t<0?s(-t,e).neg():o(t%p|0,t/p|0,e)}function o(t,e,n){return new i(t,e,n)}function u(t,e,n){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return y;if("number"==typeof e?(n=e,e=!1):e=!!e,(n=n||10)<2||36<n)throw RangeError("radix");var i;if((i=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return u(t.substring(1),e,n).neg();for(var r=s(d(n,8)),a=y,o=0;o<t.length;o+=8){var l=Math.min(8,t.length-o),h=parseInt(t.substring(o,o+l),n);if(l<8){var f=s(d(n,l));a=a.mul(f).add(s(h))}else a=a.mul(r),a=a.add(s(h))}return a.unsigned=e,a}function l(t,e){return"number"==typeof t?s(t,e):"string"==typeof t?u(t,e):o(t.low,t.high,"boolean"==typeof e?e:t.unsigned)}e.exports=i;var h=null;try{h=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}i.prototype.__isLong__,Object.defineProperty(i.prototype,"__isLong__",{value:!0}),i.isLong=r;var f={},c={};i.fromInt=a,i.fromNumber=s,i.fromBits=o;var d=Math.pow;i.fromString=u,i.fromValue=l;var p=4294967296,v=p*p,_=v/2,S=a(1<<24),y=a(0);i.ZERO=y;var m=a(0,!0);i.UZERO=m;var I=a(1);i.ONE=I;var g=a(1,!0);i.UONE=g;var b=a(-1);i.NEG_ONE=b;var E=o(-1,2147483647,!1);i.MAX_VALUE=E;var A=o(-1,-1,!0);i.MAX_UNSIGNED_VALUE=A;var R=o(0,-2147483648,!1);i.MIN_VALUE=R;var w=i.prototype;w.toInt=function(){return this.unsigned?this.low>>>0:this.low},w.toNumber=function(){return this.unsigned?(this.high>>>0)*p+(this.low>>>0):this.high*p+(this.low>>>0)},w.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(R)){var e=s(t),n=this.div(e),i=n.mul(e).sub(this);return n.toString(t)+i.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var r=s(d(t,6),this.unsigned),a=this,o="";;){var u=a.div(r),l=a.sub(u.mul(r)).toInt()>>>0,h=l.toString(t);if(a=u,a.isZero())return h+o;for(;h.length<6;)h="0"+h;o=""+h+o}},w.getHighBits=function(){return this.high},w.getHighBitsUnsigned=function(){return this.high>>>0},w.getLowBits=function(){return this.low},w.getLowBitsUnsigned=function(){return this.low>>>0},w.getNumBitsAbs=function(){if(this.isNegative())return this.eq(R)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},w.isZero=function(){return 0===this.high&&0===this.low},w.eqz=w.isZero,w.isNegative=function(){return!this.unsigned&&this.high<0},w.isPositive=function(){return this.unsigned||this.high>=0},w.isOdd=function(){return 1==(1&this.low)},w.isEven=function(){return 0==(1&this.low)},w.equals=function(t){return r(t)||(t=l(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&(this.high===t.high&&this.low===t.low)},w.eq=w.equals,w.notEquals=function(t){return!this.eq(t)},w.neq=w.notEquals,w.ne=w.notEquals,w.lessThan=function(t){return this.comp(t)<0},w.lt=w.lessThan,w.lessThanOrEqual=function(t){return this.comp(t)<=0},w.lte=w.lessThanOrEqual,w.le=w.lessThanOrEqual,w.greaterThan=function(t){return this.comp(t)>0},w.gt=w.greaterThan,w.greaterThanOrEqual=function(t){return this.comp(t)>=0},w.gte=w.greaterThanOrEqual,w.ge=w.greaterThanOrEqual,w.compare=function(t){if(r(t)||(t=l(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},w.comp=w.compare,w.negate=function(){return!this.unsigned&&this.eq(R)?R:this.not().add(I)},w.neg=w.negate,w.add=function(t){r(t)||(t=l(t));var e=this.high>>>16,n=65535&this.high,i=this.low>>>16,a=65535&this.low,s=t.high>>>16,u=65535&t.high,h=t.low>>>16,f=65535&t.low,c=0,d=0,p=0,v=0;return v+=a+f,p+=v>>>16,v&=65535,p+=i+h,d+=p>>>16,p&=65535,d+=n+u,c+=d>>>16,d&=65535,c+=e+s,c&=65535,o(p<<16|v,c<<16|d,this.unsigned)},w.subtract=function(t){return r(t)||(t=l(t)),this.add(t.neg())},w.sub=w.subtract,w.multiply=function(t){if(this.isZero())return y;if(r(t)||(t=l(t)),h){return o(h.mul(this.low,this.high,t.low,t.high),h.get_high(),this.unsigned)}if(t.isZero())return y;if(this.eq(R))return t.isOdd()?R:y;if(t.eq(R))return this.isOdd()?R:y;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(S)&&t.lt(S))return s(this.toNumber()*t.toNumber(),this.unsigned);var e=this.high>>>16,n=65535&this.high,i=this.low>>>16,a=65535&this.low,u=t.high>>>16,f=65535&t.high,c=t.low>>>16,d=65535&t.low,p=0,v=0,_=0,m=0;return m+=a*d,_+=m>>>16,m&=65535,_+=i*d,v+=_>>>16,_&=65535,_+=a*c,v+=_>>>16,_&=65535,v+=n*d,p+=v>>>16,v&=65535,v+=i*c,p+=v>>>16,v&=65535,v+=a*f,p+=v>>>16,v&=65535,p+=e*d+n*c+i*f+a*u,p&=65535,o(_<<16|m,p<<16|v,this.unsigned)},w.mul=w.multiply,w.divide=function(t){if(r(t)||(t=l(t)),t.isZero())throw Error("division by zero");if(h){if(!this.unsigned&&-2147483648===this.high&&-1===t.low&&-1===t.high)return this;return o((this.unsigned?h.div_u:h.div_s)(this.low,this.high,t.low,t.high),h.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?m:y;var e,n,i;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return m;if(t.gt(this.shru(1)))return g;i=m}else{if(this.eq(R)){if(t.eq(I)||t.eq(b))return R;if(t.eq(R))return I;return e=this.shr(1).div(t).shl(1),e.eq(y)?t.isNegative()?I:b:(n=this.sub(t.mul(e)),i=e.add(n.div(t)))}if(t.eq(R))return this.unsigned?m:y;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();i=y}for(n=this;n.gte(t);){e=Math.max(1,Math.floor(n.toNumber()/t.toNumber()));for(var a=Math.ceil(Math.log(e)/Math.LN2),u=a<=48?1:d(2,a-48),f=s(e),c=f.mul(t);c.isNegative()||c.gt(n);)e-=u,f=s(e,this.unsigned),c=f.mul(t);f.isZero()&&(f=I),i=i.add(f),n=n.sub(c)}return i},w.div=w.divide,w.modulo=function(t){if(r(t)||(t=l(t)),h){return o((this.unsigned?h.rem_u:h.rem_s)(this.low,this.high,t.low,t.high),h.get_high(),this.unsigned)}return this.sub(this.div(t).mul(t))},w.mod=w.modulo,w.rem=w.modulo,w.not=function(){return o(~this.low,~this.high,this.unsigned)},w.and=function(t){return r(t)||(t=l(t)),o(this.low&t.low,this.high&t.high,this.unsigned)},w.or=function(t){return r(t)||(t=l(t)),o(this.low|t.low,this.high|t.high,this.unsigned)},w.xor=function(t){return r(t)||(t=l(t)),o(this.low^t.low,this.high^t.high,this.unsigned)},w.shiftLeft=function(t){return r(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?o(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):o(0,this.low<<t-32,this.unsigned)},w.shl=w.shiftLeft,w.shiftRight=function(t){return r(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?o(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):o(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},w.shr=w.shiftRight,w.shiftRightUnsigned=function(t){if(r(t)&&(t=t.toInt()),0===(t&=63))return this;var e=this.high;if(t<32){return o(this.low>>>t|e<<32-t,e>>>t,this.unsigned)}return 32===t?o(e,0,this.unsigned):o(e>>>t-32,0,this.unsigned)},w.shru=w.shiftRightUnsigned,w.shr_u=w.shiftRightUnsigned,w.toSigned=function(){return this.unsigned?o(this.low,this.high,!1):this},w.toUnsigned=function(){return this.unsigned?this:o(this.low,this.high,!0)},w.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},w.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},w.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},i.fromBytes=function(t,e,n){return n?i.fromBytesLE(t,e):i.fromBytesBE(t,e)},i.fromBytesLE=function(t,e){return new i(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},i.fromBytesBE=function(t,e){return new i(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)}},{}]},{},[4])(4)});
