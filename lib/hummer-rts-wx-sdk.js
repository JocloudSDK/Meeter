!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Hummer=t():e.Hummer=t()}(window,(function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=53)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(4),r=n(31),o=n(5),s=n(55),a=new o.Logger("Utils");class u{static getHiidoHost(e=!0){return e?"mlog.hiido.com":"hlog.hiido.com"}static MAX(e,t){return e>t?e:t}static MIN(e,t){return e<t?e:t}static isUint64String(e){return!!/^\d+(\.\d+)?$/.test(e)}static isUint64StringArray(e){if(0===e.length)return!1;for(let t of e)if(!this.isUint64String(t))return!1;return!0}static hasOwn(e,t){return Object.prototype.hasOwnProperty.call(e,t)}static inet_ntoa(e){let t,n,i,r,o="",s=new Uint8Array(4),a=new DataView(s.buffer);return a.setUint32(0,e),t=a.getUint8(0),n=a.getUint8(1),i=a.getUint8(2),r=a.getUint8(3),o=r+"."+i+"."+n+"."+t,o}static isBiggerUint(e,t){if(e===t)return!1;if(e>t){return e-t<2147483647}return!(t-e<2147483647)}static isEqualOrBiggerUint(e,t){if(e===t)return!0;if(e>t){return e-t<2147483647}return!(t-e<2147483647)}static isBiggerUint8(e,t){if(e===t)return!1;if(e>t){return e-t<127}return!(t-e<127)}static getUintMax(){return 4294967295}static isUintMax(e){return 4294967295===e}static getIntMax(){return 2147483647}static getIntMin(){return-1*this.getIntMax()}static isUint64Max(e){return 4294967295===e.high&&4294967295===e.low}static uint2ip(e){let t,n,i,r;return t=255&e,n=e>>8&255,i=e>>16&255,r=e>>24&255,t+"."+n+"."+i+"."+r}static ip2uint(e){let t=e.split(".");return(parseInt(t[3])<<24)+(parseInt(t[2])<<16)+(parseInt(t[1])<<8)+parseInt(t[0])>>>0}static isNumber(e){return null!==e&&("number"==typeof e&&!isNaN(e-0)||"object"==typeof e&&e.constructor===Number)}static isString(e){return"string"==Object.prototype.toString.call(e).match(/^\[object (.*)\]$/)[1].toLowerCase()}static isEmpty(e){return void 0===e||null==e||""==e}static isMap(e){return"map"==Object.prototype.toString.call(e).match(/^\[object (.*)\]$/)[1].toLowerCase()}static isObject(e){return"object"==Object.prototype.toString.call(e).match(/^\[object (.*)\]$/)[1].toLowerCase()}static toMap(e){if(u.isMap(e))return e;if(u.isObject(e)){let t=new Map;for(let n of Object.keys(e))t.set(n,e[n].toString());return t}return null}static bin2hex(e){var t,n,i,r="";for(t=0,n=(e+="").length;t<n;t++)r+=(i=e.charCodeAt(t).toString(16)).length<2?"0"+i:i;return r}static getUUID(e){var t="";try{var n=document.createElement("canvas"),i=n.getContext("2d"),r=e;i.fillStyle="#f60",i.fillRect(0,0,8,10),i.fillStyle="#FF0000",i.fillText(r,4,17);var o=n.toDataURL().replace("data:image/png;base64,",""),s=atob(o);t=u.bin2hex(s.slice(-16,-12))}catch(e){var a=[];for(let e=0;e<8;e++)a[e]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);t=a.join("")}var l=[];for(let e=0;e<28;e++)l[e]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return l[6]="4",l[11]="0123456789abcdef".substr(3&l[19]|8,1),l[0]=l[5]=l[10]=l[15]="-",t+l.join("")}static getCookie(e,t=!1){if(t)return wx.getStorageSync(e.toString());if(document.cookie.length>0){var n=document.cookie.indexOf(e+"=");if(-1!=n){n=n+e.length+1;var i=document.cookie.indexOf(";",n);return-1==i&&(i=document.cookie.length),decodeURI(document.cookie.substring(n,i))}}return""}static setCookie(e,t,n,i,r,o){n||(n=24);var s=new Date;s.setTime(s.getTime()+60*n*60*1e3),document.cookie=e+"="+window.encodeURI(t)+";expires="+s.toUTCString()+(r?";domain="+r:"")+(i?";path="+i:"")+(!0===o?";secure":"")}static setWxCookie(e,t){wx.setStorageSync(e,t),wx.setStorageSync("oscookieDate",Date.now())}static getUidInCertainInterval(){return parseInt(""+(1125e4*Math.random()+4283717296),10)}static getOrGenerateUid(e,t){if(!t)return u.getUidInCertainInterval();let n=u.getCookie("svc_anonymous_uid");if(!n){let t=u.getUidInCertainInterval(),n="https:"==document.location.protocol;return u.setCookie("svc_anonymous_uid",t.toString(),168,"/",e,n),a.warn("Utils.getOrGenerateUid save uid to cookie uid="+t),t}return a.warn("Utils.getOrGenerateUid get uid from cookie uid="+n),parseInt(n)}static DelayPromise(e){return new Promise((function(t){setTimeout(t,e)}))}static number2ProtoUInt64(e){if(e<=u.getUintMax())return new r.default(0,e);let t=i.fromString(e.toString());return new r.default(t.high,t.low)}static wxPromise(e,t){return new Promise((function(n,i){let r=Object.assign({},t,{success(e){n(e),t&&t.success&&t.success(e)},fail(n){a.error(e+" "+JSON.stringify(n)),i(n),t&&t.fail&&t.fail(n)}});wx[e](r)}))}static yFetch(e){let t=s.default(!0,{},{method:"GET"},e);return u.wxPromise("request",t)}static payload2DataView(e){let t=new Uint8Array(e.byteLength);return t.set(e,0),e=null,new DataView(t.buffer)}static stringfyMap(e){let t=u.map2Object(e);return JSON.stringify(t)}static map2Object(e){let t={};for(let[n,i]of e)u.isMap(i)?t[n]=u.map2Object(i):t[n]=i;return t}static unique(e){return e.reduce((e,t)=>e.includes(t)?e:[...e,t],[])}static LongToUint64StringArray(e){let t=[];for(let n of e)t.push(n.toString());return this.unique(t)}static Uint64StringToLongArray(e){let t=[];for(let n of e)t.push(i.fromString(n,!0));return this.unique(t)}}t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(34),r=n(4);t.default=class{constructor(e=!0){this.hasHeader=e,this.segments=[],this.data=null,this.totalLen=0,this.uri=0,this.hasHeader&&(this.pushUInt32(10),this.pushUInt32(this.uri),this.pushUInt16(200))}destroy(){}marshall(){if(0===this.segments.length)return null;this.data=new Uint8Array(this.totalLen);let e=0;for(let t=0;t<this.segments.length;++t){let n=this.segments[t];this.data.set(n,e),e+=n.length}return this.hasHeader&&(this.replaceUInt32(0,this.totalLen),this.replaceUInt32(4,this.uri)),this.data}setUri(e){this.uri=e}replaceUInt32(e,t){new DataView(this.data.buffer).setUint32(e,t,!0)}pushUInt8(e){let t=new Uint8Array(1);new DataView(t.buffer).setUint8(0,e),this.segments.push(t),this.totalLen++}pushBool(e){this.pushUInt8(e?1:0)}pushUInt16(e){let t=new Uint8Array(2);new DataView(t.buffer).setUint16(0,e,!0),this.segments.push(t),this.totalLen+=2}pushUInt32(e){let t=new Uint8Array(4);new DataView(t.buffer).setUint32(0,e,!0),this.segments.push(t),this.totalLen+=4}pushUInt64(e){let t=new Uint8Array(8),n=new DataView(t.buffer);n.setUint32(0,e.low,!0),n.setUint32(4,e.high,!0),this.segments.push(t),this.totalLen+=8}pushUInt64String(e){const{low:t,high:n}=r.fromString(e,!0);this.pushUInt64({low:t,high:n})}pushUGID(e){this.pushUInt16(12),this.pushUInt32(e.sid),this.pushUInt32(e.appId),this.pushUInt32(e.channelId)}pushUint8Array(e){if(e.length>=65536)throw{rescode:2001,msg:"Invalid Parameter"};this.pushUInt16(e.length),this.segments.push(e),this.totalLen+=e.length}pushUint8ArrayWithoutLen(e){this.segments.push(e),this.totalLen+=e.length}pushUint8Array32(e){this.pushUInt32(e.length),this.segments.push(e),this.totalLen+=e.length}pushUIntArray(e){this.pushUInt32(e.length);for(let t=0;t<e.length;t++)this.pushUInt32(e[t])}pushString(e){this.pushUInt16(e.length);let t=new Uint8Array(e.length),n=new DataView(t.buffer);for(let t=0;t<e.length;++t)n.setUint8(t,e.charCodeAt(t));this.segments.push(t),this.totalLen+=e.length}pushString32(e){this.pushUInt32(e.length);let t=new Uint8Array(e.length),n=new DataView(t.buffer);for(let t=0;t<e.length;++t)n.setUint8(t,e.charCodeAt(t));this.segments.push(t),this.totalLen+=e.length}pushUInt32AndUInt32Map(e){this.pushUInt32(e.size);for(let t of e)this.pushUInt32(t[0]),this.pushUInt32(t[1])}pushUtf8String(e){let t=i.default.encodeUtf8(e);this.pushUint8Array(t)}pushUtf8String32(e){let t=i.default.encodeUtf8(e);this.pushUint8Array32(t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(4),r=n(31),o=n(61),s=n(34);t.default=class{constructor(e,t=!0){this.view=e,this.pos=0,this.len=0,this.uri=0,this.resCode=0,!0===t&&(this.len=this.popUInt32(),this.uri=this.popUInt32(),this.resCode=this.popUInt16())}destroy(){}bytesAvailable(){return this.view.byteLength-this.pos}popBool(){if(this.pos+1>this.view.byteLength)return!1;let e=this.view.getUint8(this.pos);return this.pos++,"1"===e.toString()}popUInt8(){if(this.pos+1>this.view.byteLength)return 0;let e=this.view.getUint8(this.pos);return this.pos++,e}popUInt16(){if(this.pos+2>this.view.byteLength)return 0;let e=this.view.getUint16(this.pos,!0);return this.pos+=2,e}popUInt32(){if(this.pos+4>this.view.byteLength)return 0;let e=this.view.getUint32(this.pos,!0);return this.pos+=4,e}popUInt64(){if(this.pos+8>this.view.byteLength)return new r.default;let e=this.view.getUint32(this.pos,!0);this.pos+=4;let t=this.view.getUint32(this.pos,!0);return this.pos+=4,new r.default(t,e)}popUInt64String(){if(this.pos+8>this.view.byteLength)return"0";let e=this.view.getUint32(this.pos,!0);this.pos+=4;let t=this.view.getUint32(this.pos,!0);return this.pos+=4,new i(e,t,!0).toString(10)}popUGID(){this.popUInt16();let e=this.popUInt32(),t=this.popUInt32(),n=this.popUInt32();return new o.default(e,t,n)}popUint8Array(){let e=this.popUInt16();if(this.pos+e>this.view.byteLength)return null;let t=new Uint8Array(this.view.buffer,this.pos,e);return this.pos+=e,t}popUint8Array32(){let e=this.popUInt32();if(this.pos+e>this.view.byteLength)return null;let t=new Uint8Array(this.view.buffer,this.pos,e);return this.pos+=e,t}popUInt32Vector(){let e=this.popUInt32();if(this.pos+4*e>this.view.byteLength)return null;let t=[];for(let n=0;n<e;n++)t.push(this.popUInt32());return t}popUInt16Vector(){let e=this.popUInt32();if(this.pos+2*e>this.view.byteLength)return null;let t=[];for(let n=0;n<e;n++)t.push(this.popUInt16());return t}popString(){let e=this.popUInt16();if(this.pos+e>this.view.byteLength)return null;let t="";for(let n=0;n<e;++n)t+=String.fromCharCode(this.popUInt8());return t}popUtf8String(){let e=this.popUint8Array();return s.default.decodeUtf8(e)}popUtf8String32(){let e=this.popUint8Array32();return s.default.decodeUtf8(e)}}},function(e,t,n){"use strict";var i,r,o=e.exports=n(8),s=n(45);o.codegen=n(98),o.fetch=n(99),o.path=n(100),o.fs=o.inquire("fs"),o.toArray=function(e){if(e){for(var t=Object.keys(e),n=new Array(t.length),i=0;i<t.length;)n[i]=e[t[i++]];return n}return[]},o.toObject=function(e){for(var t={},n=0;n<e.length;){var i=e[n++],r=e[n++];void 0!==r&&(t[i]=r)}return t};var a=/\\/g,u=/"/g;o.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)},o.safeProp=function(e){return!/^[$\w_]+$/.test(e)||o.isReserved(e)?'["'+e.replace(a,"\\\\").replace(u,'\\"')+'"]':"."+e},o.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var l=/_([a-z])/g;o.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(l,(function(e,t){return t.toUpperCase()}))},o.compareFieldsById=function(e,t){return e.id-t.id},o.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(o.decorateRoot.remove(e.$type),e.$type.name=t,o.decorateRoot.add(e.$type)),e.$type;i||(i=n(21));var r=new i(t||e.name);return o.decorateRoot.add(r),r.ctor=e,Object.defineProperty(e,"$type",{value:r,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:r,enumerable:!1}),r};var c=0;o.decorateEnum=function(e){if(e.$type)return e.$type;r||(r=n(6));var t=new r("Enum"+c++,e);return o.decorateRoot.add(t),Object.defineProperty(e,"$type",{value:t,enumerable:!1}),t},Object.defineProperty(o,"decorateRoot",{get:function(){return s.decorated||(s.decorated=new(n(26)))}})},function(e,t){e.exports=i;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function i(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}i.prototype.__isLong__,Object.defineProperty(i.prototype,"__isLong__",{value:!0}),i.isLong=r;var o={},s={};function a(e,t){var n,i,r;return t?(r=0<=(e>>>=0)&&e<256)&&(i=s[e])?i:(n=l(e,(0|e)<0?-1:0,!0),r&&(s[e]=n),n):(r=-128<=(e|=0)&&e<128)&&(i=o[e])?i:(n=l(e,e<0?-1:0,!1),r&&(o[e]=n),n)}function u(e,t){if(isNaN(e))return t?b:y;if(t){if(e<0)return b;if(e>=f)return _}else{if(e<=-g)return O;if(e+1>=g)return w}return e<0?u(-e,t).neg():l(e%p|0,e/p|0,t)}function l(e,t,n){return new i(e,t,n)}i.fromInt=a,i.fromNumber=u,i.fromBits=l;var c=Math.pow;function d(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return y;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var i;if((i=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return d(e.substring(1),t,n).neg();for(var r=u(c(n,8)),o=y,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),l=parseInt(e.substring(s,s+a),n);if(a<8){var h=u(c(n,a));o=o.mul(h).add(u(l))}else o=(o=o.mul(r)).add(u(l))}return o.unsigned=t,o}function h(e,t){return"number"==typeof e?u(e,t):"string"==typeof e?d(e,t):l(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}i.fromString=d,i.fromValue=h;var p=4294967296,f=p*p,g=f/2,m=a(1<<24),y=a(0);i.ZERO=y;var b=a(0,!0);i.UZERO=b;var v=a(1);i.ONE=v;var I=a(1,!0);i.UONE=I;var S=a(-1);i.NEG_ONE=S;var w=l(-1,2147483647,!1);i.MAX_VALUE=w;var _=l(-1,-1,!0);i.MAX_UNSIGNED_VALUE=_;var O=l(0,-2147483648,!1);i.MIN_VALUE=O;var U=i.prototype;U.toInt=function(){return this.unsigned?this.low>>>0:this.low},U.toNumber=function(){return this.unsigned?(this.high>>>0)*p+(this.low>>>0):this.high*p+(this.low>>>0)},U.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(O)){var t=u(e),n=this.div(t),i=n.mul(t).sub(this);return n.toString(e)+i.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var r=u(c(e,6),this.unsigned),o=this,s="";;){var a=o.div(r),l=(o.sub(a.mul(r)).toInt()>>>0).toString(e);if((o=a).isZero())return l+s;for(;l.length<6;)l="0"+l;s=""+l+s}},U.getHighBits=function(){return this.high},U.getHighBitsUnsigned=function(){return this.high>>>0},U.getLowBits=function(){return this.low},U.getLowBitsUnsigned=function(){return this.low>>>0},U.getNumBitsAbs=function(){if(this.isNegative())return this.eq(O)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},U.isZero=function(){return 0===this.high&&0===this.low},U.eqz=U.isZero,U.isNegative=function(){return!this.unsigned&&this.high<0},U.isPositive=function(){return this.unsigned||this.high>=0},U.isOdd=function(){return 1==(1&this.low)},U.isEven=function(){return 0==(1&this.low)},U.equals=function(e){return r(e)||(e=h(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},U.eq=U.equals,U.notEquals=function(e){return!this.eq(e)},U.neq=U.notEquals,U.ne=U.notEquals,U.lessThan=function(e){return this.comp(e)<0},U.lt=U.lessThan,U.lessThanOrEqual=function(e){return this.comp(e)<=0},U.lte=U.lessThanOrEqual,U.le=U.lessThanOrEqual,U.greaterThan=function(e){return this.comp(e)>0},U.gt=U.greaterThan,U.greaterThanOrEqual=function(e){return this.comp(e)>=0},U.gte=U.greaterThanOrEqual,U.ge=U.greaterThanOrEqual,U.compare=function(e){if(r(e)||(e=h(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},U.comp=U.compare,U.negate=function(){return!this.unsigned&&this.eq(O)?O:this.not().add(v)},U.neg=U.negate,U.add=function(e){r(e)||(e=h(e));var t=this.high>>>16,n=65535&this.high,i=this.low>>>16,o=65535&this.low,s=e.high>>>16,a=65535&e.high,u=e.low>>>16,c=0,d=0,p=0,f=0;return p+=(f+=o+(65535&e.low))>>>16,d+=(p+=i+u)>>>16,c+=(d+=n+a)>>>16,c+=t+s,l((p&=65535)<<16|(f&=65535),(c&=65535)<<16|(d&=65535),this.unsigned)},U.subtract=function(e){return r(e)||(e=h(e)),this.add(e.neg())},U.sub=U.subtract,U.multiply=function(e){if(this.isZero())return y;if(r(e)||(e=h(e)),n)return l(n.mul(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned);if(e.isZero())return y;if(this.eq(O))return e.isOdd()?O:y;if(e.eq(O))return this.isOdd()?O:y;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(m)&&e.lt(m))return u(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,i=65535&this.high,o=this.low>>>16,s=65535&this.low,a=e.high>>>16,c=65535&e.high,d=e.low>>>16,p=65535&e.low,f=0,g=0,b=0,v=0;return b+=(v+=s*p)>>>16,g+=(b+=o*p)>>>16,b&=65535,g+=(b+=s*d)>>>16,f+=(g+=i*p)>>>16,g&=65535,f+=(g+=o*d)>>>16,g&=65535,f+=(g+=s*c)>>>16,f+=t*p+i*d+o*c+s*a,l((b&=65535)<<16|(v&=65535),(f&=65535)<<16|(g&=65535),this.unsigned)},U.mul=U.multiply,U.divide=function(e){if(r(e)||(e=h(e)),e.isZero())throw Error("division by zero");var t,i,o;if(n)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?l((this.unsigned?n.div_u:n.div_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?b:y;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return b;if(e.gt(this.shru(1)))return I;o=b}else{if(this.eq(O))return e.eq(v)||e.eq(S)?O:e.eq(O)?v:(t=this.shr(1).div(e).shl(1)).eq(y)?e.isNegative()?v:S:(i=this.sub(e.mul(t)),o=t.add(i.div(e)));if(e.eq(O))return this.unsigned?b:y;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=y}for(i=this;i.gte(e);){t=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(t)/Math.LN2),a=s<=48?1:c(2,s-48),d=u(t),p=d.mul(e);p.isNegative()||p.gt(i);)p=(d=u(t-=a,this.unsigned)).mul(e);d.isZero()&&(d=v),o=o.add(d),i=i.sub(p)}return o},U.div=U.divide,U.modulo=function(e){return r(e)||(e=h(e)),n?l((this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},U.mod=U.modulo,U.rem=U.modulo,U.not=function(){return l(~this.low,~this.high,this.unsigned)},U.and=function(e){return r(e)||(e=h(e)),l(this.low&e.low,this.high&e.high,this.unsigned)},U.or=function(e){return r(e)||(e=h(e)),l(this.low|e.low,this.high|e.high,this.unsigned)},U.xor=function(e){return r(e)||(e=h(e)),l(this.low^e.low,this.high^e.high,this.unsigned)},U.shiftLeft=function(e){return r(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):l(0,this.low<<e-32,this.unsigned)},U.shl=U.shiftLeft,U.shiftRight=function(e){return r(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):l(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},U.shr=U.shiftRight,U.shiftRightUnsigned=function(e){if(r(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?l(this.low>>>e|t<<32-e,t>>>e,this.unsigned):l(32===e?t:t>>>e-32,0,this.unsigned)},U.shru=U.shiftRightUnsigned,U.shr_u=U.shiftRightUnsigned,U.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},U.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},U.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},U.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},U.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},i.fromBytes=function(e,t,n){return n?i.fromBytesLE(e,t):i.fromBytesBE(e,t)},i.fromBytesLE=function(e,t){return new i(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},i.fromBytesBE=function(e,t){return new i(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.DEBUG=-1]="DEBUG",e[e.LOG=0]="LOG",e[e.INFO=1]="INFO",e[e.WARN=2]="WARN",e[e.ERROR=3]="ERROR"}(i=t.LOGLEVEL||(t.LOGLEVEL={}));class r{constructor(e){this._module=e||""}get canIUseWxLog(){if("undefined"==typeof window){const e=wx.getSystemInfoSync().SDKVersion;if(r.compareVersion(e,"2.1.0")>=0)return wx.getLogManager().log("I can use wx log. SDKVersion="+e),!0}return!1}debug(...e){r.globalLevel<=i.DEBUG&&(console.debug(this._prefix,...e),this.canIUseWxLog&&wx.getLogManager().debug(e))}log(...e){r.globalLevel<=i.LOG&&(r.record(e,"log"),console.log(this._prefix,...e),this.canIUseWxLog&&wx.getLogManager().log(e))}info(...e){r.globalLevel<=i.INFO&&(r.record(e,"info"),console.info(this._prefix,...e),this.canIUseWxLog&&wx.getLogManager().info(e))}warn(...e){r.globalLevel<=i.WARN&&(r.record(e,"warn"),console.warn(this._prefix,...e),this.canIUseWxLog&&wx.getLogManager().warn(e))}error(...e){r.globalLevel<=i.ERROR&&(r.record(e,"error"),console.error(this._prefix,...e),this.canIUseWxLog&&wx.getLogManager().warn(e))}static setLevel(e=i.LOG){console.log(r.getPrefix()+"set level from "+r.globalLevel+" to "+e),r.globalLevel=e}static record(e,t){1100===this._length&&(this._data.splice(0,100),this._length=1e3),this._length++;let n=[`[${t}]`,...e];this._data.push(n)}static getLog(){return this._data}static padMs(e){let t;switch(e.toString().length){case 1:t="00"+e;break;case 2:t="0"+e;break;default:t=e}return t}get _prefix(){return r.getPrefix()+" "+this._module}static getPrefix(){let e=new Date;return"hummer "+e.toLocaleTimeString("en-US",{hour12:!1})+"."+r.padMs(e.getMilliseconds())+":"}static compareVersion(e,t){e=e.split("."),t=t.split(".");const n=Math.max(e.length,t.length);for(;e.length<n;)e.push("0");for(;t.length<n;)t.push("0");for(let i=0;i<n;i++){const n=parseInt(e[i]),r=parseInt(t[i]);if(n>r)return 1;if(n<r)return-1}return 0}}r._data=[],r._length=0,r.globalLevel=i.LOG,t.Logger=r},function(e,t,n){"use strict";e.exports=s;var i=n(11);((s.prototype=Object.create(i.prototype)).constructor=s).className="Enum";var r=n(13),o=n(3);function s(e,t,n,r,o){if(i.call(this,e,n),t&&"object"!=typeof t)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=r,this.comments=o||{},this.reserved=void 0,t)for(var s=Object.keys(t),a=0;a<s.length;++a)"number"==typeof t[s[a]]&&(this.valuesById[this.values[s[a]]=t[s[a]]]=s[a])}s.fromJSON=function(e,t){var n=new s(e,t.values,t.options,t.comment,t.comments);return n.reserved=t.reserved,n},s.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["options",this.options,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])},s.prototype.add=function(e,t,n){if(!o.isString(e))throw TypeError("name must be a string");if(!o.isInteger(t))throw TypeError("id must be an integer");if(void 0!==this.values[e])throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(void 0!==this.valuesById[t]){if(!this.options||!this.options.allow_alias)throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return this.comments[e]=n||null,this},s.prototype.remove=function(e){if(!o.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(null==t)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this},s.prototype.isReservedId=function(e){return r.isReservedId(this.reserved,e)},s.prototype.isReservedName=function(e){return r.isReservedName(this.reserved,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(57);var r;t.WSHOST="wss://web-ap-service.jocloud.com",t.Utify={encodeStringToUtf8Bytes:i.encodeStringToUtf8Bytes,decodeUtf8BytesToString:i.decodeUtf8BytesToString},function(e){e[e.ANONYMOUS=0]="ANONYMOUS",e[e.NON_ANONYMOUS=1]="NON_ANONYMOUS"}(t.UserType||(t.UserType={})),function(e){e[e.UNKOWN=-1]="UNKOWN",e[e.OTP_TOKEN=0]="OTP_TOKEN",e[e.TOKEN_3RD=1]="TOKEN_3RD",e[e.YY_TOKEN=2]="YY_TOKEN"}(t.TokenType||(t.TokenType={})),function(e){e[e.UNKOWN=-1]="UNKOWN",e[e.LOGIN=0]="LOGIN",e[e.LOGOUT=1]="LOGOUT"}(t.LoginState||(t.LoginState={})),function(e){e.DISCONNECTED="DISCONNECTED",e.CONNECTING="CONNECTING",e.CONNECTED="CONNECTED",e.RECONNECTING="RECONNECTING"}(t.ConnectionState||(t.ConnectionState={})),function(e){e.INIT="INIT",e.LOGIN="LOGIN",e.LOGIN_SUCCESS="LOGIN_SUCCESS",e.LOGIN_FAILURE="LOGIN_FAILURE",e.LOGIN_TIMEOUT="LOGIN_TIMEOUT",e.INTERRUPTED="INTERRUPTED",e.LOGOUT="LOGOUT",e.REMOTE_LOGIN="REMOTE_LOGIN"}(t.ConnectionChangeReason||(t.ConnectionChangeReason={})),function(e){e[e.OS_TEXTCHAT=2147483648]="OS_TEXTCHAT",e[e.OS_CHAN_AUTHER=2147483649]="OS_CHAN_AUTHER",e[e.OS_CHAN_USER_COUNT=2147483650]="OS_CHAN_USER_COUNT"}(t.EGroupType||(t.EGroupType={})),t.OK="ok",t.SUCCESS=0,t.UNKOWN=1,t.kUnknownError=1,t.kOperationTimeout=1005,t.OPERATION_TIMEOUT="Operation Timeout",t.kInvalid_Parameters=2001,t.INVALID_PARAMETERS="Invalid Parameters",t.TIME_OUT=11e3,t.ExpiredTokenException=2003,t.MAX_QUEUE_SIZE=5,t.SIZE_LIMIT=100,function(e){e.AREA_CN="china",e.AREA_AP_SOUTHEAST="indonesia",e.AREA_AP_SOUTH="india",e.AREA_US="america",e.AREA_ME_EAST="me_east",e.AREA_SA_EAST="brazil"}(r||(r={})),t.parseEnvParams=function(e){const t=new Map([["CN",{area:"china",region:r.AREA_CN,type:"public",name:"shared",innerFlag:!0}],["CN-INNER",{area:"china",region:r.AREA_CN,type:"private",name:"share",innerFlag:!0}],["CN-INNER1",{area:"chn",region:r.AREA_CN,type:"private",name:"share",innerFlag:!0}],["CN-TEST",{area:"shenzhen",region:"shenzhen",type:"test",name:"2",innerFlag:!0}],["CN-TEST1",{area:"shenzhen",region:"shenzhen",type:"test",name:"1",innerFlag:!0}],["chn",{area:"chn",region:r.AREA_CN,type:"private",name:"share",innerFlag:!0}],["idn",{area:"idn",region:r.AREA_AP_SOUTHEAST,type:"private",name:"share",innerFlag:!1}],["ind",{area:"ind",region:r.AREA_AP_SOUTH,type:"private",name:"share",innerFlag:!1}],["are",{area:"are",region:"are",type:"private",name:"share",innerFlag:!1}],["usa",{area:"usa",region:r.AREA_US,type:"private",name:"share",innerFlag:!1}],["bra",{area:"bra",region:r.AREA_SA_EAST,type:"private",name:"share",innerFlag:!1}],["cn",{area:"cn",region:r.AREA_CN,type:"private",name:"share",innerFlag:!0}],["ap_southeast",{area:"ap_southeast",region:r.AREA_AP_SOUTHEAST,type:"private",name:"share",innerFlag:!1}],["ap_south",{area:"ap_south",region:r.AREA_AP_SOUTH,type:"private",name:"share",innerFlag:!1}],["us",{area:"us",region:r.AREA_US,type:"private",name:"share",innerFlag:!1}],["me_east",{area:"me_east",region:r.AREA_ME_EAST,type:"private",name:"share",innerFlag:!1}],["sa_east",{area:"sa_east",region:r.AREA_SA_EAST,type:"private",name:"share",innerFlag:!1}]]);if(!e)return null;let n=e.split("/");if(3===n.length){let e=n[0];return{area:e,region:e,type:n[1],name:n[2],innerFlag:!0}}if(1===n.length){let e=n[0],i=t.get(e);return void 0!==i?{area:i.area,region:i.region,type:i.type,name:i.name,innerFlag:i.innerFlag}:{area:e,region:e,type:"private",name:"share",innerFlag:!1}}return null},t.getHiidoHost=(e=!0)=>e?"mlog.hiido.com":"hlog.hiido.com",function(e){e.login="login",e.logout="logout",e.joinChatRoom="chatroom.joinChatRoom",e.leaveChatRoom="chatroom.leaveChatRoom",e.chatPullMsg="chatroom.pullMsg",e.chatPullMsgIfAny="chatroom.pullMsgIfAny",e.chatGetMaxSeqId="chatroom.getMaxSeqId",e.chatGetGroupMaxSeqId="chatroom.getGroupMaxSeqId",e.imPullMsg="im.pullMsg",e.pullMsgIfAny="im.pullMsgIfAny",e.processIMPushMsg="im.processIMPushMsg",e.maxAcquiredSeqID="im.maxAcquiredSeqID",e.getMaxSeqId="room.getMaxSeqId",e.getGroupMaxSeqId="room.getGroupMaxSeqId",e.join="room.joinChannel",e.leave="room.leaveChannel",e.pullMsg="room.pullMsg"}(t.MutexKey||(t.MutexKey={})),t.getMutexKey=(e,t)=>`${e}:${t}`,t.applyMixins=(e,t)=>{t&&Array.isArray(t)&&t.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(n=>{Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n))})})}},function(e,t,n){"use strict";(function(e){var i=t;function r(e,t,n){for(var i=Object.keys(t),r=0;r<i.length;++r)void 0!==e[i[r]]&&n||(e[i[r]]=t[i[r]]);return e}function o(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&r(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}i.asPromise=n(42),i.base64=n(87),i.EventEmitter=n(88),i.float=n(89),i.inquire=n(43),i.utf8=n(33),i.pool=n(90),i.LongBits=n(91),i.global="undefined"!=typeof window&&window||void 0!==e&&e||"undefined"!=typeof self&&self||this,i.emptyArray=Object.freeze?Object.freeze([]):[],i.emptyObject=Object.freeze?Object.freeze({}):{},i.isNode=Boolean(i.global.process&&i.global.process.versions&&i.global.process.versions.node),i.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},i.isString=function(e){return"string"==typeof e||e instanceof String},i.isObject=function(e){return e&&"object"==typeof e},i.isset=i.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},i.Buffer=function(){try{var e=i.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),i._Buffer_from=null,i._Buffer_allocUnsafe=null,i.newBuffer=function(e){return"number"==typeof e?i.Buffer?i._Buffer_allocUnsafe(e):new i.Array(e):i.Buffer?i._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},i.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,i.Long=i.global.dcodeIO&&i.global.dcodeIO.Long||i.global.Long||i.inquire("long"),i.key2Re=/^true|false|0|1$/,i.key32Re=/^-?(?:0|[1-9][0-9]*)$/,i.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,i.longToHash=function(e){return e?i.LongBits.from(e).toHash():i.LongBits.zeroHash},i.longFromHash=function(e,t){var n=i.LongBits.fromHash(e);return i.Long?i.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},i.merge=r,i.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},i.newError=o,i.ProtocolError=o("ProtocolError"),i.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},i.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},i.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},i._configure=function(){var e=i.Buffer;e?(i._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},i._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):i._Buffer_from=i._Buffer_allocUnsafe=null}}).call(this,n(14))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={PSvcLoginReqURI:1446744,PSvcLoginResURI:1447e3,PSvcLogoutReqURI:1447256,PSvcLogoutResURI:1447512,PSvcPingURI:1447768,PSvcPongURI:1448024,PAPForceOutURI:1448280,PSvcRouteReqURI:1449304,PSvcRouteResURI:1449560,PSvcUnicastURI:1449816,PSvcUnicastResURI:1450072,PSvcSubsGroupReqURI:1450328,PSvcSubsGroupResURI:1450584,PSvcBroadcastURI:1450840,PCS_ServiceSubcribeUserGroupV2URI:1452376,PCS_ServiceSubcribeUserGroupResV2URI:1452632,PCS_ServiceBroadCastV2URI:1452888,PCS_UserGroupChangeBcURI:3424461,CommonAuthOpsResURI:256205,PJoinChannelReqURI:256461,PLeaveChannelReqURI:256973,PTextChatReqURI:261325,PTextChatBroadResURI:261581,PChlInfoUpdateBcURI:269005,PKickOffUserBcURI:269773,DisableUserTextBcURI:270285,DisableChannelTextBcURI:270797,PAnonJoinChannelReqURI:281805,PAnonLeaveChannelReqURI:282061,PCS_DismissChatRoomBcURI:270285,PCS_UpdateChatRoomInfoBcURI:270541,PCS_UpdateChatRoomRolerBcURI:270797,PCS_KickOffUserBcURI:271053,PCS_SendBroadcastBcURI:271565,PCS_TextChatBcURI:773837,PCS_ChatRoomUserCountBcURI:3421389,PCS_ChatRoomUserBcURI:3423949,PCS_SendUnicastUcURI:526029,PCS_UserInfoChangeBcURI:272333,PGetApInfoReqURI:29470,PGetApInfoResURI:29726,PGetUserInfoReqURI:26115,PGetUserInfoResURI:26371,PGetChannelInfoReqURI:23815,PGetChannelInfoResURI:24071,PPushChannelUserCountURI:3139586,PLoginUdbResURI:4294967295}},function(e,t,n){"use strict";e.exports=l;var i=n(11);((l.prototype=Object.create(i.prototype)).constructor=l).className="Field";var r,o=n(6),s=n(12),a=n(3),u=/^required|optional|repeated$/;function l(e,t,n,r,o,l,c){if(a.isObject(r)?(c=o,l=r,r=o=void 0):a.isObject(o)&&(c=l,l=o,o=void 0),i.call(this,e,l),!a.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!a.isString(n))throw TypeError("type must be a string");if(void 0!==r&&!u.test(r=r.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==o&&!a.isString(o))throw TypeError("extend must be a string");this.rule=r&&"optional"!==r?r:void 0,this.type=n,this.id=t,this.extend=o||void 0,this.required="required"===r,this.optional=!this.required,this.repeated="repeated"===r,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!a.Long&&void 0!==s.long[n],this.bytes="bytes"===n,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=c}l.fromJSON=function(e,t){return new l(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)},Object.defineProperty(l.prototype,"packed",{get:function(){return null===this._packed&&(this._packed=!1!==this.getOption("packed")),this._packed}}),l.prototype.setOption=function(e,t,n){return"packed"===e&&(this._packed=null),i.prototype.setOption.call(this,e,t,n)},l.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return a.toObject(["rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},l.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=s.defaults[this.type])&&(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof r?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof o&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(!0!==this.options.packed&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof o)||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=a.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var e;a.base64.test(this.typeDefault)?a.base64.decode(this.typeDefault,e=a.newBuffer(a.base64.length(this.typeDefault)),0):a.utf8.write(this.typeDefault,e=a.newBuffer(a.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=a.emptyObject:this.repeated?this.defaultValue=a.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof r&&(this.parent.ctor.prototype[this.name]=this.defaultValue),i.prototype.resolve.call(this)},l.d=function(e,t,n,i){return"function"==typeof t?t=a.decorateType(t).name:t&&"object"==typeof t&&(t=a.decorateEnum(t).name),function(r,o){a.decorateType(r.constructor).add(new l(o,e,t,n,{default:i}))}},l._configure=function(e){r=e}},function(e,t,n){"use strict";e.exports=o,o.className="ReflectionObject";var i,r=n(3);function o(e,t){if(!r.isString(e))throw TypeError("name must be a string");if(t&&!r.isObject(t))throw TypeError("options must be an object");this.options=t,this.name=e,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(o.prototype,{root:{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}},fullName:{get:function(){for(var e=[this.name],t=this.parent;t;)e.unshift(t.name),t=t.parent;return e.join(".")}}}),o.prototype.toJSON=function(){throw Error()},o.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof i&&t._handleAdd(this)},o.prototype.onRemove=function(e){var t=e.root;t instanceof i&&t._handleRemove(this),this.parent=null,this.resolved=!1},o.prototype.resolve=function(){return this.resolved||this.root instanceof i&&(this.resolved=!0),this},o.prototype.getOption=function(e){if(this.options)return this.options[e]},o.prototype.setOption=function(e,t,n){return n&&this.options&&void 0!==this.options[e]||((this.options||(this.options={}))[e]=t),this},o.prototype.setOptions=function(e,t){if(e)for(var n=Object.keys(e),i=0;i<n.length;++i)this.setOption(n[i],e[n[i]],t);return this},o.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e},o._configure=function(e){i=e}},function(e,t,n){"use strict";var i=t,r=n(3),o=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function s(e,t){var n=0,i={};for(t|=0;n<e.length;)i[o[n+t]]=e[n++];return i}i.basic=s([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),i.defaults=s([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",r.emptyArray,null]),i.long=s([0,0,0,1,1],7),i.mapKey=s([0,0,0,5,5,0,0,0,1,1,0,2],2),i.packed=s([1,5,0,0,0,5,5,0,0,0,1,1,0])},function(e,t,n){"use strict";e.exports=c;var i=n(11);((c.prototype=Object.create(i.prototype)).constructor=c).className="Namespace";var r,o,s,a=n(10),u=n(3);function l(e,t){if(e&&e.length){for(var n={},i=0;i<e.length;++i)n[e[i].name]=e[i].toJSON(t);return n}}function c(e,t){i.call(this,e,t),this.nested=void 0,this._nestedArray=null}function d(e){return e._nestedArray=null,e}c.fromJSON=function(e,t){return new c(e,t.options).addJSON(t.nested)},c.arrayToJSON=l,c.isReservedId=function(e,t){if(e)for(var n=0;n<e.length;++n)if("string"!=typeof e[n]&&e[n][0]<=t&&e[n][1]>t)return!0;return!1},c.isReservedName=function(e,t){if(e)for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1},Object.defineProperty(c.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=u.toArray(this.nested))}}),c.prototype.toJSON=function(e){return u.toObject(["options",this.options,"nested",l(this.nestedArray,e)])},c.prototype.addJSON=function(e){if(e)for(var t,n=Object.keys(e),i=0;i<n.length;++i)t=e[n[i]],this.add((void 0!==t.fields?r.fromJSON:void 0!==t.values?s.fromJSON:void 0!==t.methods?o.fromJSON:void 0!==t.id?a.fromJSON:c.fromJSON)(n[i],t));return this},c.prototype.get=function(e){return this.nested&&this.nested[e]||null},c.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof s)return this.nested[e].values;throw Error("no such enum: "+e)},c.prototype.add=function(e){if(!(e instanceof a&&void 0!==e.extend||e instanceof r||e instanceof s||e instanceof o||e instanceof c))throw TypeError("object must be a valid nested object");if(this.nested){var t=this.get(e.name);if(t){if(!(t instanceof c&&e instanceof c)||t instanceof r||t instanceof o)throw Error("duplicate name '"+e.name+"' in "+this);for(var n=t.nestedArray,i=0;i<n.length;++i)e.add(n[i]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}}else this.nested={};return this.nested[e.name]=e,e.onAdd(this),d(this)},c.prototype.remove=function(e){if(!(e instanceof i))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),d(this)},c.prototype.define=function(e,t){if(u.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&""===e[0])throw Error("path must be relative");for(var n=this;e.length>0;){var i=e.shift();if(n.nested&&n.nested[i]){if(!((n=n.nested[i])instanceof c))throw Error("path conflicts with non-namespace objects")}else n.add(n=new c(i))}return t&&n.addJSON(t),n},c.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof c?e[t++].resolveAll():e[t++].resolve();return this.resolve()},c.prototype.lookup=function(e,t,n){if("boolean"==typeof t?(n=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),u.isString(e)&&e.length){if("."===e)return this.root;e=e.split(".")}else if(!e.length)return this;if(""===e[0])return this.root.lookup(e.slice(1),t);var i=this.get(e[0]);if(i){if(1===e.length){if(!t||t.indexOf(i.constructor)>-1)return i}else if(i instanceof c&&(i=i.lookup(e.slice(1),t,!0)))return i}else for(var r=0;r<this.nestedArray.length;++r)if(this._nestedArray[r]instanceof c&&(i=this._nestedArray[r].lookup(e,t,!0)))return i;return null===this.parent||n?null:this.parent.lookup(e,t)},c.prototype.lookupType=function(e){var t=this.lookup(e,[r]);if(!t)throw Error("no such type: "+e);return t},c.prototype.lookupEnum=function(e){var t=this.lookup(e,[s]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t},c.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[r,s]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t},c.prototype.lookupService=function(e){var t=this.lookup(e,[o]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t},c._configure=function(e,t,n){r=e,o=t,s=n}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Emitter=class{constructor(){this.handlers={}}on(e,t){this.handlers||(this.handlers={}),this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push(t)}once(e,t){this.handlers||(this.handlers={}),this.handlers[e]=this.handlers[e]||[];const n=()=>{t(),this.off(e,n)};return this.handlers[e].push(n),this}off(e,t){let n=this.handlers&&this.handlers[e];if(n)for(let e=0;e<n.length;e++)n[e]===t&&n.splice(e--,1)}emit(e,...t){if(this.handlers&&this.handlers[e])for(const n of this.handlers[e])n(...t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HUMMER_EVENTS={CONNECTION_STATE_CHANGED:"ConnectionStateChanged",TOKEN_EXPIRED:"TokenExpired"},t.ROOM_EVENTS={ROOM_MESSAGE:"RoomMessage",MEMBER_JOINED:"MemberJoined",MEMBER_LEFT:"MemberLeft",MEMBER_COUNT_UPDATED:"MemberCountUpdated",MEMBER_ATTRIBUTES_SET:"MemberAttributesSet",MEMBER_ATTRIBUTES_DELETED:"MemberAttributesDeleted",MEMBER_ATTRIBUTES_CLEARED:"MemberAttributesCleared",MEMBER_ATTRIBUTES_ADDED_OR_UPDATED:"MemberAttributesAddedOrUpdated",ROOM_ATTRIBUTES_SET:"RoomAttributesSet",ROOM_ATTRIBUTES_DELETED:"RoomAttributesDeleted",ROOM_ATTRIBUTES_CLEARED:"RoomAttributesCleared",ROOM_ATTRIBUTES_ADDED_OR_UPDATED:"RoomAttributesAddedOrUpdated",ROOM_MEMBER_OFFLINE:"RoomMemberOffline"},t.PEER_EVENTS={MESSAGE_FROM_USER:"MessageFromUser"},t.CHATROOM_EVENTS={SINGLE_USER_MESSAGE:"SingleUserMessage",CHATROOM_DISMISSED:"ChatRoomDismissed",ROOM_ATTRIBUTES_UPDATED:"ChatRoomAttributesUpdated",USER_KICKED_OFF:"UserKickedOff",ROLER_UPDATED:"RolerUpdated",GROUP_MESSAGE:"GroupMessage",TEXTCHAT:"TextChat",USER_COUNT_UPDATED:"UserCountUpdated",USER_ONLINE_UPDATED:"UserOnlineUpdated",USER_ATTRIBUTES_SET:"UserAttributesSet",BROADCAST_MESSAGE:"BroadcastMessage",UNICAST_MESSAGE:"UnicastMessage"},t.AP_EVENTS={TRY_LOGOUT:"TryLogout",CONNECTION_STATE_CHANGED:"ConnectionStateChanged",TOKEN_EXPIRED:"TokenExpired",BROADCAST:"broadcast",INNER_BROADCAST:"inner_broadcast",BROADCAST_V2:"broadcast_v2",UNICAST:"unicast",FORCE_OUT:"force_out"}},function(e,t,n){"use strict";e.exports=s;var i=n(11);((s.prototype=Object.create(i.prototype)).constructor=s).className="OneOf";var r=n(10),o=n(3);function s(e,t,n,r){if(Array.isArray(t)||(n=t,t=void 0),i.call(this,e,n),void 0!==t&&!Array.isArray(t))throw TypeError("fieldNames must be an Array");this.oneof=t||[],this.fieldsArray=[],this.comment=r}function a(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)e.fieldsArray[t].parent||e.parent.add(e.fieldsArray[t])}s.fromJSON=function(e,t){return new s(e,t.oneof,t.options,t.comment)},s.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])},s.prototype.add=function(e){if(!(e instanceof r))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,a(this),this},s.prototype.remove=function(e){if(!(e instanceof r))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),(t=this.oneof.indexOf(e.name))>-1&&this.oneof.splice(t,1),e.partOf=null,this},s.prototype.onAdd=function(e){i.prototype.onAdd.call(this,e);for(var t=0;t<this.oneof.length;++t){var n=e.get(this.oneof[t]);n&&!n.partOf&&(n.partOf=this,this.fieldsArray.push(n))}a(this)},s.prototype.onRemove=function(e){for(var t,n=0;n<this.fieldsArray.length;++n)(t=this.fieldsArray[n]).parent&&t.parent.remove(t);i.prototype.onRemove.call(this,e)},s.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(t,n){o.decorateType(t.constructor).add(new s(n,e)),Object.defineProperty(t,n,{get:o.oneOfGetter(e),set:o.oneOfSetter(e)})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=0,r={now:function(){0===i&&(i=Date.now()-1);let e=Date.now()-i;return e>4294967295?(i+=4294967295,Date.now()-i):e},utc:function(){return Math.round(Date.now()/1e3)}};t.default=r},function(e,t,n){"use strict";e.exports=d;var i,r=n(8),o=r.LongBits,s=r.base64,a=r.utf8;function u(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function l(){}function c(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function d(){this.len=0,this.head=new u(l,0,0),this.tail=this.head,this.states=null}var h=function(){return r.Buffer?function(){return(d.create=function(){return new i})()}:function(){return new d}};function p(e,t,n){t[n]=255&e}function f(e,t){this.len=e,this.next=void 0,this.val=t}function g(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function m(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}d.create=h(),d.alloc=function(e){return new r.Array(e)},r.Array!==Array&&(d.alloc=r.pool(d.alloc,r.Array.prototype.subarray)),d.prototype._push=function(e,t,n){return this.tail=this.tail.next=new u(e,t,n),this.len+=t,this},f.prototype=Object.create(u.prototype),f.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},d.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new f((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},d.prototype.int32=function(e){return e<0?this._push(g,10,o.fromNumber(e)):this.uint32(e)},d.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},d.prototype.uint64=function(e){var t=o.from(e);return this._push(g,t.length(),t)},d.prototype.int64=d.prototype.uint64,d.prototype.sint64=function(e){var t=o.from(e).zzEncode();return this._push(g,t.length(),t)},d.prototype.bool=function(e){return this._push(p,1,e?1:0)},d.prototype.fixed32=function(e){return this._push(m,4,e>>>0)},d.prototype.sfixed32=d.prototype.fixed32,d.prototype.fixed64=function(e){var t=o.from(e);return this._push(m,4,t.lo)._push(m,4,t.hi)},d.prototype.sfixed64=d.prototype.fixed64,d.prototype.float=function(e){return this._push(r.float.writeFloatLE,4,e)},d.prototype.double=function(e){return this._push(r.float.writeDoubleLE,8,e)};var y=r.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var i=0;i<e.length;++i)t[n+i]=e[i]};d.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(p,1,0);if(r.isString(e)){var n=d.alloc(t=s.length(e));s.decode(e,n,0),e=n}return this.uint32(t)._push(y,t,e)},d.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(p,1,0)},d.prototype.fork=function(){return this.states=new c(this),this.head=this.tail=new u(l,0,0),this.len=0,this},d.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new u(l,0,0),this.len=0),this},d.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},d.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},d._configure=function(e){i=e,d.create=h(),i._configure()}},function(e,t,n){"use strict";e.exports=u;var i,r=n(8),o=r.LongBits,s=r.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function u(e){this.buf=e,this.pos=0,this.len=e.length}var l,c="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new u(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new u(e);throw Error("illegal buffer")},d=function(){return r.Buffer?function(e){return(u.create=function(e){return r.Buffer.isBuffer(e)?new i(e):c(e)})(e)}:c};function h(){var e=new o(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function p(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw a(this,8);return new o(p(this.buf,this.pos+=4),p(this.buf,this.pos+=4))}u.create=d(),u.prototype._slice=r.Array.prototype.subarray||r.Array.prototype.slice,u.prototype.uint32=(l=4294967295,function(){if(l=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return l;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return l}),u.prototype.int32=function(){return 0|this.uint32()},u.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},u.prototype.bool=function(){return 0!==this.uint32()},u.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return p(this.buf,this.pos+=4)},u.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|p(this.buf,this.pos+=4)},u.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=r.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},u.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=r.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},u.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},u.prototype.string=function(){var e=this.bytes();return s.read(e,0,e.length)},u.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},u.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},u._configure=function(e){i=e,u.create=d(),i._configure();var t=r.Long?"toLong":"toNumber";r.merge(u.prototype,{int64:function(){return h.call(this)[t](!1)},uint64:function(){return h.call(this)[t](!0)},sint64:function(){return h.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}},function(e,t,n){"use strict";e.exports=b;var i=n(13);((b.prototype=Object.create(i.prototype)).constructor=b).className="Type";var r=n(6),o=n(17),s=n(10),a=n(22),u=n(23),l=n(25),c=n(20),d=n(19),h=n(3),p=n(47),f=n(48),g=n(49),m=n(50),y=n(51);function b(e,t){i.call(this,e,t),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function v(e){return e._fieldsById=e._fieldsArray=e._oneofsArray=null,delete e.encode,delete e.decode,delete e.verify,e}Object.defineProperties(b.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var n=this.fields[e[t]],i=n.id;if(this._fieldsById[i])throw Error("duplicate id "+i+" in "+this);this._fieldsById[i]=n}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=h.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=h.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=b.generateConstructor(this)())},set:function(e){var t=e.prototype;t instanceof l||((e.prototype=new l).constructor=e,h.merge(e.prototype,t)),e.$type=e.prototype.$type=this,h.merge(e,l,!0),this._ctor=e;for(var n=0;n<this.fieldsArray.length;++n)this._fieldsArray[n].resolve();var i={};for(n=0;n<this.oneofsArray.length;++n)i[this._oneofsArray[n].resolve().name]={get:h.oneOfGetter(this._oneofsArray[n].oneof),set:h.oneOfSetter(this._oneofsArray[n].oneof)};n&&Object.defineProperties(e.prototype,i)}}}),b.generateConstructor=function(e){for(var t,n=h.codegen(["p"],e.name),i=0;i<e.fieldsArray.length;++i)(t=e._fieldsArray[i]).map?n("this%s={}",h.safeProp(t.name)):t.repeated&&n("this%s=[]",h.safeProp(t.name));return n("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},b.fromJSON=function(e,t){var n=new b(e,t.options);n.extensions=t.extensions,n.reserved=t.reserved;for(var l=Object.keys(t.fields),c=0;c<l.length;++c)n.add((void 0!==t.fields[l[c]].keyType?a.fromJSON:s.fromJSON)(l[c],t.fields[l[c]]));if(t.oneofs)for(l=Object.keys(t.oneofs),c=0;c<l.length;++c)n.add(o.fromJSON(l[c],t.oneofs[l[c]]));if(t.nested)for(l=Object.keys(t.nested),c=0;c<l.length;++c){var d=t.nested[l[c]];n.add((void 0!==d.id?s.fromJSON:void 0!==d.fields?b.fromJSON:void 0!==d.values?r.fromJSON:void 0!==d.methods?u.fromJSON:i.fromJSON)(l[c],d))}return t.extensions&&t.extensions.length&&(n.extensions=t.extensions),t.reserved&&t.reserved.length&&(n.reserved=t.reserved),t.group&&(n.group=!0),t.comment&&(n.comment=t.comment),n},b.prototype.toJSON=function(e){var t=i.prototype.toJSON.call(this,e),n=!!e&&Boolean(e.keepComments);return h.toObject(["options",t&&t.options||void 0,"oneofs",i.arrayToJSON(this.oneofsArray,e),"fields",i.arrayToJSON(this.fieldsArray.filter((function(e){return!e.declaringField})),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",n?this.comment:void 0])},b.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var n=this.oneofsArray;for(t=0;t<n.length;)n[t++].resolve();return i.prototype.resolveAll.call(this)},b.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null},b.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof s&&void 0===e.extend){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),v(this)}return e instanceof o?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),v(this)):i.prototype.add.call(this,e)},b.prototype.remove=function(e){if(e instanceof s&&void 0===e.extend){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),v(this)}if(e instanceof o){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),v(this)}return i.prototype.remove.call(this,e)},b.prototype.isReservedId=function(e){return i.isReservedId(this.reserved,e)},b.prototype.isReservedName=function(e){return i.isReservedName(this.reserved,e)},b.prototype.create=function(e){return new this.ctor(e)},b.prototype.setup=function(){for(var e=this.fullName,t=[],n=0;n<this.fieldsArray.length;++n)t.push(this._fieldsArray[n].resolve().resolvedType);this.encode=p(this)({Writer:d,types:t,util:h}),this.decode=f(this)({Reader:c,types:t,util:h}),this.verify=g(this)({types:t,util:h}),this.fromObject=m.fromObject(this)({types:t,util:h}),this.toObject=m.toObject(this)({types:t,util:h});var i=y[e];if(i){var r=Object.create(this);r.fromObject=this.fromObject,this.fromObject=i.fromObject.bind(r),r.toObject=this.toObject,this.toObject=i.toObject.bind(r)}return this},b.prototype.encode=function(e,t){return this.setup().encode(e,t)},b.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()},b.prototype.decode=function(e,t){return this.setup().decode(e,t)},b.prototype.decodeDelimited=function(e){return e instanceof c||(e=c.create(e)),this.decode(e,e.uint32())},b.prototype.verify=function(e){return this.setup().verify(e)},b.prototype.fromObject=function(e){return this.setup().fromObject(e)},b.prototype.toObject=function(e,t){return this.setup().toObject(e,t)},b.d=function(e){return function(t){h.decorateType(t,e)}}},function(e,t,n){"use strict";e.exports=s;var i=n(10);((s.prototype=Object.create(i.prototype)).constructor=s).className="MapField";var r=n(12),o=n(3);function s(e,t,n,r,s,a){if(i.call(this,e,t,r,void 0,void 0,s,a),!o.isString(n))throw TypeError("keyType must be a string");this.keyType=n,this.resolvedKeyType=null,this.map=!0}s.fromJSON=function(e,t){return new s(e,t.id,t.keyType,t.type,t.options,t.comment)},s.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},s.prototype.resolve=function(){if(this.resolved)return this;if(void 0===r.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return i.prototype.resolve.call(this)},s.d=function(e,t,n){return"function"==typeof n?n=o.decorateType(n).name:n&&"object"==typeof n&&(n=o.decorateEnum(n).name),function(i,r){o.decorateType(i.constructor).add(new s(r,e,t,n))}}},function(e,t,n){"use strict";e.exports=a;var i=n(13);((a.prototype=Object.create(i.prototype)).constructor=a).className="Service";var r=n(24),o=n(3),s=n(44);function a(e,t){i.call(this,e,t),this.methods={},this._methodsArray=null}function u(e){return e._methodsArray=null,e}a.fromJSON=function(e,t){var n=new a(e,t.options);if(t.methods)for(var i=Object.keys(t.methods),o=0;o<i.length;++o)n.add(r.fromJSON(i[o],t.methods[i[o]]));return t.nested&&n.addJSON(t.nested),n.comment=t.comment,n},a.prototype.toJSON=function(e){var t=i.prototype.toJSON.call(this,e),n=!!e&&Boolean(e.keepComments);return o.toObject(["options",t&&t.options||void 0,"methods",i.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",n?this.comment:void 0])},Object.defineProperty(a.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=o.toArray(this.methods))}}),a.prototype.get=function(e){return this.methods[e]||i.prototype.get.call(this,e)},a.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return i.prototype.resolve.call(this)},a.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof r?(this.methods[e.name]=e,e.parent=this,u(this)):i.prototype.add.call(this,e)},a.prototype.remove=function(e){if(e instanceof r){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,u(this)}return i.prototype.remove.call(this,e)},a.prototype.create=function(e,t,n){for(var i,r=new s.Service(e,t,n),a=0;a<this.methodsArray.length;++a){var u=o.lcFirst((i=this._methodsArray[a]).resolve().name).replace(/[^$\w_]/g,"");r[u]=o.codegen(["r","c"],o.isReserved(u)?u+"_":u)("return this.rpcCall(m,q,s,r,c)")({m:i,q:i.resolvedRequestType.ctor,s:i.resolvedResponseType.ctor})}return r}},function(e,t,n){"use strict";e.exports=o;var i=n(11);((o.prototype=Object.create(i.prototype)).constructor=o).className="Method";var r=n(3);function o(e,t,n,o,s,a,u,l){if(r.isObject(s)?(u=s,s=a=void 0):r.isObject(a)&&(u=a,a=void 0),void 0!==t&&!r.isString(t))throw TypeError("type must be a string");if(!r.isString(n))throw TypeError("requestType must be a string");if(!r.isString(o))throw TypeError("responseType must be a string");i.call(this,e,u),this.type=t||"rpc",this.requestType=n,this.requestStream=!!s||void 0,this.responseType=o,this.responseStream=!!a||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=l}o.fromJSON=function(e,t){return new o(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment)},o.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return r.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0])},o.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),i.prototype.resolve.call(this))}},function(e,t,n){"use strict";e.exports=r;var i=n(8);function r(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)this[t[n]]=e[t[n]]}r.create=function(e){return this.$type.create(e)},r.encode=function(e,t){return this.$type.encode(e,t)},r.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)},r.decode=function(e){return this.$type.decode(e)},r.decodeDelimited=function(e){return this.$type.decodeDelimited(e)},r.verify=function(e){return this.$type.verify(e)},r.fromObject=function(e){return this.$type.fromObject(e)},r.toObject=function(e,t){return this.$type.toObject(e,t)},r.prototype.toJSON=function(){return this.$type.toObject(this,i.toJSONOptions)}},function(e,t,n){"use strict";e.exports=d;var i=n(13);((d.prototype=Object.create(i.prototype)).constructor=d).className="Root";var r,o,s,a=n(10),u=n(6),l=n(17),c=n(3);function d(e){i.call(this,"",e),this.deferred=[],this.files=[]}function h(){}d.fromJSON=function(e,t){return t||(t=new d),e.options&&t.setOptions(e.options),t.addJSON(e.nested)},d.prototype.resolvePath=c.path.resolve,d.prototype.load=function e(t,n,i){"function"==typeof n&&(i=n,n=void 0);var r=this;if(!i)return c.asPromise(e,r,t,n);var a=i===h;function u(e,t){if(i){var n=i;if(i=null,a)throw e;n(e,t)}}function l(e){var t=e.lastIndexOf("google/protobuf/");if(t>-1){var n=e.substring(t);if(n in s)return n}return null}function d(e,t){try{if(c.isString(t)&&"{"===t.charAt(0)&&(t=JSON.parse(t)),c.isString(t)){o.filename=e;var i,s=o(t,r,n),d=0;if(s.imports)for(;d<s.imports.length;++d)(i=l(s.imports[d])||r.resolvePath(e,s.imports[d]))&&p(i);if(s.weakImports)for(d=0;d<s.weakImports.length;++d)(i=l(s.weakImports[d])||r.resolvePath(e,s.weakImports[d]))&&p(i,!0)}else r.setOptions(t.options).addJSON(t.nested)}catch(e){u(e)}a||f||u(null,r)}function p(e,t){if(!(r.files.indexOf(e)>-1))if(r.files.push(e),e in s)a?d(e,s[e]):(++f,setTimeout((function(){--f,d(e,s[e])})));else if(a){var n;try{n=c.fs.readFileSync(e).toString("utf8")}catch(e){return void(t||u(e))}d(e,n)}else++f,c.fetch(e,(function(n,o){--f,i&&(n?t?f||u(null,r):u(n):d(e,o))}))}var f=0;c.isString(t)&&(t=[t]);for(var g,m=0;m<t.length;++m)(g=r.resolvePath("",t[m]))&&p(g);if(a)return r;f||u(null,r)},d.prototype.loadSync=function(e,t){if(!c.isNode)throw Error("not supported");return this.load(e,t,h)},d.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map((function(e){return"'extend "+e.extend+"' in "+e.parent.fullName})).join(", "));return i.prototype.resolveAll.call(this)};var p=/^[A-Z]/;function f(e,t){var n=t.parent.lookup(t.extend);if(n){var i=new a(t.fullName,t.id,t.type,t.rule,void 0,t.options);return i.declaringField=t,t.extensionField=i,n.add(i),!0}return!1}d.prototype._handleAdd=function(e){if(e instanceof a)void 0===e.extend||e.extensionField||f(0,e)||this.deferred.push(e);else if(e instanceof u)p.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof l)){if(e instanceof r)for(var t=0;t<this.deferred.length;)f(0,this.deferred[t])?this.deferred.splice(t,1):++t;for(var n=0;n<e.nestedArray.length;++n)this._handleAdd(e._nestedArray[n]);p.test(e.name)&&(e.parent[e.name]=e)}},d.prototype._handleRemove=function(e){if(e instanceof a){if(void 0!==e.extend)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof u)p.test(e.name)&&delete e.parent[e.name];else if(e instanceof i){for(var n=0;n<e.nestedArray.length;++n)this._handleRemove(e._nestedArray[n]);p.test(e.name)&&delete e.parent[e.name]}},d._configure=function(e,t,n){r=e,o=t,s=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.lockers=new Map}lock(e){this.lockers.set(e,!0)}unlock(e){this.lockers.set(e,!1)}wait(e){return new Promise((t,n)=>{setTimeout(()=>{this.lockers.get(e)?n({rescode:1008,msg:e+" has been locked"}):t()})})}islock(e){return this.lockers.get(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(4),r=n(105),o=n(7);class s{constructor(){}getTokenType(e){if(!e)return o.TokenType.TOKEN_3RD;let t=new Map([["OTP_TOKEN",o.TokenType.OTP_TOKEN],["TOKEN_3RD",o.TokenType.TOKEN_3RD],["YY_TOKEN",o.TokenType.YY_TOKEN]]).get(e);return void 0===t?o.TokenType.UNKOWN:t}getRegionRoomId(e,t){return`${e}:${t}`}calcDJBHash(e){const t=r.Base64.encode(e);let n=i.fromInt(5381,!0);for(let e=0;e<t.length;++e){let r=n.shl(5);n=n.add(r),n=n.add(i.fromInt(t.charCodeAt(e),!0))}return new i(n.getLowBitsUnsigned(),0,!0)}getRoomIdFromTopic(e){let t=e.split("/");return 2!=t.length?null:"SignalService"===t[0]?t[1]:void 0}generateLogId(){let e=Math.round(Date.now()/1e3);return new i(this.getCounter(),e,!0)}getCounter(){return s.counter+=1,s.counter}}s.counter=0,t.Base=s},function(e,t,n){"use strict";var i,r,o,s=n(40),a=s.Reader,u=s.Writer,l=s.util,c=s.roots.default||(s.roots.default={});c.proto=((o={}).Action=(i={},(r=Object.create(i))[i[0]="kLogin"]=0,r[i[3e3]="kP2PChat"]=3e3,r[i[1e6]="kNotifySignalMessage"]=1e6,r[i[1000001]="kNotifyJoinSignalGroup"]=1000001,r[i[1000002]="kNotifyLeaveSignalGroup"]=1000002,r[i[1000003]="kNotifyUinfoChange"]=1000003,r[i[1000004]="kNotifyUserOnlineStatusChange"]=1000004,r[i[1000005]="kNotifyUserCountChange"]=1000005,r[i[1000006]="kNotifyChannelPropsChange"]=1000006,r),o.GetMaxSeqIdRequest=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.appId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.selfUid=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.topic="",e.prototype.queueId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.appId&&e.hasOwnProperty("appId")&&t.uint32(16).int64(e.appId),null!=e.selfUid&&e.hasOwnProperty("selfUid")&&t.uint32(24).int64(e.selfUid),null!=e.topic&&e.hasOwnProperty("topic")&&t.uint32(34).string(e.topic),null!=e.queueId&&e.hasOwnProperty("queueId")&&t.uint32(40).int32(e.queueId),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.GetMaxSeqIdRequest;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.appId=e.int64();break;case 3:i.selfUid=e.int64();break;case 4:i.topic=e.string();break;case 5:i.queueId=e.int32();break;default:e.skipType(7&r)}}return i},e}(),o.GetMaxSeqIdResponse=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.code=0,e.prototype.msg="",e.prototype.maxSeqId=l.Long?l.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(16).int32(e.code),null!=e.msg&&e.hasOwnProperty("msg")&&t.uint32(26).string(e.msg),null!=e.maxSeqId&&e.hasOwnProperty("maxSeqId")&&t.uint32(32).int64(e.maxSeqId),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.GetMaxSeqIdResponse;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.code=e.int32();break;case 3:i.msg=e.string();break;case 4:i.maxSeqId=e.int64();break;default:e.skipType(7&r)}}return i},e}(),o.GetGrpSysMaxSeqIdRequest=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.appId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.selfUid=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.groupId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.topic="",e.prototype.queueId=0,e.prototype.groupRegion="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.appId&&e.hasOwnProperty("appId")&&t.uint32(16).int64(e.appId),null!=e.selfUid&&e.hasOwnProperty("selfUid")&&t.uint32(24).int64(e.selfUid),null!=e.groupId&&e.hasOwnProperty("groupId")&&t.uint32(32).int64(e.groupId),null!=e.topic&&e.hasOwnProperty("topic")&&t.uint32(42).string(e.topic),null!=e.queueId&&e.hasOwnProperty("queueId")&&t.uint32(48).int32(e.queueId),null!=e.groupRegion&&e.hasOwnProperty("groupRegion")&&t.uint32(58).string(e.groupRegion),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.GetGrpSysMaxSeqIdRequest;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.appId=e.int64();break;case 3:i.selfUid=e.int64();break;case 4:i.groupId=e.int64();break;case 5:i.topic=e.string();break;case 6:i.queueId=e.int32();break;case 7:i.groupRegion=e.string();break;default:e.skipType(7&r)}}return i},e}(),o.GetGrpSysMaxSeqIdResponse=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.code=0,e.prototype.msg="",e.prototype.maxSeqId=l.Long?l.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(16).int32(e.code),null!=e.msg&&e.hasOwnProperty("msg")&&t.uint32(26).string(e.msg),null!=e.maxSeqId&&e.hasOwnProperty("maxSeqId")&&t.uint32(32).int64(e.maxSeqId),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.GetGrpSysMaxSeqIdResponse;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.code=e.int32();break;case 3:i.msg=e.string();break;case 4:i.maxSeqId=e.int64();break;default:e.skipType(7&r)}}return i},e}(),o.IMPushMsgRequest=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.uid=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.seqId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.groupId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.region="",e.prototype.envType="",e.prototype.envName="",e.prototype.topic="",e.prototype.queueId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.uid&&e.hasOwnProperty("uid")&&t.uint32(16).int64(e.uid),null!=e.seqId&&e.hasOwnProperty("seqId")&&t.uint32(24).int64(e.seqId),null!=e.groupId&&e.hasOwnProperty("groupId")&&t.uint32(32).int64(e.groupId),null!=e.region&&e.hasOwnProperty("region")&&t.uint32(42).string(e.region),null!=e.envType&&e.hasOwnProperty("envType")&&t.uint32(50).string(e.envType),null!=e.envName&&e.hasOwnProperty("envName")&&t.uint32(58).string(e.envName),null!=e.topic&&e.hasOwnProperty("topic")&&t.uint32(66).string(e.topic),null!=e.queueId&&e.hasOwnProperty("queueId")&&t.uint32(72).int32(e.queueId),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.IMPushMsgRequest;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.uid=e.int64();break;case 3:i.seqId=e.int64();break;case 4:i.groupId=e.int64();break;case 5:i.region=e.string();break;case 6:i.envType=e.string();break;case 7:i.envName=e.string();break;case 8:i.topic=e.string();break;case 9:i.queueId=e.int32();break;default:e.skipType(7&r)}}return i},e}(),o.IMPushMsgResponse=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.code=0,e.prototype.msg="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(16).int32(e.code),null!=e.msg&&e.hasOwnProperty("msg")&&t.uint32(26).string(e.msg),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.IMPushMsgResponse;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.code=e.int32();break;case 3:i.msg=e.string();break;default:e.skipType(7&r)}}return i},e}(),o.IMPushGroupSysMsgRequest=function(){function e(e){if(this.targetUserTags=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.groupId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.seqId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.region="",e.prototype.envType="",e.prototype.envName="",e.prototype.topic="",e.prototype.prevSeqId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.msg=null,e.prototype.targetUserTags=l.emptyArray,e.prototype.queueId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.groupId&&e.hasOwnProperty("groupId")&&t.uint32(16).int64(e.groupId),null!=e.seqId&&e.hasOwnProperty("seqId")&&t.uint32(24).int64(e.seqId),null!=e.region&&e.hasOwnProperty("region")&&t.uint32(34).string(e.region),null!=e.envType&&e.hasOwnProperty("envType")&&t.uint32(42).string(e.envType),null!=e.envName&&e.hasOwnProperty("envName")&&t.uint32(50).string(e.envName),null!=e.topic&&e.hasOwnProperty("topic")&&t.uint32(58).string(e.topic),null!=e.prevSeqId&&e.hasOwnProperty("prevSeqId")&&t.uint32(64).int64(e.prevSeqId),null!=e.msg&&e.hasOwnProperty("msg")&&c.proto.Msg.encode(e.msg,t.uint32(74).fork()).ldelim(),null!=e.targetUserTags&&e.targetUserTags.length)for(var n=0;n<e.targetUserTags.length;++n)t.uint32(82).string(e.targetUserTags[n]);return null!=e.queueId&&e.hasOwnProperty("queueId")&&t.uint32(88).int32(e.queueId),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.IMPushGroupSysMsgRequest;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.groupId=e.int64();break;case 3:i.seqId=e.int64();break;case 4:i.region=e.string();break;case 5:i.envType=e.string();break;case 6:i.envName=e.string();break;case 7:i.topic=e.string();break;case 8:i.prevSeqId=e.int64();break;case 9:i.msg=c.proto.Msg.decode(e,e.uint32());break;case 10:i.targetUserTags&&i.targetUserTags.length||(i.targetUserTags=[]),i.targetUserTags.push(e.string());break;case 11:i.queueId=e.int32();break;default:e.skipType(7&r)}}return i},e}(),o.IMPushGroupSysMsgResponse=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.code=0,e.prototype.msg="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(16).int32(e.code),null!=e.msg&&e.hasOwnProperty("msg")&&t.uint32(26).string(e.msg),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.IMPushGroupSysMsgResponse;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.code=e.int32();break;case 3:i.msg=e.string();break;default:e.skipType(7&r)}}return i},e}(),o.PullMsgRequest=function(){function e(e){if(this.userTags=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.appId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.selfUid=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.exclusiveStartSeqId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.limit=0,e.prototype.userTags=l.emptyArray,e.prototype.statisDeliveryDelay=!1,e.prototype.topic="",e.prototype.queueId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.appId&&e.hasOwnProperty("appId")&&t.uint32(16).int64(e.appId),null!=e.selfUid&&e.hasOwnProperty("selfUid")&&t.uint32(24).int64(e.selfUid),null!=e.exclusiveStartSeqId&&e.hasOwnProperty("exclusiveStartSeqId")&&t.uint32(32).int64(e.exclusiveStartSeqId),null!=e.limit&&e.hasOwnProperty("limit")&&t.uint32(40).int32(e.limit),null!=e.userTags&&e.userTags.length)for(var n=0;n<e.userTags.length;++n)t.uint32(50).string(e.userTags[n]);return null!=e.statisDeliveryDelay&&e.hasOwnProperty("statisDeliveryDelay")&&t.uint32(56).bool(e.statisDeliveryDelay),null!=e.topic&&e.hasOwnProperty("topic")&&t.uint32(66).string(e.topic),null!=e.queueId&&e.hasOwnProperty("queueId")&&t.uint32(72).int32(e.queueId),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.PullMsgRequest;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.appId=e.int64();break;case 3:i.selfUid=e.int64();break;case 4:i.exclusiveStartSeqId=e.int64();break;case 5:i.limit=e.int32();break;case 6:i.userTags&&i.userTags.length||(i.userTags=[]),i.userTags.push(e.string());break;case 7:i.statisDeliveryDelay=e.bool();break;case 8:i.topic=e.string();break;case 9:i.queueId=e.int32();break;default:e.skipType(7&r)}}return i},e}(),o.PullMsgResponse=function(){function e(e){if(this.msgs=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.code=0,e.prototype.msg="",e.prototype.msgs=l.emptyArray,e.prototype.maxSeqId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.hasMore=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(16).int32(e.code),null!=e.msg&&e.hasOwnProperty("msg")&&t.uint32(26).string(e.msg),null!=e.msgs&&e.msgs.length)for(var n=0;n<e.msgs.length;++n)c.proto.Msg.encode(e.msgs[n],t.uint32(34).fork()).ldelim();return null!=e.maxSeqId&&e.hasOwnProperty("maxSeqId")&&t.uint32(40).int64(e.maxSeqId),null!=e.hasMore&&e.hasOwnProperty("hasMore")&&t.uint32(48).bool(e.hasMore),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.PullMsgResponse;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.code=e.int32();break;case 3:i.msg=e.string();break;case 4:i.msgs&&i.msgs.length||(i.msgs=[]),i.msgs.push(c.proto.Msg.decode(e,e.uint32()));break;case 5:i.maxSeqId=e.int64();break;case 6:i.hasMore=e.bool();break;default:e.skipType(7&r)}}return i},e}(),o.PullGroupSysMsgRequest=function(){function e(e){if(this.userTags=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.appId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.selfUid=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.groupId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.exclusiveStartSeqId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.limit=0,e.prototype.userTags=l.emptyArray,e.prototype.statisDeliveryDelay=!1,e.prototype.topic="",e.prototype.queueId=0,e.prototype.groupRegion="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.appId&&e.hasOwnProperty("appId")&&t.uint32(16).int64(e.appId),null!=e.selfUid&&e.hasOwnProperty("selfUid")&&t.uint32(24).int64(e.selfUid),null!=e.groupId&&e.hasOwnProperty("groupId")&&t.uint32(32).int64(e.groupId),null!=e.exclusiveStartSeqId&&e.hasOwnProperty("exclusiveStartSeqId")&&t.uint32(40).int64(e.exclusiveStartSeqId),null!=e.limit&&e.hasOwnProperty("limit")&&t.uint32(48).int32(e.limit),null!=e.userTags&&e.userTags.length)for(var n=0;n<e.userTags.length;++n)t.uint32(58).string(e.userTags[n]);return null!=e.statisDeliveryDelay&&e.hasOwnProperty("statisDeliveryDelay")&&t.uint32(64).bool(e.statisDeliveryDelay),null!=e.topic&&e.hasOwnProperty("topic")&&t.uint32(74).string(e.topic),null!=e.queueId&&e.hasOwnProperty("queueId")&&t.uint32(80).int32(e.queueId),null!=e.groupRegion&&e.hasOwnProperty("groupRegion")&&t.uint32(90).string(e.groupRegion),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.PullGroupSysMsgRequest;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.appId=e.int64();break;case 3:i.selfUid=e.int64();break;case 4:i.groupId=e.int64();break;case 5:i.exclusiveStartSeqId=e.int64();break;case 6:i.limit=e.int32();break;case 7:i.userTags&&i.userTags.length||(i.userTags=[]),i.userTags.push(e.string());break;case 8:i.statisDeliveryDelay=e.bool();break;case 9:i.topic=e.string();break;case 10:i.queueId=e.int32();break;case 11:i.groupRegion=e.string();break;default:e.skipType(7&r)}}return i},e}(),o.PullGroupSysMsgResponse=function(){function e(e){if(this.msgs=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.code=0,e.prototype.msg="",e.prototype.msgs=l.emptyArray,e.prototype.maxSeqId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.hasMore=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(16).int32(e.code),null!=e.msg&&e.hasOwnProperty("msg")&&t.uint32(26).string(e.msg),null!=e.msgs&&e.msgs.length)for(var n=0;n<e.msgs.length;++n)c.proto.Msg.encode(e.msgs[n],t.uint32(34).fork()).ldelim();return null!=e.maxSeqId&&e.hasOwnProperty("maxSeqId")&&t.uint32(40).int64(e.maxSeqId),null!=e.hasMore&&e.hasOwnProperty("hasMore")&&t.uint32(48).bool(e.hasMore),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.PullGroupSysMsgResponse;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.code=e.int32();break;case 3:i.msg=e.string();break;case 4:i.msgs&&i.msgs.length||(i.msgs=[]),i.msgs.push(c.proto.Msg.decode(e,e.uint32()));break;case 5:i.maxSeqId=e.int64();break;case 6:i.hasMore=e.bool();break;default:e.skipType(7&r)}}return i},e}(),o.NotifyUserStatusChange=function(){function e(e){if(this.joinuids=[],this.leaveuids=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.appId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.groupId="",e.prototype.joinuids=l.emptyArray,e.prototype.leaveuids=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.appId&&e.hasOwnProperty("appId")&&t.uint32(16).int64(e.appId),null!=e.groupId&&e.hasOwnProperty("groupId")&&t.uint32(26).string(e.groupId),null!=e.joinuids&&e.joinuids.length){t.uint32(34).fork();for(var n=0;n<e.joinuids.length;++n)t.uint64(e.joinuids[n]);t.ldelim()}if(null!=e.leaveuids&&e.leaveuids.length){for(t.uint32(42).fork(),n=0;n<e.leaveuids.length;++n)t.uint64(e.leaveuids[n]);t.ldelim()}return t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.NotifyUserStatusChange;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.appId=e.int64();break;case 3:i.groupId=e.string();break;case 4:if(i.joinuids&&i.joinuids.length||(i.joinuids=[]),2==(7&r))for(var o=e.uint32()+e.pos;e.pos<o;)i.joinuids.push(e.uint64());else i.joinuids.push(e.uint64());break;case 5:if(i.leaveuids&&i.leaveuids.length||(i.leaveuids=[]),2==(7&r))for(o=e.uint32()+e.pos;e.pos<o;)i.leaveuids.push(e.uint64());else i.leaveuids.push(e.uint64());break;default:e.skipType(7&r)}}return i},e}(),o.NotifyJoinSignalGroup=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.appId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.uid=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.groupId="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.appId&&e.hasOwnProperty("appId")&&t.uint32(16).int64(e.appId),null!=e.uid&&e.hasOwnProperty("uid")&&t.uint32(24).int64(e.uid),null!=e.groupId&&e.hasOwnProperty("groupId")&&t.uint32(34).string(e.groupId),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.NotifyJoinSignalGroup;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.appId=e.int64();break;case 3:i.uid=e.int64();break;case 4:i.groupId=e.string();break;default:e.skipType(7&r)}}return i},e}(),o.NotifyLeaveSignalGroup=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.appId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.uid=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.groupId="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.appId&&e.hasOwnProperty("appId")&&t.uint32(16).int64(e.appId),null!=e.uid&&e.hasOwnProperty("uid")&&t.uint32(24).int64(e.uid),null!=e.groupId&&e.hasOwnProperty("groupId")&&t.uint32(34).string(e.groupId),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.NotifyLeaveSignalGroup;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.appId=e.int64();break;case 3:i.uid=e.int64();break;case 4:i.groupId=e.string();break;default:e.skipType(7&r)}}return i},e}(),o.Msg=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seqId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.action=0,e.prototype.content=l.newBuffer([]),e.prototype.timestamp=l.Long?l.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.seqId&&e.hasOwnProperty("seqId")&&t.uint32(8).int64(e.seqId),null!=e.action&&e.hasOwnProperty("action")&&t.uint32(16).int32(e.action),null!=e.content&&e.hasOwnProperty("content")&&t.uint32(26).bytes(e.content),null!=e.timestamp&&e.hasOwnProperty("timestamp")&&t.uint32(32).int64(e.timestamp),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.Msg;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.seqId=e.int64();break;case 2:i.action=e.int32();break;case 3:i.content=e.bytes();break;case 4:i.timestamp=e.int64();break;default:e.skipType(7&r)}}return i},e}(),o.SignalMessageOption=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.reliable="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.reliable&&e.hasOwnProperty("reliable")&&t.uint32(10).string(e.reliable),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.SignalMessageOption;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.reliable=e.string();break;default:e.skipType(7&r)}}return i},e}(),o.P2PSignalRequest=function(){function e(e){if(this.extensions={},this.internalExtensions={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.appId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.fromUid=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.toUid=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.type="",e.prototype.content=l.newBuffer([]),e.prototype.option=null,e.prototype.uuid="",e.prototype.extension="",e.prototype.extensions=l.emptyObject,e.prototype.internalExtensions=l.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.appId&&e.hasOwnProperty("appId")&&t.uint32(16).int64(e.appId),null!=e.fromUid&&e.hasOwnProperty("fromUid")&&t.uint32(24).int64(e.fromUid),null!=e.toUid&&e.hasOwnProperty("toUid")&&t.uint32(32).int64(e.toUid),null!=e.type&&e.hasOwnProperty("type")&&t.uint32(42).string(e.type),null!=e.content&&e.hasOwnProperty("content")&&t.uint32(50).bytes(e.content),null!=e.option&&e.hasOwnProperty("option")&&c.proto.SignalMessageOption.encode(e.option,t.uint32(58).fork()).ldelim(),null!=e.uuid&&e.hasOwnProperty("uuid")&&t.uint32(66).string(e.uuid),null!=e.extension&&e.hasOwnProperty("extension")&&t.uint32(74).string(e.extension),null!=e.extensions&&e.hasOwnProperty("extensions"))for(var n=Object.keys(e.extensions),i=0;i<n.length;++i)t.uint32(82).fork().uint32(10).string(n[i]).uint32(18).string(e.extensions[n[i]]).ldelim();if(null!=e.internalExtensions&&e.hasOwnProperty("internalExtensions"))for(n=Object.keys(e.internalExtensions),i=0;i<n.length;++i)t.uint32(90).fork().uint32(10).string(n[i]).uint32(18).string(e.internalExtensions[n[i]]).ldelim();return t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n,i=void 0===t?e.len:e.pos+t,r=new c.proto.P2PSignalRequest;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.logId=e.int64();break;case 2:r.appId=e.int64();break;case 3:r.fromUid=e.int64();break;case 4:r.toUid=e.int64();break;case 5:r.type=e.string();break;case 6:r.content=e.bytes();break;case 7:r.option=c.proto.SignalMessageOption.decode(e,e.uint32());break;case 8:r.uuid=e.string();break;case 9:r.extension=e.string();break;case 10:e.skip().pos++,r.extensions===l.emptyObject&&(r.extensions={}),n=e.string(),e.pos++,r.extensions[n]=e.string();break;case 11:e.skip().pos++,r.internalExtensions===l.emptyObject&&(r.internalExtensions={}),n=e.string(),e.pos++,r.internalExtensions[n]=e.string();break;default:e.skipType(7&o)}}return r},e}(),o.P2PSignalResponse=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.code=0,e.prototype.msg="",e.prototype.timestamp=l.Long?l.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(8).int32(e.code),null!=e.msg&&e.hasOwnProperty("msg")&&t.uint32(18).string(e.msg),null!=e.timestamp&&e.hasOwnProperty("timestamp")&&t.uint32(24).int64(e.timestamp),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.P2PSignalResponse;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.code=e.int32();break;case 2:i.msg=e.string();break;case 3:i.timestamp=e.int64();break;default:e.skipType(7&r)}}return i},e}(),o.SignalMessage=function(){function e(e){if(this.extensions={},this.internalExtensions={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.appId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.fromUid=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.type="",e.prototype.content=l.newBuffer([]),e.prototype.uuid="",e.prototype.extension="",e.prototype.extensions=l.emptyObject,e.prototype.internalExtensions=l.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.appId&&e.hasOwnProperty("appId")&&t.uint32(16).int64(e.appId),null!=e.fromUid&&e.hasOwnProperty("fromUid")&&t.uint32(24).int64(e.fromUid),null!=e.type&&e.hasOwnProperty("type")&&t.uint32(34).string(e.type),null!=e.content&&e.hasOwnProperty("content")&&t.uint32(42).bytes(e.content),null!=e.uuid&&e.hasOwnProperty("uuid")&&t.uint32(50).string(e.uuid),null!=e.extension&&e.hasOwnProperty("extension")&&t.uint32(58).string(e.extension),null!=e.extensions&&e.hasOwnProperty("extensions"))for(var n=Object.keys(e.extensions),i=0;i<n.length;++i)t.uint32(66).fork().uint32(10).string(n[i]).uint32(18).string(e.extensions[n[i]]).ldelim();if(null!=e.internalExtensions&&e.hasOwnProperty("internalExtensions"))for(n=Object.keys(e.internalExtensions),i=0;i<n.length;++i)t.uint32(74).fork().uint32(10).string(n[i]).uint32(18).string(e.internalExtensions[n[i]]).ldelim();return t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n,i=void 0===t?e.len:e.pos+t,r=new c.proto.SignalMessage;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.logId=e.int64();break;case 2:r.appId=e.int64();break;case 3:r.fromUid=e.int64();break;case 4:r.type=e.string();break;case 5:r.content=e.bytes();break;case 6:r.uuid=e.string();break;case 7:r.extension=e.string();break;case 8:e.skip().pos++,r.extensions===l.emptyObject&&(r.extensions={}),n=e.string(),e.pos++,r.extensions[n]=e.string();break;case 9:e.skip().pos++,r.internalExtensions===l.emptyObject&&(r.internalExtensions={}),n=e.string(),e.pos++,r.internalExtensions[n]=e.string();break;default:e.skipType(7&o)}}return r},e}(),o.GroupSignalRequest=function(){function e(e){if(this.extensions={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.appId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.fromUid=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.groupId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.topic="",e.prototype.type="",e.prototype.content=l.newBuffer([]),e.prototype.option=null,e.prototype.uuid="",e.prototype.extension="",e.prototype.extensions=l.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.appId&&e.hasOwnProperty("appId")&&t.uint32(16).int64(e.appId),null!=e.fromUid&&e.hasOwnProperty("fromUid")&&t.uint32(24).int64(e.fromUid),null!=e.groupId&&e.hasOwnProperty("groupId")&&t.uint32(32).int64(e.groupId),null!=e.topic&&e.hasOwnProperty("topic")&&t.uint32(42).string(e.topic),null!=e.type&&e.hasOwnProperty("type")&&t.uint32(50).string(e.type),null!=e.content&&e.hasOwnProperty("content")&&t.uint32(58).bytes(e.content),null!=e.option&&e.hasOwnProperty("option")&&c.proto.SignalMessageOption.encode(e.option,t.uint32(66).fork()).ldelim(),null!=e.uuid&&e.hasOwnProperty("uuid")&&t.uint32(74).string(e.uuid),null!=e.extension&&e.hasOwnProperty("extension")&&t.uint32(82).string(e.extension),null!=e.extensions&&e.hasOwnProperty("extensions"))for(var n=Object.keys(e.extensions),i=0;i<n.length;++i)t.uint32(90).fork().uint32(10).string(n[i]).uint32(18).string(e.extensions[n[i]]).ldelim();return t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n,i=void 0===t?e.len:e.pos+t,r=new c.proto.GroupSignalRequest;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.logId=e.int64();break;case 2:r.appId=e.int64();break;case 3:r.fromUid=e.int64();break;case 4:r.groupId=e.int64();break;case 5:r.topic=e.string();break;case 6:r.type=e.string();break;case 7:r.content=e.bytes();break;case 8:r.option=c.proto.SignalMessageOption.decode(e,e.uint32());break;case 9:r.uuid=e.string();break;case 10:r.extension=e.string();break;case 11:e.skip().pos++,r.extensions===l.emptyObject&&(r.extensions={}),n=e.string(),e.pos++,r.extensions[n]=e.string();break;default:e.skipType(7&o)}}return r},e}(),o.GroupSignalResponse=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.code=0,e.prototype.msg="",e.prototype.timestamp=l.Long?l.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(8).int32(e.code),null!=e.msg&&e.hasOwnProperty("msg")&&t.uint32(18).string(e.msg),null!=e.timestamp&&e.hasOwnProperty("timestamp")&&t.uint32(24).int64(e.timestamp),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.GroupSignalResponse;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.code=e.int32();break;case 2:i.msg=e.string();break;case 3:i.timestamp=e.int64();break;default:e.skipType(7&r)}}return i},e}(),o.CheckUserIsOnlineRequest=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.appId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.selfUid=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.uid=l.Long?l.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.appId&&e.hasOwnProperty("appId")&&t.uint32(16).int64(e.appId),null!=e.selfUid&&e.hasOwnProperty("selfUid")&&t.uint32(24).int64(e.selfUid),null!=e.uid&&e.hasOwnProperty("uid")&&t.uint32(32).int64(e.uid),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.CheckUserIsOnlineRequest;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.appId=e.int64();break;case 3:i.selfUid=e.int64();break;case 4:i.uid=e.int64();break;default:e.skipType(7&r)}}return i},e}(),o.CheckUserIsOnlineResponse=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.code=0,e.prototype.msg="",e.prototype.isOnline=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(8).int32(e.code),null!=e.msg&&e.hasOwnProperty("msg")&&t.uint32(18).string(e.msg),null!=e.isOnline&&e.hasOwnProperty("isOnline")&&t.uint32(24).bool(e.isOnline),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.CheckUserIsOnlineResponse;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.code=e.int32();break;case 2:i.msg=e.string();break;case 3:i.isOnline=e.bool();break;default:e.skipType(7&r)}}return i},e}(),o.BatchCheckUserIsOnlineRequest=function(){function e(e){if(this.uids=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.appId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.selfUid=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.uids=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.appId&&e.hasOwnProperty("appId")&&t.uint32(16).int64(e.appId),null!=e.selfUid&&e.hasOwnProperty("selfUid")&&t.uint32(24).int64(e.selfUid),null!=e.uids&&e.uids.length){t.uint32(34).fork();for(var n=0;n<e.uids.length;++n)t.int64(e.uids[n]);t.ldelim()}return t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.BatchCheckUserIsOnlineRequest;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.appId=e.int64();break;case 3:i.selfUid=e.int64();break;case 4:if(i.uids&&i.uids.length||(i.uids=[]),2==(7&r))for(var o=e.uint32()+e.pos;e.pos<o;)i.uids.push(e.int64());else i.uids.push(e.int64());break;default:e.skipType(7&r)}}return i},e}(),o.BatchCheckUserIsOnlineResponse=function(){function e(e){if(this.onlineUids=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.code=0,e.prototype.msg="",e.prototype.onlineUids=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(8).int32(e.code),null!=e.msg&&e.hasOwnProperty("msg")&&t.uint32(18).string(e.msg),null!=e.onlineUids&&e.onlineUids.length){t.uint32(26).fork();for(var n=0;n<e.onlineUids.length;++n)t.int64(e.onlineUids[n]);t.ldelim()}return t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.BatchCheckUserIsOnlineResponse;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.code=e.int32();break;case 2:i.msg=e.string();break;case 3:if(i.onlineUids&&i.onlineUids.length||(i.onlineUids=[]),2==(7&r))for(var o=e.uint32()+e.pos;e.pos<o;)i.onlineUids.push(e.int64());else i.onlineUids.push(e.int64());break;default:e.skipType(7&r)}}return i},e}(),o.UnreliableMsg=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.action=0,e.prototype.content=l.newBuffer([]),e.prototype.timestamp=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.uri="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.action&&e.hasOwnProperty("action")&&t.uint32(8).int32(e.action),null!=e.content&&e.hasOwnProperty("content")&&t.uint32(18).bytes(e.content),null!=e.timestamp&&e.hasOwnProperty("timestamp")&&t.uint32(24).int64(e.timestamp),null!=e.uri&&e.hasOwnProperty("uri")&&t.uint32(34).string(e.uri),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.UnreliableMsg;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.action=e.int32();break;case 2:i.content=e.bytes();break;case 3:i.timestamp=e.int64();break;case 4:i.uri=e.string();break;default:e.skipType(7&r)}}return i},e}(),o.UnreliableIMPushMsgRequest=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.region="",e.prototype.envType="",e.prototype.envName="",e.prototype.msg=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.region&&e.hasOwnProperty("region")&&t.uint32(18).string(e.region),null!=e.envType&&e.hasOwnProperty("envType")&&t.uint32(26).string(e.envType),null!=e.envName&&e.hasOwnProperty("envName")&&t.uint32(34).string(e.envName),null!=e.msg&&e.hasOwnProperty("msg")&&c.proto.UnreliableMsg.encode(e.msg,t.uint32(42).fork()).ldelim(),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.UnreliableIMPushMsgRequest;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.region=e.string();break;case 3:i.envType=e.string();break;case 4:i.envName=e.string();break;case 5:i.msg=c.proto.UnreliableMsg.decode(e,e.uint32());break;default:e.skipType(7&r)}}return i},e}(),o.UnreliableIMPushMsgResponse=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.code=0,e.prototype.msg="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(16).int32(e.code),null!=e.msg&&e.hasOwnProperty("msg")&&t.uint32(26).string(e.msg),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.UnreliableIMPushMsgResponse;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.code=e.int32();break;case 3:i.msg=e.string();break;default:e.skipType(7&r)}}return i},e}(),o.UnreliableIMPushGroupSysMsgRequest=function(){function e(e){if(this.targetUserTags=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.groupId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.topic="",e.prototype.region="",e.prototype.envType="",e.prototype.envName="",e.prototype.msg=null,e.prototype.targetUserTags=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.groupId&&e.hasOwnProperty("groupId")&&t.uint32(16).int64(e.groupId),null!=e.topic&&e.hasOwnProperty("topic")&&t.uint32(26).string(e.topic),null!=e.region&&e.hasOwnProperty("region")&&t.uint32(34).string(e.region),null!=e.envType&&e.hasOwnProperty("envType")&&t.uint32(42).string(e.envType),null!=e.envName&&e.hasOwnProperty("envName")&&t.uint32(50).string(e.envName),null!=e.msg&&e.hasOwnProperty("msg")&&c.proto.UnreliableMsg.encode(e.msg,t.uint32(58).fork()).ldelim(),null!=e.targetUserTags&&e.targetUserTags.length)for(var n=0;n<e.targetUserTags.length;++n)t.uint32(66).string(e.targetUserTags[n]);return t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.UnreliableIMPushGroupSysMsgRequest;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.groupId=e.int64();break;case 3:i.topic=e.string();break;case 4:i.region=e.string();break;case 5:i.envType=e.string();break;case 6:i.envName=e.string();break;case 7:i.msg=c.proto.UnreliableMsg.decode(e,e.uint32());break;case 8:i.targetUserTags&&i.targetUserTags.length||(i.targetUserTags=[]),i.targetUserTags.push(e.string());break;default:e.skipType(7&r)}}return i},e}(),o.UnreliableIMPushGroupSysMsgResponse=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.code=0,e.prototype.msg="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(16).int32(e.code),null!=e.msg&&e.hasOwnProperty("msg")&&t.uint32(26).string(e.msg),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.UnreliableIMPushGroupSysMsgResponse;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.code=e.int32();break;case 3:i.msg=e.string();break;default:e.skipType(7&r)}}return i},e}(),o.NotifyUinfoChange=function(){function e(e){if(this.infos={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.appId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.opType=0,e.prototype.uid=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.groupId="",e.prototype.timestamp=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.infos=l.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.appId&&e.hasOwnProperty("appId")&&t.uint32(16).int64(e.appId),null!=e.opType&&e.hasOwnProperty("opType")&&t.uint32(24).int32(e.opType),null!=e.uid&&e.hasOwnProperty("uid")&&t.uint32(32).int64(e.uid),null!=e.groupId&&e.hasOwnProperty("groupId")&&t.uint32(42).string(e.groupId),null!=e.timestamp&&e.hasOwnProperty("timestamp")&&t.uint32(48).int64(e.timestamp),null!=e.infos&&e.hasOwnProperty("infos"))for(var n=Object.keys(e.infos),i=0;i<n.length;++i)t.uint32(58).fork().uint32(10).string(n[i]).uint32(18).string(e.infos[n[i]]).ldelim();return t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n,i=void 0===t?e.len:e.pos+t,r=new c.proto.NotifyUinfoChange;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.logId=e.int64();break;case 2:r.appId=e.int64();break;case 3:r.opType=e.int32();break;case 4:r.uid=e.int64();break;case 5:r.groupId=e.string();break;case 6:r.timestamp=e.int64();break;case 7:e.skip().pos++,r.infos===l.emptyObject&&(r.infos={}),n=e.string(),e.pos++,r.infos[n]=e.string();break;default:e.skipType(7&o)}}return r},e.OpType=function(){var e={},t=Object.create(e);return t[e[0]="kOpUpdate"]=0,t[e[1]="kOpDel"]=1,t[e[2]="kOpSet"]=2,t[e[3]="kOpClear"]=3,t}(),e}(),o.NotifyChannelPropsChange=function(){function e(e){if(this.props={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.appId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.opType=0,e.prototype.uid=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.groupId="",e.prototype.timestamp=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.props=l.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.appId&&e.hasOwnProperty("appId")&&t.uint32(16).int64(e.appId),null!=e.opType&&e.hasOwnProperty("opType")&&t.uint32(24).int32(e.opType),null!=e.uid&&e.hasOwnProperty("uid")&&t.uint32(32).int64(e.uid),null!=e.groupId&&e.hasOwnProperty("groupId")&&t.uint32(42).string(e.groupId),null!=e.timestamp&&e.hasOwnProperty("timestamp")&&t.uint32(48).int64(e.timestamp),null!=e.props&&e.hasOwnProperty("props"))for(var n=Object.keys(e.props),i=0;i<n.length;++i)t.uint32(58).fork().uint32(10).string(n[i]).uint32(18).string(e.props[n[i]]).ldelim();return t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n,i=void 0===t?e.len:e.pos+t,r=new c.proto.NotifyChannelPropsChange;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.logId=e.int64();break;case 2:r.appId=e.int64();break;case 3:r.opType=e.int32();break;case 4:r.uid=e.int64();break;case 5:r.groupId=e.string();break;case 6:r.timestamp=e.int64();break;case 7:e.skip().pos++,r.props===l.emptyObject&&(r.props={}),n=e.string(),e.pos++,r.props[n]=e.string();break;default:e.skipType(7&o)}}return r},e.OpType=function(){var e={},t=Object.create(e);return t[e[0]="kOpUpdate"]=0,t[e[1]="kOpDel"]=1,t[e[2]="kOpSet"]=2,t[e[3]="kOpClear"]=3,t}(),e}(),o.NotifyChannelUserCountChange=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.appId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.groupId="",e.prototype.count=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.appId&&e.hasOwnProperty("appId")&&t.uint32(16).int64(e.appId),null!=e.groupId&&e.hasOwnProperty("groupId")&&t.uint32(26).string(e.groupId),null!=e.count&&e.hasOwnProperty("count")&&t.uint32(32).uint32(e.count),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.NotifyChannelUserCountChange;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.appId=e.int64();break;case 3:i.groupId=e.string();break;case 4:i.count=e.uint32();break;default:e.skipType(7&r)}}return i},e}(),o.SetUserRegionRequest=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.appId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.selfUid=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.region="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.appId&&e.hasOwnProperty("appId")&&t.uint32(16).int64(e.appId),null!=e.selfUid&&e.hasOwnProperty("selfUid")&&t.uint32(24).int64(e.selfUid),null!=e.region&&e.hasOwnProperty("region")&&t.uint32(34).string(e.region),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.SetUserRegionRequest;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.appId=e.int64();break;case 3:i.selfUid=e.int64();break;case 4:i.region=e.string();break;default:e.skipType(7&r)}}return i},e}(),o.SetUserRegionResponse=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.code=0,e.prototype.msg="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(16).int32(e.code),null!=e.msg&&e.hasOwnProperty("msg")&&t.uint32(26).string(e.msg),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.SetUserRegionResponse;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.code=e.int32();break;case 3:i.msg=e.string();break;default:e.skipType(7&r)}}return i},e}(),o.GetQueueConfigRequest=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.appId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.region="",e.prototype.selfUid=l.Long?l.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.appId&&e.hasOwnProperty("appId")&&t.uint32(16).int64(e.appId),null!=e.region&&e.hasOwnProperty("region")&&t.uint32(26).string(e.region),null!=e.selfUid&&e.hasOwnProperty("selfUid")&&t.uint32(32).int64(e.selfUid),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.GetQueueConfigRequest;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.appId=e.int64();break;case 3:i.region=e.string();break;case 4:i.selfUid=e.int64();break;default:e.skipType(7&r)}}return i},e}(),o.GetQueueConfigResponse=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.code=0,e.prototype.msg="",e.prototype.queueCount=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(16).int32(e.code),null!=e.msg&&e.hasOwnProperty("msg")&&t.uint32(26).string(e.msg),null!=e.queueCount&&e.hasOwnProperty("queueCount")&&t.uint32(32).int32(e.queueCount),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.proto.GetQueueConfigResponse;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.code=e.int32();break;case 3:i.msg=e.string();break;case 4:i.queueCount=e.int32();break;default:e.skipType(7&r)}}return i},e}(),o),e.exports=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(46),r=n(5),o=n(4),s=n(108),a=n(109),u=n(110),l=n(111),c=n(112),d=n(113),h=n(114),p=n(115),f=n(116),g=n(117),m=n(118),y=n(29),b=n(119),v=n(120),I=n(121),S=n(122),w=n(123),_=n(124),O=n(125),U=n(126),k=n(127),T=n(128),R=n(129),E=n(130);i.util.Long=o,i.configure();const x=new r.Logger("RtsProtocol");t.default=class{static decodeRouteRes(e){x.debug("decodeRouteRes:",e);try{if("cim.proto.ProxyService.GetQueueConfig"==e.fnName)return y.proto.GetQueueConfigResponse.decode(new Uint8Array(e.data));if("cim.proto.ProxyService.GetMaxSeqId"==e.fnName)return y.proto.GetMaxSeqIdResponse.decode(new Uint8Array(e.data));if("cim.proto.ProxyService.PullMsg"==e.fnName)return y.proto.PullMsgResponse.decode(new Uint8Array(e.data));if("cim.proto.ProxyService.P2PSignal"==e.fnName)return y.proto.P2PSignalResponse.decode(new Uint8Array(e.data));if("cim.proto.ProxyService.GroupSignal"==e.fnName)return y.proto.GroupSignalResponse.decode(new Uint8Array(e.data));if("cim.proto.ProxyService.CheckUserIsOnline"==e.fnName)return y.proto.CheckUserIsOnlineResponse.decode(new Uint8Array(e.data));if("cim.proto.ProxyService.BatchCheckUserIsOnline"==e.fnName)return y.proto.BatchCheckUserIsOnlineResponse.decode(new Uint8Array(e.data));if("cim.proto.ProxyService.GetGrpSysMaxSeqId"==e.fnName)return y.proto.GetGrpSysMaxSeqIdResponse.decode(new Uint8Array(e.data));if("cim.proto.ProxyService.PullGroupSysMsg"==e.fnName)return y.proto.PullGroupSysMsgResponse.decode(new Uint8Array(e.data));if("JoinChannelService"==e.fnName){let t=new s.default;return t.unmarshall(e.data),t}if("LeaveChannelService"==e.fnName){let t=new a.default;return t.unmarshall(e.data),t}if("SetUserInfo"==e.fnName){let t=new h.default;return t.unmarshall(e.data),t}if("DeleteUserInfo"==e.fnName){let t=new p.default;return t.unmarshall(e.data),t}if("DeleteAllUserInfo"==e.fnName){let t=new I.default;return t.unmarshall(e.data),t}if("AddOrUpdateUserInfo"==e.fnName){let t=new S.default;return t.unmarshall(e.data),t}if("GetUserInfo"==e.fnName){let t=new R.default;return t.unmarshall(e.data),t}if("GetUserInfoByKey"==e.fnName){let t=new E.default;return t.unmarshall(e.data),t}if("GetUserList"==e.fnName){let t=new f.default;return t.unmarshall(e.data),t}if("SetChannelProps"==e.fnName){let t=new w.default;return t.unmarshall(e.data),t}if("AddOrUpdateChannelProps"==e.fnName){let t=new _.default;return t.unmarshall(e.data),t}if("DeleteChannelProps"==e.fnName){let t=new O.default;return t.unmarshall(e.data),t}if("DeleteAllChannelProps"==e.fnName){let t=new U.default;return t.unmarshall(e.data),t}if("GetChannelProps"==e.fnName){let t=new T.default;return t.unmarshall(e.data),t}if("GetAllChannelProps"==e.fnName){let t=new k.default;return t.unmarshall(e.data),t}if("SendBroadcast"==e.fnName){let t=new g.default;return t.unmarshall(e.data),t}if("SendUnicast"==e.fnName){let t=new m.default;return t.unmarshall(e.data),t}if("BatchGetChannelUserCount"==e.fnName){let t=new b.default;return t.unmarshall(e.data),t}if("OnlineUserHeartBeat"==e.fnName){let t=new v.default;return t.unmarshall(e.data),t}x.info("decodeRouteRes: unexpected msg: "+e)}catch(e){x.warn("decodeRouteRes: failed to decode msg:"+e)}return null}static decodeUnicastRes(e){x.debug("decodeUnicastRes:",e);try{if("cim.proto.PushService.IMPushMsg"==e.fnName)return y.proto.IMPushMsgRequest.decode(new Uint8Array(e.data));if("cim.proto.PushService.UnreliableIMPushMsg"==e.fnName)return y.proto.UnreliableIMPushMsgRequest.decode(new Uint8Array(e.data));if("SendUnicastUc"==e.fnName){let t=new l.default;return t.unmarshall(e.data),t}x.info("decodeUnicastRes: unexpected msg: "+e)}catch(e){x.warn("decodeUnicastRes: failed to decode msg:"+e)}return null}static decodeBroadcastRes(e){x.debug("decodeBroadcastRes:",e);try{if("cim.proto.PushService.IMPushGroupSysMsg"==e.fnName)return y.proto.IMPushGroupSysMsgRequest.decode(new Uint8Array(e.data));if("cim.proto.PushService.UnreliableIMPushGroupSysMsg"==e.fnName)return y.proto.UnreliableIMPushGroupSysMsgRequest.decode(new Uint8Array(e.data));if("SendBroadcastBc"==e.fnName){let t=new u.default;return t.unmarshall(e.data),t}if("UserStateChangeBc"==e.fnName){let t=new c.default;return t.unmarshall(e.data),t}if("UserInfoChangeBc"==e.fnName){let t=new d.default;return t.unmarshall(e.data),t}x.log("decodeBroadcastRes: unexpected msg: "+e)}catch(e){x.warn("decodeBroadcastRes: failed to decode msg:"+e)}return null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(4);t.default=class{constructor(e=0,t=0){this.high=e,this.low=t}destroy(){}equal(e){return null!==e&&(this.low===e.low&&this.high===e.high)}toString(){return new i(this.low,this.high,!0).toString(10)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION="3.2.1",t.sdkVersion=1594994263},function(e,t,n){"use strict";var i=t;i.length=function(e){for(var t=0,n=0,i=0;i<e.length;++i)(n=e.charCodeAt(i))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(i+1))?(++i,t+=4):t+=3;return t},i.read=function(e,t,n){if(n-t<1)return"";for(var i,r=null,o=[],s=0;t<n;)(i=e[t++])<128?o[s++]=i:i>191&&i<224?o[s++]=(31&i)<<6|63&e[t++]:i>239&&i<365?(i=((7&i)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[s++]=55296+(i>>10),o[s++]=56320+(1023&i)):o[s++]=(15&i)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((r||(r=[])).push(String.fromCharCode.apply(String,o)),s=0);return r?(s&&r.push(String.fromCharCode.apply(String,o.slice(0,s))),r.join("")):String.fromCharCode.apply(String,o.slice(0,s))},i.write=function(e,t,n){for(var i,r,o=n,s=0;s<e.length;++s)(i=e.charCodeAt(s))<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&56320==(64512&(r=e.charCodeAt(s+1)))?(i=65536+((1023&i)<<10)+(1023&r),++s,t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128);return n-o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),r=n(7);t.default=class{static encodeUCS2(e){let t=[],n=e.length;for(let i=0;i<n;i++)t.push(e.charCodeAt(i));let i=Uint16Array.from(t);return new Uint8Array(i.buffer)}static decodeUCS2(e){let t=i.default.payload2DataView(e);e=null;let n=0,r=[];for(;n+2<=t.byteLength;)r.push(t.getUint16(n,!0)),n+=2;let o=r.length,s="";for(let e=0;e<o;e++)s+=String.fromCharCode(r[e]);return s}static encodeUtf8(e){return r.Utify.encodeStringToUtf8Bytes(e)}static decodeUtf8(e){let t="",n=e.byteLength;for(let i=0;i<n;i++){let n=e[i].toString(2),r=n.match(/^1+?(?=0)/);if(r&&8==n.length){let n=r[0].length,o=e[i].toString(2).slice(n+1);for(let t=1;t<n;t++)o+=e[t+i].toString(2).slice(2);t+=String.fromCodePoint(parseInt(o,2)),i+=n-1}else t+=String.fromCharCode(e[i])}return t}static sizeof(e){for(var t=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);if(i>=55296&&i<=56319&&n+1<e.length){var r=e.charCodeAt(n+1);if(r>=56320&&r<=57343){++n,t+=4;continue}}t+=i<=127?1:i<=2047?2:3}return t}}},function(e,t,n){"use strict";function i(e){return null!==e&&"object"==typeof e}Object.defineProperty(t,"__esModule",{value:!0}),t.looseEqual=function e(t,n){if(t===n)return!0;var r=i(t),o=i(n);if(!r||!o)return!r&&!o&&String(t)===String(n);try{var s=Array.isArray(t),a=Array.isArray(n);if(s&&a)return t.length===n.length&&t.every((function(t,i){return e(t,n[i])}));if(t instanceof Date&&n instanceof Date)return t.getTime()===n.getTime();if(s||a)return!1;var u=Object.keys(t),l=Object.keys(n);return u.length===l.length&&u.every((function(i){return e(t[i],n[i])}))}catch(e){return!1}}},function(e,t,n){var i=n(85),r=n(86),o=r;o.v1=i,o.v4=r,e.exports=o},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var i=new Uint8Array(16);e.exports=function(){return n(i),i}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}},function(e,t){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);e.exports=function(e,t){var i=t||0,r=n;return[r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]]].join("")}},function(e,t,n){"use strict";var i,r=n(40),o=r.Reader,s=r.Writer,a=r.util,u=r.roots.default||(r.roots.default={});u.hummerProto=((i={}).SetUserRegionRequest=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=a.Long?a.Long.fromBits(0,0,!1):0,e.prototype.appId=a.Long?a.Long.fromBits(0,0,!1):0,e.prototype.selfUid=a.Long?a.Long.fromBits(0,0,!1):0,e.prototype.region="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.appId&&e.hasOwnProperty("appId")&&t.uint32(16).int64(e.appId),null!=e.selfUid&&e.hasOwnProperty("selfUid")&&t.uint32(24).int64(e.selfUid),null!=e.region&&e.hasOwnProperty("region")&&t.uint32(34).string(e.region),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new u.hummerProto.SetUserRegionRequest;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.appId=e.int64();break;case 3:i.selfUid=e.int64();break;case 4:i.region=e.string();break;default:e.skipType(7&r)}}return i},e}(),i.SetUserRegionResponse=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logId=a.Long?a.Long.fromBits(0,0,!1):0,e.prototype.code=0,e.prototype.msg="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.logId&&e.hasOwnProperty("logId")&&t.uint32(8).int64(e.logId),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(16).int32(e.code),null!=e.msg&&e.hasOwnProperty("msg")&&t.uint32(26).string(e.msg),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new u.hummerProto.SetUserRegionResponse;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.logId=e.int64();break;case 2:i.code=e.int32();break;case 3:i.msg=e.string();break;default:e.skipType(7&r)}}return i},e}(),i),e.exports=u},function(e,t,n){"use strict";e.exports=n(41)},function(e,t,n){"use strict";var i=t;function r(){i.util._configure(),i.Writer._configure(i.BufferWriter),i.Reader._configure(i.BufferReader)}i.build="minimal",i.Writer=n(19),i.BufferWriter=n(92),i.Reader=n(20),i.BufferReader=n(93),i.util=n(8),i.rpc=n(44),i.roots=n(45),i.configure=r,r()},function(e,t,n){"use strict";e.exports=function(e,t){var n=new Array(arguments.length-1),i=0,r=2,o=!0;for(;r<arguments.length;)n[i++]=arguments[r++];return new Promise((function(r,s){n[i]=function(e){if(o)if(o=!1,e)s(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];r.apply(null,t)}};try{e.apply(t||null,n)}catch(e){o&&(o=!1,s(e))}}))}},function(module,exports,__webpack_require__){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},function(e,t,n){"use strict";t.Service=n(94)},function(e,t,n){"use strict";e.exports={}},function(e,t,n){"use strict";e.exports=n(96)},function(e,t,n){"use strict";e.exports=function(e){for(var t,n=o.codegen(["m","w"],e.name+"$encode")("if(!w)")("w=Writer.create()"),a=e.fieldsArray.slice().sort(o.compareFieldsById),u=0;u<a.length;++u){var l=a[u].resolve(),c=e._fieldsArray.indexOf(l),d=l.resolvedType instanceof i?"int32":l.type,h=r.basic[d];t="m"+o.safeProp(l.name),l.map?(n("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",t,l.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",t)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(l.id<<3|2)>>>0,8|r.mapKey[l.keyType],l.keyType),void 0===h?n("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",c,t):n(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|h,d,t),n("}")("}")):l.repeated?(n("if(%s!=null&&%s.length){",t,t),l.packed&&void 0!==r.packed[d]?n("w.uint32(%i).fork()",(l.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",t)("w.%s(%s[i])",d,t)("w.ldelim()"):(n("for(var i=0;i<%s.length;++i)",t),void 0===h?s(n,l,c,t+"[i]"):n("w.uint32(%i).%s(%s[i])",(l.id<<3|h)>>>0,d,t)),n("}")):(l.optional&&n("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",t,l.name),void 0===h?s(n,l,c,t):n("w.uint32(%i).%s(%s)",(l.id<<3|h)>>>0,d,t))}return n("return w")};var i=n(6),r=n(12),o=n(3);function s(e,t,n,i){return t.resolvedType.group?e("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",n,i,(t.id<<3|3)>>>0,(t.id<<3|4)>>>0):e("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",n,i,(t.id<<3|2)>>>0)}},function(e,t,n){"use strict";e.exports=function(e){var t=o.codegen(["r","l"],e.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(e.fieldsArray.filter((function(e){return e.map})).length?",k":""))("while(r.pos<c){")("var t=r.uint32()");e.group&&t("if((t&7)===4)")("break");t("switch(t>>>3){");for(var n=0;n<e.fieldsArray.length;++n){var a=e._fieldsArray[n].resolve(),u=a.resolvedType instanceof i?"int32":a.type,l="m"+o.safeProp(a.name);t("case %i:",a.id),a.map?(t("r.skip().pos++")("if(%s===util.emptyObject)",l)("%s={}",l)("k=r.%s()",a.keyType)("r.pos++"),void 0!==r.long[a.keyType]?void 0===r.basic[u]?t('%s[typeof k==="object"?util.longToHash(k):k]=types[%i].decode(r,r.uint32())',l,n):t('%s[typeof k==="object"?util.longToHash(k):k]=r.%s()',l,u):void 0===r.basic[u]?t("%s[k]=types[%i].decode(r,r.uint32())",l,n):t("%s[k]=r.%s()",l,u)):a.repeated?(t("if(!(%s&&%s.length))",l,l)("%s=[]",l),void 0!==r.packed[u]&&t("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",l,u)("}else"),void 0===r.basic[u]?t(a.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",l,n):t("%s.push(r.%s())",l,u)):void 0===r.basic[u]?t(a.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",l,n):t("%s=r.%s()",l,u),t("break")}for(t("default:")("r.skipType(t&7)")("break")("}")("}"),n=0;n<e._fieldsArray.length;++n){var c=e._fieldsArray[n];c.required&&t("if(!m.hasOwnProperty(%j))",c.name)("throw util.ProtocolError(%j,{instance:m})",s(c))}return t("return m")};var i=n(6),r=n(12),o=n(3);function s(e){return"missing required '"+e.name+"'"}},function(e,t,n){"use strict";e.exports=function(e){var t=r.codegen(["m"],e.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),n=e.oneofsArray,i={};n.length&&t("var p={}");for(var u=0;u<e.fieldsArray.length;++u){var l=e._fieldsArray[u].resolve(),c="m"+r.safeProp(l.name);if(l.optional&&t("if(%s!=null&&m.hasOwnProperty(%j)){",c,l.name),l.map)t("if(!util.isObject(%s))",c)("return%j",o(l,"object"))("var k=Object.keys(%s)",c)("for(var i=0;i<k.length;++i){"),a(t,l,"k[i]"),s(t,l,u,c+"[k[i]]")("}");else if(l.repeated)t("if(!Array.isArray(%s))",c)("return%j",o(l,"array"))("for(var i=0;i<%s.length;++i){",c),s(t,l,u,c+"[i]")("}");else{if(l.partOf){var d=r.safeProp(l.partOf.name);1===i[l.partOf.name]&&t("if(p%s===1)",d)("return%j",l.partOf.name+": multiple values"),i[l.partOf.name]=1,t("p%s=1",d)}s(t,l,u,c)}l.optional&&t("}")}return t("return null")};var i=n(6),r=n(3);function o(e,t){return e.name+": "+t+(e.repeated&&"array"!==t?"[]":e.map&&"object"!==t?"{k:"+e.keyType+"}":"")+" expected"}function s(e,t,n,r){if(t.resolvedType)if(t.resolvedType instanceof i){e("switch(%s){",r)("default:")("return%j",o(t,"enum value"));for(var s=Object.keys(t.resolvedType.values),a=0;a<s.length;++a)e("case %i:",t.resolvedType.values[s[a]]);e("break")("}")}else e("{")("var e=types[%i].verify(%s);",n,r)("if(e)")("return%j+e",t.name+".")("}");else switch(t.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.isInteger(%s))",r)("return%j",o(t,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",r,r,r,r)("return%j",o(t,"integer|Long"));break;case"float":case"double":e('if(typeof %s!=="number")',r)("return%j",o(t,"number"));break;case"bool":e('if(typeof %s!=="boolean")',r)("return%j",o(t,"boolean"));break;case"string":e("if(!util.isString(%s))",r)("return%j",o(t,"string"));break;case"bytes":e('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',r,r,r)("return%j",o(t,"buffer"))}return e}function a(e,t,n){switch(t.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.key32Re.test(%s))",n)("return%j",o(t,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.key64Re.test(%s))",n)("return%j",o(t,"integer|Long key"));break;case"bool":e("if(!util.key2Re.test(%s))",n)("return%j",o(t,"boolean key"))}return e}},function(e,t,n){"use strict";var i=t,r=n(6),o=n(3);function s(e,t,n,i){if(t.resolvedType)if(t.resolvedType instanceof r){e("switch(d%s){",i);for(var o=t.resolvedType.values,s=Object.keys(o),a=0;a<s.length;++a)t.repeated&&o[s[a]]===t.typeDefault&&e("default:"),e("case%j:",s[a])("case %i:",o[s[a]])("m%s=%j",i,o[s[a]])("break");e("}")}else e('if(typeof d%s!=="object")',i)("throw TypeError(%j)",t.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",i,n,i);else{var u=!1;switch(t.type){case"double":case"float":e("m%s=Number(d%s)",i,i);break;case"uint32":case"fixed32":e("m%s=d%s>>>0",i,i);break;case"int32":case"sint32":case"sfixed32":e("m%s=d%s|0",i,i);break;case"uint64":u=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",i,i,u)('else if(typeof d%s==="string")',i)("m%s=parseInt(d%s,10)",i,i)('else if(typeof d%s==="number")',i)("m%s=d%s",i,i)('else if(typeof d%s==="object")',i)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",i,i,i,u?"true":"");break;case"bytes":e('if(typeof d%s==="string")',i)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",i,i,i)("else if(d%s.length)",i)("m%s=d%s",i,i);break;case"string":e("m%s=String(d%s)",i,i);break;case"bool":e("m%s=Boolean(d%s)",i,i)}}return e}function a(e,t,n,i){if(t.resolvedType)t.resolvedType instanceof r?e("d%s=o.enums===String?types[%i].values[m%s]:m%s",i,n,i,i):e("d%s=types[%i].toObject(m%s,o)",i,n,i);else{var o=!1;switch(t.type){case"double":case"float":e("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",i,i,i,i);break;case"uint64":o=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e('if(typeof m%s==="number")',i)("d%s=o.longs===String?String(m%s):m%s",i,i,i)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",i,i,i,i,o?"true":"",i);break;case"bytes":e("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",i,i,i,i,i);break;default:e("d%s=m%s",i,i)}}return e}i.fromObject=function(e){var t=e.fieldsArray,n=o.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return n("return new this.ctor");n("var m=new this.ctor");for(var i=0;i<t.length;++i){var a=t[i].resolve(),u=o.safeProp(a.name);a.map?(n("if(d%s){",u)('if(typeof d%s!=="object")',u)("throw TypeError(%j)",a.fullName+": object expected")("m%s={}",u)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",u),s(n,a,i,u+"[ks[i]]")("}")("}")):a.repeated?(n("if(d%s){",u)("if(!Array.isArray(d%s))",u)("throw TypeError(%j)",a.fullName+": array expected")("m%s=[]",u)("for(var i=0;i<d%s.length;++i){",u),s(n,a,i,u+"[i]")("}")("}")):(a.resolvedType instanceof r||n("if(d%s!=null){",u),s(n,a,i,u),a.resolvedType instanceof r||n("}"))}return n("return m")},i.toObject=function(e){var t=e.fieldsArray.slice().sort(o.compareFieldsById);if(!t.length)return o.codegen()("return {}");for(var n=o.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),i=[],s=[],u=[],l=0;l<t.length;++l)t[l].partOf||(t[l].resolve().repeated?i:t[l].map?s:u).push(t[l]);if(i.length){for(n("if(o.arrays||o.defaults){"),l=0;l<i.length;++l)n("d%s=[]",o.safeProp(i[l].name));n("}")}if(s.length){for(n("if(o.objects||o.defaults){"),l=0;l<s.length;++l)n("d%s={}",o.safeProp(s[l].name));n("}")}if(u.length){for(n("if(o.defaults){"),l=0;l<u.length;++l){var c=u[l],d=o.safeProp(c.name);if(c.resolvedType instanceof r)n("d%s=o.enums===String?%j:%j",d,c.resolvedType.valuesById[c.typeDefault],c.typeDefault);else if(c.long)n("if(util.Long){")("var n=new util.Long(%i,%i,%j)",c.typeDefault.low,c.typeDefault.high,c.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",d)("}else")("d%s=o.longs===String?%j:%i",d,c.typeDefault.toString(),c.typeDefault.toNumber());else if(c.bytes){var h="["+Array.prototype.slice.call(c.typeDefault).join(",")+"]";n("if(o.bytes===String)d%s=%j",d,String.fromCharCode.apply(String,c.typeDefault))("else{")("d%s=%s",d,h)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",d,d)("}")}else n("d%s=%j",d,c.typeDefault)}n("}")}var p=!1;for(l=0;l<t.length;++l){c=t[l];var f=e._fieldsArray.indexOf(c);d=o.safeProp(c.name);c.map?(p||(p=!0,n("var ks2")),n("if(m%s&&(ks2=Object.keys(m%s)).length){",d,d)("d%s={}",d)("for(var j=0;j<ks2.length;++j){"),a(n,c,f,d+"[ks2[j]]")("}")):c.repeated?(n("if(m%s&&m%s.length){",d,d)("d%s=[]",d)("for(var j=0;j<m%s.length;++j){",d),a(n,c,f,d+"[j]")("}")):(n("if(m%s!=null&&m.hasOwnProperty(%j)){",d,c.name),a(n,c,f,d),c.partOf&&n("if(o.oneofs)")("d%s=%j",o.safeProp(c.partOf.name),c.name)),n("}")}return n("return d")}},function(e,t,n){"use strict";var i=t,r=n(25);i[".google.protobuf.Any"]={fromObject:function(e){if(e&&e["@type"]){var t=this.lookup(e["@type"]);if(t){var n="."===e["@type"].charAt(0)?e["@type"].substr(1):e["@type"];return this.create({type_url:"/"+n,value:t.encode(t.fromObject(e)).finish()})}}return this.fromObject(e)},toObject:function(e,t){if(t&&t.json&&e.type_url&&e.value){var n=e.type_url.substring(e.type_url.lastIndexOf("/")+1),i=this.lookup(n);i&&(e=i.decode(e.value))}if(!(e instanceof this.ctor)&&e instanceof r){var o=e.$type.toObject(e,t);return o["@type"]=e.$type.fullName,o}return this.toObject(e,t)}}},function(e,t,n){"use strict";e.exports=p;var i=/[\s{}=;:[\],'"()<>]/g,r=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,o=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,s=/^ *[*/]+ */,a=/^\s*\*?\/*/,u=/\n/g,l=/\s/,c=/\\(.?)/g,d={0:"\0",r:"\r",n:"\n",t:"\t"};function h(e){return e.replace(c,(function(e,t){switch(t){case"\\":case"":return t;default:return d[t]||""}}))}function p(e,t){e=e.toString();var n=0,c=e.length,d=1,p=null,f=null,g=0,m=!1,y=[],b=null;function v(e){return Error("illegal "+e+" (line "+d+")")}function I(t){return e.charAt(t)}function S(n,i){p=e.charAt(n++),g=d,m=!1;var r,o=n-(t?2:3);do{if(--o<0||"\n"===(r=e.charAt(o))){m=!0;break}}while(" "===r||"\t"===r);for(var l=e.substring(n,i).split(u),c=0;c<l.length;++c)l[c]=l[c].replace(t?a:s,"").trim();f=l.join("\n").trim()}function w(t){var n=_(t),i=e.substring(t,n);return/^\s*\/{1,2}/.test(i)}function _(e){for(var t=e;t<c&&"\n"!==I(t);)t++;return t}function O(){if(y.length>0)return y.shift();if(b)return function(){var t="'"===b?o:r;t.lastIndex=n-1;var i=t.exec(e);if(!i)throw v("string");return n=t.lastIndex,U(b),b=null,h(i[1])}();var s,a,u,p,f;do{if(n===c)return null;for(s=!1;l.test(u=I(n));)if("\n"===u&&++d,++n===c)return null;if("/"===I(n)){if(++n===c)throw v("comment");if("/"===I(n))if(t){if(p=n,f=!1,w(n)){f=!0;do{if((n=_(n))===c)break;n++}while(w(n))}else n=Math.min(c,_(n)+1);f&&S(p,n),d++,s=!0}else{for(f="/"===I(p=n+1);"\n"!==I(++n);)if(n===c)return null;++n,f&&S(p,n-1),++d,s=!0}else{if("*"!==(u=I(n)))return"/";p=n+1,f=t||"*"===I(p);do{if("\n"===u&&++d,++n===c)throw v("comment");a=u,u=I(n)}while("*"!==a||"/"!==u);++n,f&&S(p,n-2),s=!0}}}while(s);var g=n;if(i.lastIndex=0,!i.test(I(g++)))for(;g<c&&!i.test(I(g));)++g;var m=e.substring(n,n=g);return'"'!==m&&"'"!==m||(b=m),m}function U(e){y.push(e)}function k(){if(!y.length){var e=O();if(null===e)return null;U(e)}return y[0]}return Object.defineProperty({next:O,peek:k,push:U,skip:function(e,t){var n=k();if(n===e)return O(),!0;if(!t)throw v("token '"+n+"', '"+e+"' expected");return!1},cmnt:function(e){var n=null;return void 0===e?g===d-1&&(t||"*"===p||m)&&(n=f):(g<e&&k(),g!==e||m||!t&&"/"!==p||(n=f)),n}},"line",{get:function(){return d}})}p.unescape=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(54),r=n(7),o=n(106),s=n(32);class a extends i.default{constructor({appid:e}){super({appid:e})}createRTSInstance(){return this.rtsService||(this.rtsService=new o.default(this)),this.rtsService}}const u=function(){let e;return function(t){return e||(e=new a(t)),e}}();t.default={VERSION:s.VERSION,createHummer:u,ConnectionChangeReason:r.ConnectionChangeReason,ConnectionState:r.ConnectionState,Utify:r.Utify}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(e){o(e)}}function a(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(s,a)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),o=n(0),s=n(56),a=n(84),u=n(7),l=n(39),c=n(95),d=n(18),h=n(27),p=n(15),f=n(104),g=n(4),m=n(28),y=n(16),b=n(35),v=new r.Logger("Hummer");class I{constructor({appid:e}){this.checkTimer=null,this.chatrooms=[],this.rtsService=null,this.handlers={},this.mutex=new h.default,o.default.isNumber(e)||v.warn("constructor: appid must be number"),this.appid=e,this.h5_g_globals=new a.default(e),v.info("new Hummer, isMiniProgram =",this.h5_g_globals.isMiniProgram),this.h5_g_globals.appid=e,this.h5_g_globals.hiidoHost=u.getHiidoHost(!0),this.setScode(50275),this.ap=new s.default(this.h5_g_globals),this.addEventListener(),this.checkTimes=0,this.checkTimer=setInterval(this.onCheckTimer.bind(this),1e3),this.start()}get uid(){return this.h5_g_globals.uid}set uid(e){this.h5_g_globals.uid=e}get token(){return this.h5_g_globals.token}set token(e){this.h5_g_globals.token=e}get connectState(){return this.ap.connectState}set connectState(e){this.ap.connectState=e}addEventListener(){this.addConnectionStateListener(),this.ap.on(y.AP_EVENTS.TOKEN_EXPIRED,()=>{this.emit(y.HUMMER_EVENTS.TOKEN_EXPIRED)}),this.ap.on(y.AP_EVENTS.FORCE_OUT,e=>{v.debug("ForceOut: data=",e),this.onConnectionStateChange({state:u.ConnectionState.DISCONNECTED,reason:u.ConnectionChangeReason.REMOTE_LOGIN})})}addConnectionStateListener(){this.ap.on(y.AP_EVENTS.CONNECTION_STATE_CHANGED,e=>{this.emit(y.HUMMER_EVENTS.CONNECTION_STATE_CHANGED,e),e.reason===u.ConnectionChangeReason.LOGOUT&&this.stop()})}onConnectionStateChange(e){b.looseEqual(e,this.connectState)||(this.connectState=e,this.emit(y.HUMMER_EVENTS.CONNECTION_STATE_CHANGED,e))}start(){v.log("start"),this.ap&&this.ap.start()}onCheckTimer(){let e=d.default.now();this.checkTimes++,this.ap&&this.ap.onCheckTimer(e,this.checkTimes)}setScode(e){o.default.isNumber(e)?(e<=0&&(e=0),v.debug("setScode: scode="+e),this.h5_g_globals.scode=e):v.error("setScode: scode must be a number")}setLogLevel(e=r.LOGLEVEL.LOG){r.Logger.setLevel(e)}getLog(){return r.Logger.getLog()}login(e){return o.default.isUint64String(e.uid)?this.h5_g_globals.bLostConnection?Promise.reject({rescode:u.kOperationTimeout,msg:u.OPERATION_TIMEOUT}):new Promise((t,n)=>i(this,void 0,void 0,(function*(){try{yield this.mutex.wait(u.MutexKey.login),this.mutex.lock(u.MutexKey.login);const i=this.getTokenType(e.tokenType);if(i===u.TokenType.UNKOWN)return n({rescode:u.UNKOWN,msg:"tokenType invalid"});this.h5_g_globals.tokenType=i,this.onConnectionStateChange({state:u.ConnectionState.CONNECTING,reason:u.ConnectionChangeReason.LOGIN});let r="0",s="";e?(r=e.uid,s=e.token):(r=o.default.getCookie("hummer_uid",this.h5_g_globals.isMiniProgram),s=o.default.getCookie("hummer_token",this.h5_g_globals.isMiniProgram)),"0"===r&&t({rescode:u.UNKOWN,msg:"uid=0 no need to login"}),this.h5_g_globals.uid=r,this.h5_g_globals.token=s,v.log("login: appid="+this.appid+" uid="+this.h5_g_globals.uid+" tokenType="+this.h5_g_globals.tokenType+" token="+this.h5_g_globals.token);const a=yield this.ap.loginAp();if(a&&0===a.rescode){if(this.setCookie(r,s),e.region){let t=e.region;yield this.setUserRegion({region:t})}}else this.onConnectionStateChange({state:u.ConnectionState.DISCONNECTED,reason:u.ConnectionChangeReason.LOGIN_FAILURE});t(a)}catch(e){n(e)}finally{this.mutex.unlock(u.MutexKey.login)}}))):Promise.reject({rescode:u.kInvalid_Parameters,msg:u.INVALID_PARAMETERS})}logout(e=!0){const t=this.h5_g_globals;return t.isAnonymous?Promise.resolve({rescode:0,msg:"uid="+this.uid+" not need to logout"}):(v.debug("logout uid="+t.uid+" isAnonymous="+t.isAnonymous),this.h5_g_globals.bLostConnection?Promise.reject({rescode:u.kOperationTimeout,msg:u.OPERATION_TIMEOUT}):new Promise((n,r)=>i(this,void 0,void 0,(function*(){try{yield this.mutex.wait(u.MutexKey.logout),this.mutex.lock(u.MutexKey.logout);const i=yield this.ap.logoutAp();i&&0===i.rescode&&(this.uid="0",t.logout(),e||t.isMiniProgram||(v.warn("Hummer.logout clear token"),this.clearCookie())),n(i)}catch(e){r(e)}finally{this.mutex.unlock(u.MutexKey.logout)}}))))}refreshToken(e){return this.h5_g_globals.isAnonymous||"0"===this.uid?Promise.resolve({rescode:u.UNKOWN,msg:"anonymous user not need to refreshToken, please login"}):new Promise((t,n)=>i(this,void 0,void 0,(function*(){try{yield this.mutex.wait(u.MutexKey.login),this.mutex.lock(u.MutexKey.login),this.token=e.token;const n=yield this.ap.loginAp();n&&0===n.rescode?(this.setCookie(this.uid,e.token),this.subscribeUserGroup()):this.onConnectionStateChange({state:u.ConnectionState.RECONNECTING,reason:u.ConnectionChangeReason.INTERRUPTED}),t(n)}catch(e){n(e)}finally{this.mutex.unlock(u.MutexKey.login)}})))}createChatRoom(e){let t=new f.default;t.appid=this.appid,t.uid=this.h5_g_globals.uid,e.attributes&&(t.props=o.default.toMap(e.attributes));let n=t.marshall();const i=`svc_${u.parseEnvParams(e.region).area}_chatroom_auther`;return this.send(i,"CreateChatRoom",n)}getState(){return this.connectState.state}getInstanceInfo(){return this.h5_g_globals.bLostConnection?Promise.resolve({rescode:u.UNKOWN,msg:"disconnected"}):Promise.resolve({rescode:0,uid:this.uid,instanceId:this.h5_g_globals.instId,isAnonymous:this.h5_g_globals.isAnonymous,appid:this.h5_g_globals.appid})}setUserRegion(e){return new Promise((t,n)=>i(this,void 0,void 0,(function*(){try{const n=l.hummerProto.SetUserRegionRequest;let i=n.create({logId:this.generateLogId(),appId:g.fromNumber(this.appid),selfUid:g.fromString(this.uid),region:e.region});v.debug("setUserRegion:",i,"logId=",i.logId.toString());let r=n.encode(i).finish();const o=u.parseEnvParams(e.region),s=`svc_${o.area}_cim_${o.type}_${o.name}_proxy`,a=yield this.send(s,"cim.proto.ProxyService.SetUserRegion",r);a instanceof l.hummerProto.SetUserRegionResponse?(v.log("setUserRegion res:",a),0===a.code&&(this.h5_g_globals.hiidoHost=u.getHiidoHost(o.innerFlag),this.h5_g_globals.userRegion=e.region),t({rescode:a.code,msg:a.msg})):(v.warn("setUserRegion: unexpected response:",a),t({rescode:u.UNKOWN,msg:"unexpected response: "+a}))}catch(e){n(e)}})))}decodeRouteRes(e){return c.default.decodeRouteRes(e)}send(e,t,n){return this.h5_g_globals.bLostConnection?Promise.reject({rescode:u.kOperationTimeout,msg:u.OPERATION_TIMEOUT}):new Promise((r,o)=>i(this,void 0,void 0,(function*(){try{const i=yield this.ap.sendData(this.appid,e,t,n),o=this.decodeRouteRes(i);r(o)}catch(e){o(e)}})))}subscribeUserGroup(){this.ap.subscribeUserGroup(),this.ap.subscribeUserGroupV2()}setCookie(e,t){if(this.h5_g_globals.isMiniProgram)o.default.setWxCookie("hummer_uid",e),o.default.setWxCookie("hummer_token",t);else{let n="https:"==document.location.protocol;o.default.setCookie("hummer_uid",e,168,"/",this.h5_g_globals.domain,n),o.default.setCookie("hummer_token",t,168,"/",this.h5_g_globals.domain,n)}}clearCookie(){let e=document.cookie.split(";");for(let t=0;t<e.length;t++)/^hummer_/.test(e[t].split("=")[0].replace(/\s/,""))&&(document.cookie=e[t].split("=")[0].replace(/\s/,"")+"="+e[t].split("=")[1]+";expires="+new Date(1)+";domain="+this.h5_g_globals.domain+";path=/")}stop(){v.log("stop"),this.chatrooms=[],this.rtsService=null}}t.default=I,u.applyMixins(I,[p.Emitter,m.Base])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=Object.prototype.hasOwnProperty,r=Object.prototype.toString,o=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===r.call(e)},s=function(e){if(!e||"[object Object]"!==r.call(e))return!1;let t,n=i.call(e,"constructor"),o=e.constructor&&e.constructor.prototype&&i.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!o)return!1;for(t in e);return void 0===t||i.call(e,t)},a=function(...e){let t,n,i,r,u,l,c=arguments[0],d=1,h=arguments.length,p=!1;for("boolean"==typeof c&&(p=c,c=arguments[1]||{},d=2),(null==c||"object"!=typeof c&&"function"!=typeof c)&&(c={});d<h;++d)if(t=arguments[d],null!=t)for(n in t)i=c[n],r=t[n],c!==r&&(p&&r&&(s(r)||(u=o(r)))?(u?(u=!1,l=i&&o(i)?i:[]):l=i&&s(i)?i:{},c[n]=a(p,l,r)):void 0!==r&&(c[n]=r));return c};t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(32),r=n(7),o=n(58),s=n(5),a=n(59),u=n(60),l=n(9),c=n(2),d=n(0),h=n(62),p=n(63),f=n(64),g=n(65),m=n(18),y=n(66),b=n(70),v=n(72),I=n(73),S=n(74),w=n(75),_=n(76),O=n(77),U=n(78),k=n(79),T=n(80),R=n(81),E=n(82),x=n(83),A=n(15),M=n(16),N=n(35),C=new s.Logger("Ap");class P{constructor(e){this.wsAddr=r.WSHOST,this.connectState={state:r.ConnectionState.DISCONNECTED,reason:r.ConnectionChangeReason.INIT},this.logined=!1,this.loginState=r.LoginState.UNKOWN,this.link=null,this.latenceStat={min:0,max:0,avg:0,count:0,sum:0,timeout:0},this.handleDic=new Map,this.bcUriDic=[],this.isTokenOk=!0,this.loginBuf=[],this.handlers={},this.h5_g_globals=e,this.wsState=g.default.INIT,this.lastTimerCheck=m.default.now(),this.lastRecvPong=m.default.now(),this.sendBuf=[],this.registerHandle()}get uid(){return this.h5_g_globals.uid}get token(){return this.h5_g_globals.token||""}registerHandle(){this.addHandle(l.default.PSvcLoginResURI,this.onPSvcLoginRes.bind(this)),this.addHandle(l.default.PSvcLogoutResURI,this.onPSvcLogoutRes.bind(this)),this.addHandle(l.default.PSvcRouteResURI,this.onPSvcRouteRes.bind(this)),this.addHandle(l.default.PSvcSubsGroupResURI,this.onPSvcSubsGroupRes.bind(this)),this.addHandle(l.default.PCS_ServiceSubcribeUserGroupResV2URI,this.onPSvcSubsGroupResV2.bind(this)),this.addHandle(l.default.PSvcUnicastURI,this.onPSvcUnicast.bind(this)),this.addHandle(l.default.PSvcBroadcastURI,this.onPSvcBroadcast.bind(this)),this.addHandle(l.default.PCS_ServiceBroadCastV2URI,this.onPSvcBroadcastV2.bind(this)),this.addHandle(l.default.PAPForceOutURI,this.onAPForceOut.bind(this))}addHandle(e,t){this.handleDic.set(e,t)}onCheckTimer(e,t){if(this.wsState!=g.default.CLOSED&&this.link){if(this.wsState==g.default.CONNECTED&&e-this.lastTimerCheck>=5e3)if(this.lastTimerCheck=e,this.logined)this.pingAp().catch(e=>{C.warn(e)});else if(this.loginBuf.length>0)for(let e=0;e<this.loginBuf.length;e++)this.send(this.loginBuf[e].arraybuffer),this.loginBuf.splice(e,1);else this.isTokenOk&&this.loginAp().then(e=>{this.onTokenExpired(e.rescode)}).catch(e=>{C.warn(e)})}else this.logined=!1,C.log("onCheckTimer check ap not ready. re-connect. wsState="+this.wsState),this.connect(),this.loginState!==r.LoginState.LOGOUT&&this.onConnectionStateChange({state:r.ConnectionState.RECONNECTING,reason:r.ConnectionChangeReason.INTERRUPTED});t%60==0&&this.reportRtt()}stop(){C.log("stop"),this.clearLoginBuf(),setTimeout(()=>{this.h5_g_globals.logout()},100),this.close()}clearSendBuf(){this.sendBuf.length>500&&(this.sendBuf=[])}deleteLoginBufBySeqId(e){for(let t=0;t<this.loginBuf.length;t++)this.loginBuf[t].seqId===e&&this.loginBuf.splice(t,1)}clearLoginBuf(){this.loginBuf=[]}pushLoginBuf(e){let t=this.loginBuf.length;t>20&&this.loginBuf.splice(0,t-20),this.loginBuf.push(e)}flushBuf(){const e=this.sendBuf.length;if(0!==e){C.log("flushBuf len="+e);for(let t=0;t<e;++t){let e=this.sendBuf[t];if(e.origin)this.send(e.data);else{let t=this.wrapApRouter(e);this.send(t.buf)}}}this.sendBuf=[]}onLoginAp(e){if(!N.looseEqual(e,this.connectState))switch(C.debug("onLoginAp: state="+JSON.stringify(e)),this.connectState=e,this.emit(M.AP_EVENTS.CONNECTION_STATE_CHANGED,e),this.logined=e.state===r.ConnectionState.CONNECTED,e.state){case r.ConnectionState.CONNECTED:this.flushBuf();break;case r.ConnectionState.DISCONNECTED:e.reason===r.ConnectionChangeReason.LOGOUT&&this.stop()}}onConnectionStateChange(e){N.looseEqual(e,this.connectState)||(this.connectState=e,this.emit(M.AP_EVENTS.CONNECTION_STATE_CHANGED,e))}appidReady(){return this.link&&this.wsState===g.default.CONNECTED&&this.logined}resetWsState(){C.log("resetWsState"),this.wsState=g.default.CLOSED,this.link&&this.link.reset(),this.clearSendBuf()}onopen(){if(C.log("onopen"),this.h5_g_globals.bLostConnection&&(this.h5_g_globals.bLostConnection=!1),this.wsState=g.default.CONNECTED,"0"!==this.uid&&this.isTokenOk&&0===this.loginBuf.length){const e={state:r.ConnectionState.RECONNECTING,reason:r.ConnectionChangeReason.INTERRUPTED};this.onConnectionStateChange(e)}if(this.loginBuf.length>0)for(let e=0;e<this.loginBuf.length;e++)this.send(this.loginBuf[e].arraybuffer),this.loginBuf.splice(e,1);else this.isTokenOk&&this.loginAp().then(e=>{this.onTokenExpired(e.code)}).catch(e=>{C.warn("onopen: loginAp err=",e)})}onclose(){C.log("onclose"),this.wsState!=g.default.CONNECTED||this.h5_g_globals.bLostConnection||(this.h5_g_globals.bLostConnection=!0),this.resetWsState()}onerror(e){C.debug("onerror err="+JSON.stringify(e)),this.resetWsState()}onData(e,t){let n=new c.default(t);if(e===l.default.PSvcPongURI){let e=new h.default;e.unmarshall(n),this.setHeartBeatTimeoutSecs(e);const t=this.h5_g_globals.seqContext[e.context];t&&(delete this.h5_g_globals.seqContext[e.context],t.resolve(e)),this.lastRecvPong=m.default.now()}else this.onProto(e,n)}setHeartBeatTimeoutSecs(e){e&&e.heartBeatTimeoutSecs&&(this.h5_g_globals.heartBeatTimeoutSecs=e.heartBeatTimeoutSecs)}onProto(e,t){const n=this.handleDic.get(e);void 0!==n?n(t):C.log("onProto UNKNOWN uri="+(e>>8&d.default.getUintMax())+"/"+(255&e))}send(e){this.link&&this.wsState==g.default.CONNECTED?this.link.send(e):C.warn("send failed")}sendLoginRequest(e,t){this.link&&this.wsState==g.default.CONNECTED?this.link.send(e):(C.log("sendLoginRequest socket is not ready, and try to cache"),this.pushLoginBuf({arraybuffer:e,seqId:t}))}wrapApRouter(e){let t=e.appid,n=e.svcName,i=e.fnName,r=e.routeArgs,o=e.clientHeaders,s=e.protoType,u=new a.default;if(e.preAllocSeq?u.context=e.preAllocSeq:u.context=this.h5_g_globals.getSeqId().toString(),u.uid=this.logined?this.h5_g_globals.uid:"0",u.appid=t,u.instId=this.h5_g_globals.instId,u.svcName=n,u.traceId="web_"+u.instId.toString()+"_"+u.context,i&&(u.fnName=i),s&&(u.protoType=s),u.data=e.data,u.dataCRC=0,r&&(u.routeArgs=r),o){if(!d.default.isMap(o))return void C.error("wrapApRouter clientHeaders should be a map!");for(let[e,t]of o)e!==a.APIVersion&&u.clientHeaders.set(e,t)}let l=u.marshall();return C.debug("wrapApRouter send service route request: "+u.toString()),{buf:l,seqId:u.context}}sendData(e,t,n,i){return new Promise((r,o)=>{C.debug("====== send ======",t,n);const s=Date.now();console.time("sendData_"+s);const a={appid:e,svcName:t,fnName:n,data:i,routeArgs:new Map,clientHeaders:new Map,protoType:"yyp"};this.sendAppData(a).then(e=>{if(C.debug("sendAppData cb",t,n),console.timeEnd("sendData_"+s),!e)return o(e);r(e)}).catch(e=>{o(e)})})}sendAppData(e){return this.sendApRouter(e)}sendApRouter(e){let t="",n=new Promise((n,i)=>{if(this.appidReady()){let n=this.wrapApRouter(e);t=n.seqId,this.send(n.buf)}else{let r=Object.assign({},e);r.resolve=n,r.reject=i,r.preAllocSeq=this.h5_g_globals.getSeqId().toString(),r.fnName=e.fnName,r.uri=e.uri,t=r.preAllocSeq,this.sendBuf.push(r)}this.h5_g_globals.seqContext[t]={resolve:n,reject:i,appid:e.appid,svcName:e.svcName,fnName:e.fnName,protoType:e.protoType,uri:e.uri?e.uri:0,routeReqStartTs:m.default.now(),traceId:"web_"+this.h5_g_globals.instId.toString()+"_"+t}}),i=d.default.DelayPromise(r.TIME_OUT).then(()=>{let e=this.h5_g_globals;const n=e.seqContext[t];if(n){let i="appid:"+n.appid+" svcName:"+n.svcName+" fnName:"+n.fnName+" traceId:"+n.traceId;C.log("sendApRouter seqId:"+t+" time out. "+i);let o=new Map;o.set("appid",e.appid),o.set("uid",e.uid),o.set("serviceName",n.svcName),o.set("functionName",n.fnName),o.set("traceId",n.traceId),o.set("cost",r.TIME_OUT),o.set("uri",n.uri),o.set("sdkResCode",-3);let s=y.default.genUrl(o);if(y.default.sendUrl(s,e.isMiniProgram),b.default.report(e.scode,n.svcName,n.fnName,n.protoType,r.TIME_OUT,408),this.sendBuf){for(let e=this.sendBuf.length-1;e>=0;e--){let t=this.sendBuf[e].uri;t===l.default.PTextChatReqURI&&(C.warn("sendApRouter remove cached data, preAllocSeq="+this.sendBuf[e].preAllocSeq+" uri="+t),this.sendBuf.splice(e,1))}}throw delete e.seqContext[t],{rescode:r.kOperationTimeout,msg:r.OPERATION_TIMEOUT}}});return Promise.race([n,i])}onPSvcRouteRes(e){let t=new O.default;t.unmarshall(e);const n=this.h5_g_globals;let i=n.seqContext[t.context];if(i){let r=i.resolve,o=i.reject;C.log("onPSvcRouteRes:"+t.toString());let s=m.default.now()-i.routeReqStartTs,a=new Map;this.fillStatMap(a,e.uri,t),a.set("rtt",s),this.checkAndSendStatMap(a),b.default.report(n.scode,i.svcName,i.fnName,i.protoType,s,t.rescode),200===t.rescode?r&&r(t):o&&o({rescode:t.rescode,msg:t.msg,appid:i.appid,svcName:i.svcName,fnName:i.fnName,traceId:t.traceId}),delete n.seqContext[t.context]}}onPSvcSubsGroupRes(e){let t=new U.default;t.unmarshall(e);const n=this.h5_g_globals;let i=n.seqContext[t.context];if(i){let o=i.resolve,s=i.reject;C.log("onPSvcSubsGroupRes: "+JSON.stringify(t));let a=m.default.now()-i.subReqStartTs,u=new Map;this.fillStatMap(u,e.uri,t),u.set("rtt",a),u.set("tid",i.traceId),this.checkAndSendStatMap(u),b.default.report(n.scode,"svc_sub_v2","","",a,t.rescode),200===t.rescode?o&&o({context:t.context,rescode:r.SUCCESS,msg:r.OK,traceId:i.traceId}):s&&s({rescode:t.rescode,msg:"subs bc groups error",traceId:i.traceId}),delete n.seqContext[t.context]}else C.debug("onPSvcSubsGroupRes maybe timeout: context="+t.context+" rescode="+t.rescode)}onPSvcSubsGroupResV2(e){let t=new R.default;t.unmarshall(e);const n=this.h5_g_globals;let i=n.seqContext[t.context];if(i){let o=i.resolve,s=i.reject;C.log("onPSvcSubsGroupResV2: "+JSON.stringify(t));let a=m.default.now()-i.subReqStartTs,u=new Map;this.fillStatMap(u,e.uri,t),u.set("rtt",a),u.set("tid",i.traceId),this.checkAndSendStatMap(u),b.default.report(n.scode,"svc_sub","","",a,t.rescode),200===t.rescode?o&&o({context:t.context,rescode:r.SUCCESS,msg:t.msg,traceId:t.traceId}):s&&s({rescode:t.rescode,msg:t.msg,traceId:t.traceId}),delete n.seqContext[t.context]}else C.debug("onPSvcSubsGroupResV2 maybe timeout: context="+t.context+" rescode="+t.rescode)}fillStatMap(e,t,n){const r=this.h5_g_globals;e.set("said",r.appid),e.set("uid",r.uid),e.set("uri",t),e.set("sdkv","web_"+i.sdkVersion),n.svcName&&e.set("sn",n.svcName),n.fnName&&e.set("fn",n.fnName),n.traceId&&e.set("tid",r.uid+"_"+n.traceId),n.rescode?e.set("sc",n.rescode):e.set("sc",200),e.set("cc",1),e.set("no",0)}checkAndSendStatMap(e,t="ystrpc"){e.get("rtt")<0&&(e.set("rtt",d.default.getUintMax),C.warn("checkAndSendStatMap invalid cost value, set it to uint.max, map:"+JSON.stringify(e)));let n=y.default.genUrl(e,t,this.h5_g_globals.hiidoHost);y.default.sendUrl(n,this.h5_g_globals.isMiniProgram)}connect(){if(this.wsState!=g.default.CONNECTING&&this.wsState!=g.default.CONNECTED){const e=this.h5_g_globals,t=this.wsAddr+"/websocket?appid="+e.appid+"&version="+encodeURIComponent(i.sdkVersion.toString())+"&uuid="+encodeURIComponent(e.uuid);C.log("connect start to connect ws server. url="+t),this.link=new o.default(this,e.isMiniProgram),this.wsState=g.default.CONNECTING,this.link.connect(t)}else C.log("connect websocket is connecting/connected...")}close(){this.wsState!=g.default.CLOSING?(this.wsState=g.default.CLOSING,this.link&&this.link.reset()):C.log("connect websocket is closing...")}reportRtt(){this.latenceStat={min:0,max:0,avg:0,count:0,sum:0,timeout:0}}pingAp(){let e="",t=m.default.now(),n=new Promise((n,i)=>{let r=new p.default;r.appid=this.h5_g_globals.appid,r.context=this.h5_g_globals.getSeqId().toString(),e=r.context,this.send(r.marshall()),this.h5_g_globals.seqContext[e]={resolve:()=>{let e=m.default.now()-t;(e<this.latenceStat.min||0==this.latenceStat.min)&&(this.latenceStat.min=e),(e>this.latenceStat.max||0==this.latenceStat.max)&&(this.latenceStat.max=e),this.latenceStat.sum+=e,this.latenceStat.count+=1,this.latenceStat.avg=Math.round(this.latenceStat.sum/this.latenceStat.count)},reject:()=>{this.latenceStat.timeout+=1}}}),i=d.default.DelayPromise(r.TIME_OUT).then(()=>{if(this.h5_g_globals.seqContext[e])throw C.debug("pingAp ping seqId:"+e+" time out."),delete this.h5_g_globals.seqContext[e],this.latenceStat.timeout+=1,this.resetWsState(),{rescode:r.kOperationTimeout,msg:r.OPERATION_TIMEOUT}});return Promise.race([n,i])}loginAp(){if("0"===this.uid)return C.debug("loginAp: waiting"),this.logined=!0,Promise.resolve({rescode:r.UNKOWN,msg:"uid=0 no need to login"});let e=m.default.now(),t="",n=new Promise((n,r)=>{this.h5_g_globals.loginApStartTs=e;let o=new u.default;o.context=this.h5_g_globals.getSeqId().toString(),o.uid=this.uid,o.appid=this.h5_g_globals.appid,o.instId=this.h5_g_globals.instId,o.seqId=parseInt(o.context),o.tokenType=this.h5_g_globals.tokenType,o.otp=this.token,o.traceId="web_"+o.instId+"_"+o.context,C.debug("loginAp: otp len="+o.otp.length),o.clientHeaders.set("SCKTerminal","web"),o.clientHeaders.set("SCKSvcSdkVer",i.sdkVersion.toString()),C.debug("loginAp: req="+JSON.stringify(o)),t=o.context,this.sendLoginRequest(o.marshall(),t),this.h5_g_globals.seqContext[t]={resolve:n,reject:r}}),o=d.default.DelayPromise(r.TIME_OUT).then(()=>{if(this.h5_g_globals.seqContext[t])throw C.debug("loginAp seqId:"+t+" time out."),delete this.h5_g_globals.seqContext[t],this.latenceStat.timeout+=1,this.deleteLoginBufBySeqId(t),this.isTokenOk=!1,{rescode:r.kOperationTimeout,msg:r.OPERATION_TIMEOUT}});return Promise.race([n,o])}logoutAp(){const e=this.h5_g_globals;if(e.isAnonymous)return C.debug("logout anonymous user not need to logout."),Promise.resolve({rescode:r.UNKOWN,msg:"anonymous uid="+e.uid+" not need to logout"});let t="",n=new Promise((n,i)=>{this.emit(M.AP_EVENTS.TRY_LOGOUT),e.logoutApStartTs=m.default.now();let r=new f.default;r.context=e.getSeqId().toString(),r.uid=e.uid,r.appid=e.appid,r.instId=e.instId,C.debug("logoutAp: req="+JSON.stringify(r)),setTimeout(()=>{this.send(r.marshall())},500),t=r.context,this.h5_g_globals.seqContext[t]={resolve:n,reject:i}}),i=d.default.DelayPromise(r.TIME_OUT).then(()=>{if(e.seqContext[t])throw C.log("logoutAp seqId:"+t+" time out."),delete e.seqContext[t],this.latenceStat.timeout+=1,{rescode:r.kOperationTimeout,msg:r.OPERATION_TIMEOUT}});return Promise.race([n,i])}onPSvcLoginRes(e){let t=new E.default;t.unmarshall(e);const n=this.h5_g_globals;let i=n.seqContext[t.context];if(i){let o=i.resolve;i.reject;delete n.seqContext[t.context],C.debug("onPSvcLoginRes: "+JSON.stringify(t));let s=m.default.now()-this.h5_g_globals.loginApStartTs,a=new Map;if(this.fillStatMap(a,e.uri,t),a.set("rtt",s),this.checkAndSendStatMap(a,"ystsvclogin"),b.default.report(this.h5_g_globals.scode,"svc_login","","",s,t.rescode),200===t.rescode)C.debug("onPSvcLoginRes success: "+JSON.stringify(t)),this.h5_g_globals.userType=r.UserType.NON_ANONYMOUS,this.loginState=r.LoginState.LOGIN,this.isTokenOk=!0,this.onLoginAp({state:r.ConnectionState.CONNECTED,reason:r.ConnectionChangeReason.LOGIN_SUCCESS}),o&&o({rescode:r.SUCCESS,msg:r.OK});else{C.warn("onPSvcLoginRes:",t);const e=this.parseTokenStatus(t.serverHeaders)||{code:t.rescode,msg:t.msg};this.start(),o&&o({rescode:e.code,msg:e.msg})}}else C.log("onPSvcLoginRes: "+JSON.stringify(t))}parseTokenStatus(e){if(d.default.hasOwn(e,"tokenservice-errorCode")&&d.default.hasOwn(e,"tokenservice-errorMsg")){return{code:Number(e["tokenservice-errorCode"]),msg:e["tokenservice-errorMsg"]}}return null}onPSvcLogoutRes(e){let t=new x.default;t.unmarshall(e);const n=this.h5_g_globals,i=n.seqContext[t.context];if(i){let o=i.resolve;i.reject;delete n.seqContext[t.context],C.log("onPSvcLogoutRes: "+JSON.stringify(t));let s=m.default.now()-this.h5_g_globals.logoutApStartTs,a=new Map;if(this.fillStatMap(a,e.uri,t),a.set("cost",s),this.checkAndSendStatMap(a),b.default.report(this.h5_g_globals.scode,"svc_logout","","",s,t.rescode),200===t.rescode){o&&o({rescode:r.SUCCESS,msg:r.OK});const e={state:r.ConnectionState.DISCONNECTED,reason:r.ConnectionChangeReason.LOGOUT};this.loginState=r.LoginState.LOGOUT,this.onConnectionStateChange(e)}else o&&o({rescode:t.rescode,msg:t.msg})}else C.log("onPSvcLogoutRes: "+JSON.stringify(t))}subscribeBc(e){const t=this.h5_g_globals,n=t.getSeqId().toString();let i=new Promise((i,r)=>{let o=new k.default;if(o.context=n,o.appid=t.appid,e.subs){o.joinGroups=e.subs;let n=e.subs.length;for(let i=0;i<n;++i){let n=e.subs[i].grpType+"_"+e.subs[i].grpId;t.userGroups.subs[n]=1}}if(e.unsubs){o.leaveGroups=e.unsubs;let n=e.unsubs.length;for(let i=0;i<n;++i){let n=e.unsubs[i].grpType+"_"+e.unsubs[i].grpId;t.userGroups.unsubs[n]=1}}C.log("subscribeBc "+JSON.stringify(o));let s=o.marshall();if(this.appidReady())this.send(s);else{let e={data:s,resolve:i,reject:r,origin:!0};this.sendBuf.push(e)}t.seqContext[n]={resolve:i,reject:r,subReqStartTs:m.default.now(),traceId:"web_"+t.instId+"_"+o.context}}),o=d.default.DelayPromise(r.TIME_OUT).then(()=>{const e=t.seqContext[n];if(e){C.warn("subscribeBc seqId:"+n+" timeout.");let i=new Map;throw this.fillStatMap(i,l.default.PSvcSubsGroupReqURI,e),i.set("rrt",r.TIME_OUT),i.set("cc",-3),this.checkAndSendStatMap(i),b.default.report(t.scode,"svc_sub","","",r.TIME_OUT,408),delete t.seqContext[n],{rescode:r.kOperationTimeout,msg:r.OPERATION_TIMEOUT}}});return Promise.race([i,o])}subscribeBcV2(e){const t=this.h5_g_globals;let n=t.getSeqId().toString(),i=new Promise((i,r)=>{let o=new T.default;if(o.context=n,o.appid=t.appid,o.traceId="web_"+t.instId+"_"+o.context,e.subs){o.join=e.subs;for(const n of e.subs)-1===t.userGroupsV2.subs.indexOf(n)&&t.userGroupsV2.subs.push(n)}if(e.unsubs){o.leave=e.unsubs;for(const n of e.unsubs)-1===t.userGroupsV2.unsubs.indexOf(n)&&t.userGroupsV2.unsubs.push(n)}C.log("subscribeBcV2: "+JSON.stringify(o));let s=o.marshall();if(this.appidReady())this.send(s);else{let e={data:s,resolve:i,reject:r,origin:!0};this.sendBuf.push(e)}t.seqContext[n]={resolve:i,reject:r,subReqStartTs:m.default.now(),traceId:o.traceId}}),o=d.default.DelayPromise(r.TIME_OUT).then(()=>{const e=t.seqContext[n];if(e){C.warn("subscribeBcV2 seqId:"+n+" timeout.");let i=new Map;throw this.fillStatMap(i,l.default.PSvcSubsGroupReqURI,e),i.set("rrt",r.TIME_OUT),i.set("cc",-3),this.checkAndSendStatMap(i),b.default.report(t.scode,"svc_sub","","",r.TIME_OUT,408),delete t.seqContext[n],{rescode:r.kOperationTimeout,msg:r.OPERATION_TIMEOUT}}});return Promise.race([i,o])}subscribeUserGroup(){this.filterUnsubs();const e=this.h5_g_globals;let t=e.userGroups.subs,n=[],i=Object.keys(t);for(let e=0;e<i.length;++e){let t=i[e].split("_");n.push({grpType:t[0],grpId:t[1]})}t=e.userGroups.unsubs;let r=[],o=Object.keys(t);for(let e=0;e<o.length;++e){let t=o[e].split("_");r.push({grpType:t[0],grpId:t[1]})}(n&&n.length||r&&r.length)&&(C.log("subscribeUserGroup re-subs groups. subs:"+JSON.stringify(n)+" unsubs:"+JSON.stringify(r)),this.subscribeBc({subs:n,unsubs:r}).catch(e=>{C.warn(e)}))}subscribeUserGroupV2(){this.filterUnsubsV2();const e=this.h5_g_globals.userGroupsV2.subs,t=this.h5_g_globals.userGroupsV2.unsubs;(e&&e.length||t&&t.length)&&(C.log("subscribeUserGroupV2 re-subs groups. subs="+JSON.stringify(e)+" unsubs="+JSON.stringify(t)),this.subscribeBcV2({subs:e,unsubs:t}).catch(e=>{C.warn(e)}))}filterUnsubs(){for(let e in this.h5_g_globals.userGroups.unsubs)for(let t in this.h5_g_globals.userGroups.subs)JSON.stringify(this.h5_g_globals.userGroups.unsubs[e])===JSON.stringify(this.h5_g_globals.userGroups.subs[t])&&delete this.h5_g_globals.userGroups.unsubs[e]}filterUnsubsV2(){this.h5_g_globals.userGroupsV2.subs.forEach(e=>{const t=this.h5_g_globals.userGroupsV2.unsubs.indexOf(e);-1!==t&&this.h5_g_globals.userGroupsV2.unsubs.splice(t,1)})}start(){C.log("start"),this.connect()}onPSvcUnicast(e){let t=new v.default;t.unmarshall(e);let n=new Map;this.fillStatMap(n,e.uri,t),n.set("length",t.data.byteLength),this.checkAndSendStatMap(n),C.log("onPSvcUnicast:"+t.toString());const i={appid:t.appid,svcName:t.svcName,fnName:t.fnName,protoType:t.protoType,traceId:t.traceId,data:t.data};this.emit(M.AP_EVENTS.UNICAST,i);let r=new I.default;r.context=t.context;let o=r.marshall();this.send(o)}onPSvcBroadcast(e){let t=new S.default;t.unmarshall(e);let n=t.groupType.toString()+"_"+t.groupId.toString();if(C.log("onPSvcBroadcast:"+t.toString()+" bcKey="+n+" isInnerBcGroup="+this.h5_g_globals.innerBcGroups[n]),this.h5_g_globals.innerBcGroups[n]){let e=new Uint8Array(t.data.byteLength);e.set(t.data,0),t.data=null;let n=new DataView(e.buffer),i=new c.default(n);this.bcUriDic.indexOf(i.uri)>-1?this.emit(M.AP_EVENTS.INNER_BROADCAST,i):C.warn("onPSvcBroadcast unhandle yyp uri="+(i.uri>>8&d.default.getUintMax())+"/"+(255&i.uri))}else this.invokeBroadCastCallback(t)}invokeBroadCastCallback(e){const t={appid:e.appid,bcGroup:{groupType:e.groupType.toString(),groupId:e.groupId.toString()},svcName:e.svcName,fnName:e.fnName,protoType:e.protoType,traceId:e.traceId,data:e.data};this.emit(M.AP_EVENTS.BROADCAST,t)}onPSvcBroadcastV2(e){let t=new _.default;t.unmarshall(e);let n=t.ugid;C.log("onPSvcBroadcastV2: "+t.toString()+" bcKey="+n),this.invokeBroadCastV2Callback(t)}invokeBroadCastV2Callback(e){const t={appid:e.appid,bc_group:e.ugid,svcName:e.svcName,fnName:e.fnName,protoType:e.protoType,traceId:e.traceId,data:e.data};this.emit(M.AP_EVENTS.BROADCAST_V2,t)}onAPForceOut(e){let t=new w.default;t.unmarshall(e),C.log("onAPForceOut pkg="+JSON.stringify(t)),this.stop();const n={code:t.code,msg:t.desc};this.emit(M.AP_EVENTS.FORCE_OUT,n)}onTokenExpired(e){e===r.ExpiredTokenException&&(this.emit(M.AP_EVENTS.TOKEN_EXPIRED),this.isTokenOk=!1)}}r.applyMixins(P,[A.Emitter]),t.default=P},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(33);t.encodeStringToUtf8Bytes=function(e){let t=i.length(e),n=new Uint8Array(t);return i.write(e,n,0),n},t.decodeUtf8BytesToString=function(e){return i.read(e,0,e.length)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=new(n(5).Logger)("ProtoLink");t.default=class{constructor(e,t=!1){this.linkHandler=null,this.ws=null,this.connected=!1,this.linkHandler=e,this.bMiniProgram=t}destroy(){this.linkHandler=null,this.reset()}connect(e){this.reset(),this.bMiniProgram?(this.ws=wx.connectSocket({url:e}),wx.onSocketOpen(e=>{i.log("onopen"),this.connected=!0,this.linkHandler&&this.linkHandler.onopen()}),wx.onSocketClose(e=>{i.log("onclose "+JSON.stringify(e)),this.connected=!1,this.ws=null,this.linkHandler&&(this.linkHandler.onclose(),this.linkHandler=null)}),wx.onSocketError(e=>{i.log("onerror event="+JSON.stringify(e)),this.connected=!1,this.ws=null,this.linkHandler&&(this.linkHandler.onerror(e),this.linkHandler=null)}),wx.onSocketMessage(e=>{e.data instanceof ArrayBuffer?this.processArrayBuffer(e.data):this.processText(e.data)})):(this.ws=new WebSocket(e),this.ws.binaryType="arraybuffer",this.ws.onopen=this.onopen.bind(this),this.ws.onerror=this.onerror.bind(this),this.ws.onclose=this.onclose.bind(this),this.ws.onmessage=this.onmessage.bind(this))}reset(){this.ws&&(this.connected=!1,this.bMiniProgram?wx.closeSocket():(this.ws.onopen=null,this.ws.onerror=null,this.ws.onclose=null,this.ws.onmessage=null,this.ws.close()),this.ws=null)}send(e){this.ws&&this.connected&&(this.bMiniProgram?wx.sendSocketMessage({data:e.buffer,fail:function(e){i.error("send wx sendSocketMessage failed err="+JSON.stringify(e))}}):this.ws.readyState===WebSocket.OPEN?this.ws.send(e):i.warn("send fail: readyState="+this.ws.readyState))}onopen(){this.connected=!0,this.linkHandler&&this.linkHandler.onopen()}onerror(e){this.connected=!1,this.ws=null,this.linkHandler&&(this.linkHandler.onerror(e),this.linkHandler=null)}onclose(){this.connected=!1,this.ws=null,this.linkHandler&&(this.linkHandler.onclose(),this.linkHandler=null)}onmessage(e){e.data instanceof ArrayBuffer?this.processArrayBuffer(e.data):this.processText(e.data)}processText(e){i.debug("processText data=",e)}processArrayBuffer(e){let t=new DataView(e),n=0,r=0,o=0;for(;n+10<e.byteLength;){if(r=t.getUint32(n,!0),n+r>e.byteLength||r<10)return void i.error("processArrayBuffer length error pktLen="+r+" bufferLen="+e.byteLength);o=t.getUint32(n+4,!0);let s=new DataView(e,n,r);this.linkHandler&&this.linkHandler.onData(o,s),n+=r}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1),r=n(9),o=n(0);t.APIVersion="APIVersion";t.default=class{constructor(){this.context="",this.uid="0",this.appid=0,this.instId=0,this.svcName="",this.fnName="",this.protoType="",this.data=null,this.dataCRC=0,this.routeArgs=new Map,this.clientHeaders=new Map,this.clientHeaders.set(t.APIVersion,"v2"),this.traceId=""}marshall(){let e=new i.default;e.setUri(r.default.PSvcRouteReqURI),e.pushString(this.context),e.pushUInt64String(this.uid),e.pushUInt32(this.appid),e.pushUInt32(this.instId),e.pushString(this.svcName),e.pushString(this.fnName),e.pushString(this.protoType),"string"==typeof this.data?e.pushString32(this.data):e.pushUint8Array32(this.data),e.pushUInt32(this.dataCRC),e.pushUInt32(this.routeArgs.size);for(let[t,n]of this.routeArgs)e.pushString(t),e.pushUtf8String(n);e.pushUInt32(this.clientHeaders.size);for(let[t,n]of this.clientHeaders)e.pushString(t),e.pushUtf8String(n);return e.pushString(this.traceId),e.marshall()}toString(){return"context="+this.context+" uid="+this.uid+" appid="+this.appid+" instId="+this.instId+" svcName="+this.svcName+" fnName="+this.fnName+" traceId="+this.traceId+" routeArgs="+o.default.stringfyMap(this.routeArgs)+" clientHeaders="+o.default.stringfyMap(this.clientHeaders)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1),r=n(9),o=n(4);t.default=class{constructor(){this.context="",this.uid="0",this.appid=0,this.instId=0,this.seqId=0,this.user="",this.password="",this.otp="",this.clientHeaders=new Map,this.tokenType=0,this.traceId=""}marshall(){let e=new i.default;e.setUri(r.default.PSvcLoginReqURI),e.pushString(this.context);let t=o.fromString(this.uid);e.pushUInt32(t.low),e.pushUInt32(t.high),e.pushUInt32(this.appid),e.pushUInt32(this.instId);let n=o.fromString(this.seqId.toString());e.pushUInt32(n.low),e.pushUInt32(n.high),e.pushString(this.user),e.pushString(this.password),e.pushString(this.otp),e.pushUInt32(this.clientHeaders.size);for(let[t,n]of this.clientHeaders)e.pushString(t),e.pushString(n);return e.pushUInt32(this.tokenType),e.pushString(this.traceId),e.marshall()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e=0,t=0,n=0){this.sid=e,this.appId=t,this.channelId=n}fromString(e){if(this.sid=0,this.appId=0,this.channelId=0,-1!==e.toString().indexOf("-")){let t=e.split("-");return this.sid=parseInt(t[0])||0,this.appId=parseInt(t[1])||0,this.channelId=parseInt(t[2])||0,!0}return!1}toString(){return this.sid+"-"+this.appId+"-"+this.channelId}equal(e){return this.toString()===e.toString()}toBigint(){return 4294967296*this.sid+this.appId}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.context="",this.timestamp=null,this.heartBeatTimeoutSecs=60,this.extension={}}unmarshall(e){this.context=e.popString(),this.timestamp=e.popUInt64(),this.heartBeatTimeoutSecs=e.popUInt32()||60;const t=e.popUInt32();for(let n=0;n<t;n++){let t=e.popString(),n=e.popString();this.extension[t]=n}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1),r=n(9);t.default=class{constructor(){this.context="",this.appid=0,this.extension=new Map}marshall(){let e=new i.default;e.setUri(r.default.PSvcPingURI),e.pushString(this.context),e.pushUInt32(this.appid);let t=this.extension.size;e.pushUInt32(t);for(let[t,n]of this.extension)e.pushString(t.toString()),e.pushString(n.toString());return e.marshall()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1),r=n(9);t.default=class{constructor(){this.context="",this.uid="0",this.appid=0,this.instId=0}marshall(){let e=new i.default;return e.setUri(r.default.PSvcLogoutReqURI),e.pushString(this.context),e.pushUInt64String(this.uid),e.pushUInt32(this.appid),e.pushUInt32(this.instId),e.marshall()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={INIT:"init",CONNECTING:"connecting",CONNECTED:"connected",CLOSING:"closing",CLOSED:"closed"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(5),r=n(18),o=n(0),s=n(67),a=new i.Logger("HiidoUtil");t.default=class{static genUrl(e,t="ystrpc",n="mlog.hiido.com"){let i="https://"+n+"/c.gif?",o=r.default.utc(),a=t+o+"HiidoYYSystem";a=s(a);let u=i+"act="+t+"&time="+o+"&key="+a;for(let[t,n]of e)u+="&"+t+"="+n;return u}static sendUrl(e,t){if(a.debug("sendUrl url:"+e),t){let t=e.indexOf("?"),n=e.slice(0,t),i=e.slice(t+1).split("&"),r=i.length,s={};for(let e=0;e<r;e++)t=i[e].indexOf("="),s[i[e].slice(0,t)]=i[e].slice(t+1);o.default.yFetch({url:n,data:s})}else{(new Image).src=e}}}},function(module,exports,__webpack_require__){(function(process,global){var __WEBPACK_AMD_DEFINE_RESULT__;
/**
 * [js-md5]{@link https://github.com/emn178/js-md5}
 *
 * @namespace md5
 * @version 0.7.3
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */!function(){"use strict";var ERROR="input is invalid type",WINDOW="object"==typeof window,root=WINDOW?window:{};root.JS_MD5_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==typeof self,NODE_JS=!root.JS_MD5_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS?root=global:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_MD5_NO_COMMON_JS&&"object"==typeof module&&module.exports,AMD=__webpack_require__(69),ARRAY_BUFFER=!root.JS_MD5_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[128,32768,8388608,-2147483648],SHIFT=[0,8,16,24],OUTPUT_TYPES=["hex","array","digest","buffer","arrayBuffer","base64"],BASE64_ENCODE_CHAR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),blocks=[],buffer8;if(ARRAY_BUFFER){var buffer=new ArrayBuffer(68);buffer8=new Uint8Array(buffer),blocks=new Uint32Array(buffer)}!root.JS_MD5_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!ARRAY_BUFFER||!root.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});var createOutputMethod=function(e){return function(t){return new Md5(!0).update(t)[e]()}},createMethod=function(){var e=createOutputMethod("hex");NODE_JS&&(e=nodeWrap(e)),e.create=function(){return new Md5},e.update=function(t){return e.create().update(t)};for(var t=0;t<OUTPUT_TYPES.length;++t){var n=OUTPUT_TYPES[t];e[n]=createOutputMethod(n)}return e},nodeWrap=function(method){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),nodeMethod=function(e){if("string"==typeof e)return crypto.createHash("md5").update(e,"utf8").digest("hex");if(null==e)throw ERROR;return e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===Buffer?crypto.createHash("md5").update(new Buffer(e)).digest("hex"):method(e)};return nodeMethod};function Md5(e){if(e)blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks,this.buffer8=buffer8;else if(ARRAY_BUFFER){var t=new ArrayBuffer(68);this.buffer8=new Uint8Array(t),this.blocks=new Uint32Array(t)}else this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Md5.prototype.update=function(e){if(!this.finalized){var t,n=typeof e;if("string"!==n){if("object"!==n)throw ERROR;if(null===e)throw ERROR;if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw ERROR;t=!0}for(var i,r,o=0,s=e.length,a=this.blocks,u=this.buffer8;o<s;){if(this.hashed&&(this.hashed=!1,a[0]=a[16],a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),t)if(ARRAY_BUFFER)for(r=this.start;o<s&&r<64;++o)u[r++]=e[o];else for(r=this.start;o<s&&r<64;++o)a[r>>2]|=e[o]<<SHIFT[3&r++];else if(ARRAY_BUFFER)for(r=this.start;o<s&&r<64;++o)(i=e.charCodeAt(o))<128?u[r++]=i:i<2048?(u[r++]=192|i>>6,u[r++]=128|63&i):i<55296||i>=57344?(u[r++]=224|i>>12,u[r++]=128|i>>6&63,u[r++]=128|63&i):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++o)),u[r++]=240|i>>18,u[r++]=128|i>>12&63,u[r++]=128|i>>6&63,u[r++]=128|63&i);else for(r=this.start;o<s&&r<64;++o)(i=e.charCodeAt(o))<128?a[r>>2]|=i<<SHIFT[3&r++]:i<2048?(a[r>>2]|=(192|i>>6)<<SHIFT[3&r++],a[r>>2]|=(128|63&i)<<SHIFT[3&r++]):i<55296||i>=57344?(a[r>>2]|=(224|i>>12)<<SHIFT[3&r++],a[r>>2]|=(128|i>>6&63)<<SHIFT[3&r++],a[r>>2]|=(128|63&i)<<SHIFT[3&r++]):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++o)),a[r>>2]|=(240|i>>18)<<SHIFT[3&r++],a[r>>2]|=(128|i>>12&63)<<SHIFT[3&r++],a[r>>2]|=(128|i>>6&63)<<SHIFT[3&r++],a[r>>2]|=(128|63&i)<<SHIFT[3&r++]);this.lastByteIndex=r,this.bytes+=r-this.start,r>=64?(this.start=r-64,this.hash(),this.hashed=!0):this.start=r}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Md5.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[t>>2]|=EXTRA[3&t],t>=56&&(this.hashed||this.hash(),e[0]=e[16],e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.bytes<<3,e[15]=this.hBytes<<3|this.bytes>>>29,this.hash()}},Md5.prototype.hash=function(){var e,t,n,i,r,o,s=this.blocks;this.first?t=((t=((e=((e=s[0]-680876937)<<7|e>>>25)-271733879<<0)^(n=((n=(-271733879^(i=((i=(-1732584194^2004318071&e)+s[1]-117830708)<<12|i>>>20)+e<<0)&(-271733879^e))+s[2]-1126478375)<<17|n>>>15)+i<<0)&(i^e))+s[3]-1316259209)<<22|t>>>10)+n<<0:(e=this.h0,t=this.h1,n=this.h2,t=((t+=((e=((e+=((i=this.h3)^t&(n^i))+s[0]-680876936)<<7|e>>>25)+t<<0)^(n=((n+=(t^(i=((i+=(n^e&(t^n))+s[1]-389564586)<<12|i>>>20)+e<<0)&(e^t))+s[2]+606105819)<<17|n>>>15)+i<<0)&(i^e))+s[3]-1044525330)<<22|t>>>10)+n<<0),t=((t+=((e=((e+=(i^t&(n^i))+s[4]-176418897)<<7|e>>>25)+t<<0)^(n=((n+=(t^(i=((i+=(n^e&(t^n))+s[5]+1200080426)<<12|i>>>20)+e<<0)&(e^t))+s[6]-1473231341)<<17|n>>>15)+i<<0)&(i^e))+s[7]-45705983)<<22|t>>>10)+n<<0,t=((t+=((e=((e+=(i^t&(n^i))+s[8]+1770035416)<<7|e>>>25)+t<<0)^(n=((n+=(t^(i=((i+=(n^e&(t^n))+s[9]-1958414417)<<12|i>>>20)+e<<0)&(e^t))+s[10]-42063)<<17|n>>>15)+i<<0)&(i^e))+s[11]-1990404162)<<22|t>>>10)+n<<0,t=((t+=((e=((e+=(i^t&(n^i))+s[12]+1804603682)<<7|e>>>25)+t<<0)^(n=((n+=(t^(i=((i+=(n^e&(t^n))+s[13]-40341101)<<12|i>>>20)+e<<0)&(e^t))+s[14]-1502002290)<<17|n>>>15)+i<<0)&(i^e))+s[15]+1236535329)<<22|t>>>10)+n<<0,t=((t+=((i=((i+=(t^n&((e=((e+=(n^i&(t^n))+s[1]-165796510)<<5|e>>>27)+t<<0)^t))+s[6]-1069501632)<<9|i>>>23)+e<<0)^e&((n=((n+=(e^t&(i^e))+s[11]+643717713)<<14|n>>>18)+i<<0)^i))+s[0]-373897302)<<20|t>>>12)+n<<0,t=((t+=((i=((i+=(t^n&((e=((e+=(n^i&(t^n))+s[5]-701558691)<<5|e>>>27)+t<<0)^t))+s[10]+38016083)<<9|i>>>23)+e<<0)^e&((n=((n+=(e^t&(i^e))+s[15]-660478335)<<14|n>>>18)+i<<0)^i))+s[4]-405537848)<<20|t>>>12)+n<<0,t=((t+=((i=((i+=(t^n&((e=((e+=(n^i&(t^n))+s[9]+568446438)<<5|e>>>27)+t<<0)^t))+s[14]-1019803690)<<9|i>>>23)+e<<0)^e&((n=((n+=(e^t&(i^e))+s[3]-187363961)<<14|n>>>18)+i<<0)^i))+s[8]+1163531501)<<20|t>>>12)+n<<0,t=((t+=((i=((i+=(t^n&((e=((e+=(n^i&(t^n))+s[13]-1444681467)<<5|e>>>27)+t<<0)^t))+s[2]-51403784)<<9|i>>>23)+e<<0)^e&((n=((n+=(e^t&(i^e))+s[7]+1735328473)<<14|n>>>18)+i<<0)^i))+s[12]-1926607734)<<20|t>>>12)+n<<0,t=((t+=((o=(i=((i+=((r=t^n)^(e=((e+=(r^i)+s[5]-378558)<<4|e>>>28)+t<<0))+s[8]-2022574463)<<11|i>>>21)+e<<0)^e)^(n=((n+=(o^t)+s[11]+1839030562)<<16|n>>>16)+i<<0))+s[14]-35309556)<<23|t>>>9)+n<<0,t=((t+=((o=(i=((i+=((r=t^n)^(e=((e+=(r^i)+s[1]-1530992060)<<4|e>>>28)+t<<0))+s[4]+1272893353)<<11|i>>>21)+e<<0)^e)^(n=((n+=(o^t)+s[7]-155497632)<<16|n>>>16)+i<<0))+s[10]-1094730640)<<23|t>>>9)+n<<0,t=((t+=((o=(i=((i+=((r=t^n)^(e=((e+=(r^i)+s[13]+681279174)<<4|e>>>28)+t<<0))+s[0]-358537222)<<11|i>>>21)+e<<0)^e)^(n=((n+=(o^t)+s[3]-722521979)<<16|n>>>16)+i<<0))+s[6]+76029189)<<23|t>>>9)+n<<0,t=((t+=((o=(i=((i+=((r=t^n)^(e=((e+=(r^i)+s[9]-640364487)<<4|e>>>28)+t<<0))+s[12]-421815835)<<11|i>>>21)+e<<0)^e)^(n=((n+=(o^t)+s[15]+530742520)<<16|n>>>16)+i<<0))+s[2]-995338651)<<23|t>>>9)+n<<0,t=((t+=((i=((i+=(t^((e=((e+=(n^(t|~i))+s[0]-198630844)<<6|e>>>26)+t<<0)|~n))+s[7]+1126891415)<<10|i>>>22)+e<<0)^((n=((n+=(e^(i|~t))+s[14]-1416354905)<<15|n>>>17)+i<<0)|~e))+s[5]-57434055)<<21|t>>>11)+n<<0,t=((t+=((i=((i+=(t^((e=((e+=(n^(t|~i))+s[12]+1700485571)<<6|e>>>26)+t<<0)|~n))+s[3]-1894986606)<<10|i>>>22)+e<<0)^((n=((n+=(e^(i|~t))+s[10]-1051523)<<15|n>>>17)+i<<0)|~e))+s[1]-2054922799)<<21|t>>>11)+n<<0,t=((t+=((i=((i+=(t^((e=((e+=(n^(t|~i))+s[8]+1873313359)<<6|e>>>26)+t<<0)|~n))+s[15]-30611744)<<10|i>>>22)+e<<0)^((n=((n+=(e^(i|~t))+s[6]-1560198380)<<15|n>>>17)+i<<0)|~e))+s[13]+1309151649)<<21|t>>>11)+n<<0,t=((t+=((i=((i+=(t^((e=((e+=(n^(t|~i))+s[4]-145523070)<<6|e>>>26)+t<<0)|~n))+s[11]-1120210379)<<10|i>>>22)+e<<0)^((n=((n+=(e^(i|~t))+s[2]+718787259)<<15|n>>>17)+i<<0)|~e))+s[9]-343485551)<<21|t>>>11)+n<<0,this.first?(this.h0=e+1732584193<<0,this.h1=t-271733879<<0,this.h2=n-1732584194<<0,this.h3=i+271733878<<0,this.first=!1):(this.h0=this.h0+e<<0,this.h1=this.h1+t<<0,this.h2=this.h2+n<<0,this.h3=this.h3+i<<0)},Md5.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,i=this.h3;return HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[15&n]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[15&i]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]},Md5.prototype.toString=Md5.prototype.hex,Md5.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,i=this.h3;return[255&e,e>>8&255,e>>16&255,e>>24&255,255&t,t>>8&255,t>>16&255,t>>24&255,255&n,n>>8&255,n>>16&255,n>>24&255,255&i,i>>8&255,i>>16&255,i>>24&255]},Md5.prototype.array=Md5.prototype.digest,Md5.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(16),t=new Uint32Array(e);return t[0]=this.h0,t[1]=this.h1,t[2]=this.h2,t[3]=this.h3,e},Md5.prototype.buffer=Md5.prototype.arrayBuffer,Md5.prototype.base64=function(){for(var e,t,n,i="",r=this.array(),o=0;o<15;)e=r[o++],t=r[o++],n=r[o++],i+=BASE64_ENCODE_CHAR[e>>>2]+BASE64_ENCODE_CHAR[63&(e<<4|t>>>4)]+BASE64_ENCODE_CHAR[63&(t<<2|n>>>6)]+BASE64_ENCODE_CHAR[63&n];return e=r[o],i+=BASE64_ENCODE_CHAR[e>>>2]+BASE64_ENCODE_CHAR[e<<4&63]+"=="};var exports=createMethod();COMMON_JS?module.exports=exports:(root.md5=exports,AMD&&(__WEBPACK_AMD_DEFINE_RESULT__=function(){return exports}.call(exports,__webpack_require__,exports,module),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)))}()}).call(this,__webpack_require__(68),__webpack_require__(14))},function(e,t){var n,i,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var u,l=[],c=!1,d=-1;function h(){c&&u&&(c=!1,u.length?l=u.concat(l):d=-1,l.length&&p())}function p(){if(!c){var e=a(h);c=!0;for(var t=l.length;t;){for(u=l,l=[];++d<t;)u&&u[d].run();d=-1,t=l.length}u=null,c=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function g(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new f(e,t)),1!==l.length||c||a(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{static report(e,t,i,r,o,s){if(0===e)return;if("undefined"==typeof window)return;let a=n(71);a.Metrics&&(a.Metrics.setOptions({isOversea:!0}),a.Metrics.serviceReport({scode:e,ver:"1.0.0",uri:t+"|"+i+"|"+r,timeSpent:o,code:s}))}}},function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"report",(function(){return ae})),n.d(t,"Metrics",(function(){return ue})),n.d(t,"oldMetrics",(function(){return le})),n.d(t,"setSiteId",(function(){return ce})),n.d(t,"setSpeId",(function(){return de}));var i="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};function r(e,t){return e(t={exports:{}},t.exports),t.exports}var o=r((function(e){!function(t){function n(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function i(e,t,i,r,o,s){return n((a=n(n(t,e),n(r,s)))<<(u=o)|a>>>32-u,i);var a,u}function r(e,t,n,r,o,s,a){return i(t&n|~t&r,e,t,o,s,a)}function o(e,t,n,r,o,s,a){return i(t&r|n&~r,e,t,o,s,a)}function s(e,t,n,r,o,s,a){return i(t^n^r,e,t,o,s,a)}function a(e,t,n,r,o,s,a){return i(n^(t|~r),e,t,o,s,a)}function u(e,t){var i,u,l,c,d;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var h=1732584193,p=-271733879,f=-1732584194,g=271733878;for(i=0;i<e.length;i+=16)u=h,l=p,c=f,d=g,p=a(p=a(p=a(p=a(p=s(p=s(p=s(p=s(p=o(p=o(p=o(p=o(p=r(p=r(p=r(p=r(p,f=r(f,g=r(g,h=r(h,p,f,g,e[i],7,-680876936),p,f,e[i+1],12,-389564586),h,p,e[i+2],17,606105819),g,h,e[i+3],22,-1044525330),f=r(f,g=r(g,h=r(h,p,f,g,e[i+4],7,-176418897),p,f,e[i+5],12,1200080426),h,p,e[i+6],17,-1473231341),g,h,e[i+7],22,-45705983),f=r(f,g=r(g,h=r(h,p,f,g,e[i+8],7,1770035416),p,f,e[i+9],12,-1958414417),h,p,e[i+10],17,-42063),g,h,e[i+11],22,-1990404162),f=r(f,g=r(g,h=r(h,p,f,g,e[i+12],7,1804603682),p,f,e[i+13],12,-40341101),h,p,e[i+14],17,-1502002290),g,h,e[i+15],22,1236535329),f=o(f,g=o(g,h=o(h,p,f,g,e[i+1],5,-165796510),p,f,e[i+6],9,-1069501632),h,p,e[i+11],14,643717713),g,h,e[i],20,-373897302),f=o(f,g=o(g,h=o(h,p,f,g,e[i+5],5,-701558691),p,f,e[i+10],9,38016083),h,p,e[i+15],14,-660478335),g,h,e[i+4],20,-405537848),f=o(f,g=o(g,h=o(h,p,f,g,e[i+9],5,568446438),p,f,e[i+14],9,-1019803690),h,p,e[i+3],14,-187363961),g,h,e[i+8],20,1163531501),f=o(f,g=o(g,h=o(h,p,f,g,e[i+13],5,-1444681467),p,f,e[i+2],9,-51403784),h,p,e[i+7],14,1735328473),g,h,e[i+12],20,-1926607734),f=s(f,g=s(g,h=s(h,p,f,g,e[i+5],4,-378558),p,f,e[i+8],11,-2022574463),h,p,e[i+11],16,1839030562),g,h,e[i+14],23,-35309556),f=s(f,g=s(g,h=s(h,p,f,g,e[i+1],4,-1530992060),p,f,e[i+4],11,1272893353),h,p,e[i+7],16,-155497632),g,h,e[i+10],23,-1094730640),f=s(f,g=s(g,h=s(h,p,f,g,e[i+13],4,681279174),p,f,e[i],11,-358537222),h,p,e[i+3],16,-722521979),g,h,e[i+6],23,76029189),f=s(f,g=s(g,h=s(h,p,f,g,e[i+9],4,-640364487),p,f,e[i+12],11,-421815835),h,p,e[i+15],16,530742520),g,h,e[i+2],23,-995338651),f=a(f,g=a(g,h=a(h,p,f,g,e[i],6,-198630844),p,f,e[i+7],10,1126891415),h,p,e[i+14],15,-1416354905),g,h,e[i+5],21,-57434055),f=a(f,g=a(g,h=a(h,p,f,g,e[i+12],6,1700485571),p,f,e[i+3],10,-1894986606),h,p,e[i+10],15,-1051523),g,h,e[i+1],21,-2054922799),f=a(f,g=a(g,h=a(h,p,f,g,e[i+8],6,1873313359),p,f,e[i+15],10,-30611744),h,p,e[i+6],15,-1560198380),g,h,e[i+13],21,1309151649),f=a(f,g=a(g,h=a(h,p,f,g,e[i+4],6,-145523070),p,f,e[i+11],10,-1120210379),h,p,e[i+2],15,718787259),g,h,e[i+9],21,-343485551),h=n(h,u),p=n(p,l),f=n(f,c),g=n(g,d);return[h,p,f,g]}function l(e){var t,n="",i=32*e.length;for(t=0;t<i;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function c(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;var i=8*e.length;for(t=0;t<i;t+=8)n[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return n}function d(e){var t,n,i="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),i+="0123456789abcdef".charAt(t>>>4&15)+"0123456789abcdef".charAt(15&t);return i}function h(e){return unescape(encodeURIComponent(e))}function p(e){return function(e){return l(u(c(e),8*e.length))}(h(e))}function f(e,t){return function(e,t){var n,i,r=c(e),o=[],s=[];for(o[15]=s[15]=void 0,r.length>16&&(r=u(r,8*e.length)),n=0;n<16;n+=1)o[n]=909522486^r[n],s[n]=1549556828^r[n];return i=u(o.concat(c(t)),512+8*t.length),l(u(s.concat(i),640))}(h(e),h(t))}function g(e,t,n){return t?n?f(t,e):d(f(t,e)):n?p(e):d(p(e))}e.exports?e.exports=g:t.md5=g}(i)})),s=1,a=2,u=["ubuntu","centos","fedora","debian","gentoo","suse","mandriva","slackware","freebsd","archlinux"],l=/(?:Version|Blackberry[\w]+)\/(\d\.\d)/i,c=/symbian(?:os)?\/(\d+[.\d]{0,2})/i,d=/tizen (\d+\.\d+)/i,h=[{engine:"baidu.com",rule:"wd|word|w|kw|key",value:1},{engine:"haosou.com",rule:"q",value:2},{engine:"sogou.com",rule:"query",value:3},{engine:"google.",rule:"q",value:4},{engine:"bing.com",rule:"q",value:5},{engine:"yahoo.com",rule:"p|q",value:6},{engine:"youdao.com",rule:"q",value:7},{engine:"yodao.com",rule:"q",value:8},{engine:"iask.sina.com.cn",rule:"searchWord|k",value:9},{engine:"zhongsou.com",rule:"w|word",value:10},{engine:"search.com",rule:"q",value:11},{engine:"sm.cn",rule:"q",value:12},{engine:"chinaso.com",rule:"q",value:13},{engine:"soku.com",rule:"keyword",value:14},{engine:"alexa.com",rule:"q",value:15},{engine:"s.weibo.com",rule:function(e){return e.split("&")[0].split("/").pop()},value:16},{engine:"qq.com",rule:"k",value:17},{engine:"lofter.com",rule:function(e){var t;return e.indexOf("queryString")>-1&&null!==(t=new RegExp("(^|)queryString=([^&]*)(&|$)","gi").exec(e))?t[2]:e.split("?")[0].split("/").pop()},value:18}],p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f={name:"na",version:"-1"};function g(e){return function(t){return Object.prototype.toString.call(t)==="[object "+e+"]"}}var m=g("String"),y=g("RegExp"),b=g("Object"),v=g("Function");function I(e,t,n,i){var r=f;(function(e,t){for(var n=0,i=e.length;n<i&&!1!==t.call(e,e[n],n);n++);})(t,(function(t){var n=function(e,t,n){var i=v(t)?t.call(null,n):t;if(!i)return null;var r={name:e,version:"-1",codename:""};if(!0===i)return r;if(m(i)){if(-1!==n.indexOf(i))return r}else{if(b(i))return i.hasOwnProperty("version")&&(r.version=i.version),r;if(y(i)){var o=i.exec(n);if(o)return o.length>=2&&o[1]?r.version=o[1].replace(/_/g,"."):r.version="-1",r}}}(t[0],t[1],e);if(n)return r=n,!1})),n.call(i,r.name,r.version)}var S=function(){function e(t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._rules=t}return e.prototype.parse=function(e){var t={};I(e=(e||"").toLowerCase(),this._rules.device,(function(e,n){var i=parseFloat(n);t.device={name:e,version:i,fullVersion:n},t.device[e]=i}),t),I(e,this._rules.os,(function(e,n){var i=parseFloat(n);t.os={name:e,version:i,fullVersion:n},t.os[e]=i}),t);var n=this.IEMode(e);return I(e,this._rules.engine,(function(e,i){var r=i;n&&(i=n.engineVersion||n.engineMode,r=n.engineMode);var o=parseFloat(i);t.engine={name:e,version:o,fullVersion:i,mode:parseFloat(r),fullMode:r,compatible:!!n&&n.compatible},t.engine[e]=o}),t),I(e,this._rules.browser,(function(e,i){var r=i;n&&("ie"===e&&(i=n.browserVersion),r=n.browserMode);var o=parseFloat(i);t.browser={name:e,version:o,fullVersion:i,mode:parseFloat(r),fullMode:r,compatible:!!n&&n.compatible},t.browser[e]=o}),t),t},e.prototype.IEMode=function(e){if(!this._rules.re_msie.test(e))return null;var t,n,i=void 0,r=void 0,o=void 0;if(-1!==e.indexOf("trident/")&&(i=/\btrident\/([0-9.]+)/.exec(e))&&i.length>=2){r=i[1];var s=i[1].split(".");s[0]=parseInt(s[0],10)+4,o=s.join(".")}n=(i=this._rules.re_msie.exec(e))[1];var a=i[1].split(".");return void 0===o&&(o=n),a[0]=parseInt(a[0],10)-4,t=a.join("."),void 0===r&&(r=t),{browserVersion:o,browserMode:n,engineVersion:r,engineMode:t,compatible:r!==t}},e}(),w="undefined"==typeof window?i:window,_=w.external,O=/\b(?:msie |ie |trident\/[0-9].*rv[ :])([0-9.]+)/,U=/\bbb10\b.+?\bversion\/([\d.]+)/,k=/\bblackberry\b.+\bversion\/([\d.]+)/,T=/\bblackberry\d+\/([\d.]+)/;function R(e){if(_)try{var t=_.twGetRunPath.toLowerCase(),n=_.twGetSecurityID(w),i=_.twGetVersion(n);if(t&&-1===t.indexOf(e))return!1;if(i)return{version:i}}catch(e){}}var E={device:[["nokia",function(e){return-1!==e.indexOf("nokia ")?/\bnokia ([0-9]+)?/:/\bnokia([a-z0-9]+)?/}],["samsung",function(e){return-1!==e.indexOf("samsung")?/\bsamsung(?:[ \-](?:sgh|gt|sm))?-([a-z0-9]+)/:/\b(?:sgh|sch|gt|sm)-([a-z0-9]+)/}],["wp",function(e){return-1!==e.indexOf("windows phone ")||-1!==e.indexOf("xblwp")||-1!==e.indexOf("zunewp")||-1!==e.indexOf("windows ce")}],["pc","windows"],["ipad","ipad"],["ipod","ipod"],["iphone",/\biphone\b|\biph(\d)/],["mac","macintosh"],["mi",/\bmi[ \-]?([a-z0-9 ]+(?= build|\)))/],["hongmi",/\bhm[ \-]?([a-z0-9]+)/],["aliyun",/\baliyunos\b(?:[\-](\d+))?/],["meizu",function(e){return e.indexOf("meizu")>=0?/\bmeizu[\/ ]([a-z0-9]+)\b/:/\bm([0-9cx]{1,4})\b/}],["nexus",/\bnexus ([0-9s.]+)/],["huawei",function(e){var t=/\bmediapad (.+?)(?= build\/huaweimediapad\b)/;return-1!==e.indexOf("huawei-huawei")?/\bhuawei\-huawei\-([a-z0-9\-]+)/:t.test(e)?t:/\bhuawei[ _\-]?([a-z0-9]+)/}],["lenovo",function(e){return-1!==e.indexOf("lenovo-lenovo")?/\blenovo\-lenovo[ \-]([a-z0-9]+)/:/\blenovo[ \-]?([a-z0-9]+)/}],["zte",function(e){return/\bzte\-[tu]/.test(e)?/\bzte-[tu][ _\-]?([a-su-z0-9\+]+)/:/\bzte[ _\-]?([a-su-z0-9\+]+)/}],["vivo",/\bvivo(?: ([a-z0-9]+))?/],["htc",function(e){return/\bhtc[a-z0-9 _\-]+(?= build\b)/.test(e)?/\bhtc[ _\-]?([a-z0-9 ]+(?= build))/:/\bhtc[ _\-]?([a-z0-9 ]+)/}],["oppo",/\boppo[_]([a-z0-9]+)/],["konka",/\bkonka[_\-]([a-z0-9]+)/],["sonyericsson",/\bmt([a-z0-9]+)/],["coolpad",/\bcoolpad[_ ]?([a-z0-9]+)/],["lg",/\blg[\-]([a-z0-9]+)/],["android",/\bandroid\b|\badr\b/],["blackberry",function(e){return e.indexOf("blackberry")>=0?/\bblackberry\s?(\d+)/:"bb10"}]],os:[["wp",function(e){return-1!==e.indexOf("windows phone ")?/\bwindows phone (?:os )?([0-9.]+)/:-1!==e.indexOf("xblwp")?/\bxblwp([0-9.]+)/:-1!==e.indexOf("zunewp")?/\bzunewp([0-9.]+)/:"windows phone"}],["windows",/\bwindows nt ([0-9.]+)/],["macosx",/\bmac os x ([0-9._]+)/],["ios",function(e){return/\bcpu(?: iphone)? os /.test(e)?/\bcpu(?: iphone)? os ([0-9._]+)/:-1!==e.indexOf("iph os ")?/\biph os ([0-9_]+)/:/\bios\b/}],["yunos",/\baliyunos ([0-9.]+)/],["android",function(e){return e.indexOf("android")>=0?/\bandroid[ \/-]?([0-9.x]+)?/:e.indexOf("adr")>=0?e.indexOf("mqqbrowser")>=0?/\badr[ ]\(linux; u; ([0-9.]+)?/:/\badr(?:[ ]([0-9.]+))?/:"android"}],["chromeos",/\bcros i686 ([0-9.]+)/],["linux","linux"],["windowsce",/\bwindows ce(?: ([0-9.]+))?/],["symbian",/\bsymbian(?:os)?\/([0-9.]+)/],["blackberry",function(e){var t=e.match(U)||e.match(k)||e.match(T);return t?{version:t[1]}:"blackberry"}]],browser:[["edge",/edge\/([0-9.]+)/],["sogou",function(e){return e.indexOf("sogoumobilebrowser")>=0?/sogoumobilebrowser\/([0-9.]+)/:e.indexOf("sogoumse")>=0||/ se ([0-9.x]+)/}],["theworld",function(){var e=R("theworld");return void 0!==e?e:/theworld(?: ([\d.])+)?/}],["360",function(e){var t=R("360se");return void 0!==t?t:-1!==e.indexOf("360 aphone browser")?/\b360 aphone browser \(([^\)]+)\)/:/\b360(?:se|ee|chrome|browser)\b/}],["maxthon",function(){try{if(_&&(_.mxVersion||_.max_version))return{version:_.mxVersion||_.max_version}}catch(e){}return/\b(?:maxthon|mxbrowser)(?:[ \/]([0-9.]+))?/}],["micromessenger",/\bmicromessenger\/([\d.]+)/],["qq",/\bm?qqbrowser\/([0-9.]+)/],["green","greenbrowser"],["tt",/\btencenttraveler ([0-9.]+)/],["liebao",function(e){if(e.indexOf("liebaofast")>=0)return/\bliebaofast\/([0-9.]+)/;if(-1===e.indexOf("lbbrowser"))return!1;var t=void 0;try{_&&_.LiebaoGetVersion&&(t=_.LiebaoGetVersion())}catch(e){}return{version:t||"-1"}}],["tao",/\btaobrowser\/([0-9.]+)/],["coolnovo",/\bcoolnovo\/([0-9.]+)/],["saayaa","saayaa"],["baidu",/\b(?:ba?idubrowser|baiduhd)[ \/]([0-9.x]+)/],["ie",O],["mi",/\bmiuibrowser\/([0-9.]+)/],["opera",function(e){var t=/\bopera.+version\/([0-9.ab]+)/;return t.test(e)?t:/\bopr\/([0-9.]+)/}],["oupeng",/\boupeng\/([0-9.]+)/],["yandex",/yabrowser\/([0-9.]+)/],["ali-ap",function(e){return e.indexOf("aliapp")>0?/\baliapp\(ap\/([0-9.]+)\)/:/\balipayclient\/([0-9.]+)\b/}],["ali-ap-pd",/\baliapp\(ap-pd\/([0-9.]+)\)/],["ali-am",/\baliapp\(am\/([0-9.]+)\)/],["ali-tb",/\baliapp\(tb\/([0-9.]+)\)/],["ali-tb-pd",/\baliapp\(tb-pd\/([0-9.]+)\)/],["ali-tm",/\baliapp\(tm\/([0-9.]+)\)/],["ali-tm-pd",/\baliapp\(tm-pd\/([0-9.]+)\)/],["uc",function(e){return e.indexOf("ucbrowser/")>=0?/\bucbrowser\/([0-9.]+)/:e.indexOf("ubrowser/")>=0?/\bubrowser\/([0-9.]+)/:/\buc\/[0-9]/.test(e)?/\buc\/([0-9.]+)/:e.indexOf("ucweb")>=0?/\bucweb([0-9.]+)?/:/\b(?:ucbrowser|uc)\b/}],["chrome",/ (?:chrome|crios|crmo)\/([0-9.]+)/],["android",function(e){if(-1!==e.indexOf("android"))return/\bversion\/([0-9.]+(?: beta)?)/}],["blackberry",function(e){var t=e.match(U)||e.match(k)||e.match(T);return t?{version:t[1]}:"blackberry"}],["safari",/\bversion\/([0-9.]+(?: beta)?)(?: mobile(?:\/[a-z0-9]+)?)? safari\//],["webview",/\bcpu(?: iphone)? os (?:[0-9._]+).+\bapplewebkit\b/],["firefox",/\bfirefox\/([0-9.ab]+)/],["nokia",/\bnokiabrowser\/([0-9.]+)/]],engine:[["edgehtml",/edge\/([0-9.]+)/],["trident",O],["blink",function(){return"chrome"in w&&"CSS"in w&&/\bapplewebkit[\/]?([0-9.+]+)/}],["webkit",/\bapplewebkit[\/]?([0-9.+]+)/],["gecko",function(e){var t=e.match(/\brv:([\d\w.]+).*\bgecko\/(\d+)/);if(t)return{version:t[1]+"."+t[2]}}],["presto",/\bpresto\/([0-9.]+)/],["androidwebkit",/\bandroidwebkit\/([0-9.]+)/],["coolpadwebkit",/\bcoolpadwebkit\/([0-9.]+)/],["u2",/\bu2\/([0-9.]+)/],["u3",/\bu3\/([0-9.]+)/]],re_msie:O},x=(navigator.userAgent||"")+" "+(navigator.appVersion||"")+" "+(navigator.vendor||""),A=new S(E);function M(e){var t=A.parse(e),n=function(e){if(!E.re_msie.test(e))return null;var t,n,i=void 0,r=void 0,o=void 0;if(-1!==e.indexOf("trident/")&&(i=/\btrident\/([0-9.]+)/.exec(e))&&i.length>=2){r=i[1];var s=i[1].split(".");s[0]=parseInt(s[0],10)+4,o=s.join(".")}n=(i=E.re_msie.exec(e))[1];var a=i[1].split(".");return void 0===o&&(o=n),a[0]=parseInt(a[0],10)-4,t=a.join("."),void 0===r&&(r=t),{browserVersion:o,browserMode:n,engineVersion:r,engineMode:t,compatible:r!==t}}(e);if(n){var i=t.engine.name,r=n.engineVersion||n.engineMode,o=parseFloat(r),s=n.engineMode;t.engine={name:i,version:o,fullVersion:r,mode:parseFloat(s),fullMode:s,compatible:!!n&&n.compatible},t.engine[t.engine.name]=o;var a=t.browser.name,u=t.browser.fullVersion;"ie"===a&&(u=n.browserVersion);var l=n.browserMode,c=parseFloat(u);t.browser={name:a,version:c,fullVersion:u,mode:parseFloat(l),fullMode:l,compatible:!!n&&n.compatible},t.browser[a]=c}return t}var N=M(x);N.parse=M;var C=N,P={"":"gionee","":"daxian","":"tianyu"},q=[{name:"blackberry",regex:/playbook/},{name:"philips",regex:/philips/},{name:"nec",regex:/nec/},{name:"palm",regex:/palm/},{name:"benq",regex:/benq/},{name:"taixin",regex:/telson/},{name:"cect",regex:/cect/},{name:"dbtel",regex:/dbtel/},{name:"konka",regex:/konka/},{name:"changhong",regex:/changhong/},{name:"wanlida",regex:/malata/},{name:"pantech",regex:/pantech/},{name:"dongxin",regex:/eastcom/},{name:"duowei",regex:/doov/},{name:"koobee",regex:/koobee/},{name:"alcatel",regex:/alcatel/},{name:"bird",regex:/bird/}];function B(e){var t,n=C.parse(e).os,i=n.name,r=n.fullVersion;if("windows"===i){if(e.indexOf("wpdesktop")>-1)return"wp|";i="win",e.indexOf("windows nt 5.0")>-1||e.indexOf("windows nt 5.01")>-1||e.indexOf("windows 2000")>-1?r="2000":e.indexOf("windows nt 5.1")>-1||e.indexOf("windows xp")>-1?r="xp":e.indexOf("windows nt 5.2")>-1||e.indexOf("windows 2003")>-1?r="2003":e.indexOf("windows nt 6.0")>-1||e.indexOf("windows vista")>-1?r="vista":e.indexOf("windows nt 6.1")>-1||e.indexOf("windows 2008")>-1||e.indexOf("windows 7")>-1?r="7":e.indexOf("windows nt 6.2")>-1||e.indexOf("windows 8")>-1?r="8.0":e.indexOf("windows nt 6.3")>-1?r="8.1":e.indexOf("windows nt 10.0")>-1&&(r="10.0")}else if("linux"===i){for(var o=u,s=o.length,a=0;a<s;a++)if(e.indexOf(o[a])>-1){r=o[a];break}}else"blackberry"===i&&"-1"===r?(t=e.match(l))&&(r=t[1]):"symbian"===i&&"3"===r&&(r="^3");return/tizen/.test(e)&&(i="tizen",(t=e.match(d))&&(r=t[1])),"chromeos"===i&&(i="cros"),"na"===i&&(/symbian|symbos|series\s?60|series40|syb-[0-9]+|s60/.test(e)&&(i="symbian",(t=e.match(c))&&(r="3"===t[1]?"^3":t[1])),/blackberry|bb10|rim tablet os/.test(e)&&(i="blackberry",(t=e.match(l))&&(r=t[1])),/hisense/.test(e)&&(i="android")),r&&(r="-1"===r?"":(r=r.split(".")).length>1?r[0]+"."+r[1]:r[0]),i+"|"+r}function j(e){if(/baiduboxapp/.test(e))return"baidubox";if(/spark/.test(e))return"baiduspark";if(/qiyu/.test(e))return"qiyu";if(/yunhai/.test(e))return"yunhai";if(/yy/.test(e))return"yy";if(/myie/.test(e))return"mayi";if(/11[45]{1}browser/.test(e))return"115";if(/2345/.test(e))return"2345";var t=C.parse(e).browser,n=t.name,i=t.fullVersion;if("ie"===n)switch(i){case"6.0":n="ie6";break;case"7.0":n="ie7";break;case"8.0":n="ie8";break;case"9.0":n="ie9";break;case"10.0":n="ie10";break;case"11.0":n="ie11";break;case"12.0":n="ie12"}return"micromessenger"===n&&(n="wechat"),"tao"===n&&(n="taobao"),"oupeng"===n&&(n="opera"),n.indexOf("dolfin")>-1&&(n="dolphin"),(n.indexOf("ie")>-1||"android"===n)&&/2345/.test(e)&&(n="2345"),"na"===n&&(/android/.test(e)?n="android":/yandex/.test(e)&&(n="yandex")),n}function L(e){var t,n,i=C.parse(e).device,r=q.length;if("pc"===i.name||"mac"===i.name)return"";if("hongmi"===i.name)return"mi";if(/\bhonor/.test(e)||/\b(h\d+-l\d+)/.test(e))return"huawei";if(/\bsmartisan\b/.test(e)||/sm-?(\d{3,})/.test(e))return"smartisan";if(/\ba0001 build/.test(e))return"oneplus";if(/hisense/.test(e))return"hisense";if(/\bmot[-]([a-z0-9]+)/.test(e)||/ (xt\d+) build/.test(e))return"moto";if(P[i.name])return P[i.name];if("na"===i.name){for(t=0;t<r;t++)if((n=q[t]).regex.test(e))return n.name;return""}return i.name}function D(e){var t=function(e){return/mobile|phone|wpdesktop|windows ce|android|iphone|ipad|ipod|blackberry|bb10|rim tablet os|webos|opera|symbian|symbos|series60|series40|syb-[0-9]+|s60|palm|tizen|xblwp7|zunewp7|yunos|ucweb|midp|mqq|htc|nokia|samsung/i.test(e)?a:s}(e=e.toLowerCase());return{pcmb:t,os:B(e),bs:j(e),mb:L(e)}}function G(e){var t=("; "+document.cookie).split("; "+e+"=");return 1===t.length?"":decodeURIComponent(t[1].split(";")[0])}function H(e,t,n){n=n||{};var i=e+"="+encodeURIComponent(t);if(n.expires&&"number"==typeof n.expires){var r=new Date;n.expires=1e3*n.expires*60*60*24,i=i+"; expires="+(r=new Date(r.getTime()+n.expires)).toUTCString()}i=i+"; path="+(n.path?n.path:"/"),i+=n.domain?"; domain="+n.domain:"",document.cookie=i}function V(e){var t,n=e||window._hiido_wid,i=Object.prototype.toString;if(n)if("[object Array]"===i.call(n))t=n.join("|");else if("function"==typeof n)try{t=n.call(window),"[object Array]"===i.call(t)&&(t=t.join("|"))}catch(e){window.console.log("[HiidoJS]: _hiido_wid !"),window.console.dir(e),t=""}return t||""}function F(){try{return navigator.javaEnabled()?1:0}catch(e){return 0}}function J(e){var t=-1;try{t=e.GetVariable("$version")}catch(e){}return t}function $(e){var t=-1;try{t=new ActiveXObject(e)}catch(e){t={activeXError:!0}}return t}function K(){var e=[{name:"ShockwaveFlash.ShockwaveFlash.7",version:function(e){return J(e)}},{name:"ShockwaveFlash.ShockwaveFlash.6",version:function(e){var t="6,0,21";try{e.AllowScriptAccess="always",t=J(e)}catch(e){}return t}},{name:"ShockwaveFlash.ShockwaveFlash",version:function(e){return J(e)}}],t=-1,n=navigator;try{if(n.plugins){for(var i=0;i<n.plugins.length;i++)if(n.plugins[i].name.indexOf("Shockwave Flash")>-1){(t=n.plugins[i].description.split("Shockwave Flash ")).length>1?(t=t[1])&&(t=t.split(".")[0]):t=t[0];break}}else if(window.ActiveXObject)for(var r=0;r<e.length&&-1===t;r++){var o=$(e[r].name);o.activeXError||-1!==(t=e[r].version(o))&&(t=t.split(",")[0].split(" ")[1])}}catch(e){}return t}var z=[{domain:"duowan.com",key:"duowan"},{domain:"yy.com",key:"yy"},{domain:"yy.tv",key:"yytv"},{domain:"kuaikuai.cn",key:"kuaikuai"},{domain:"hiido.com",key:"hiido"},{domain:"hiido.cn",key:"hiidocn"},{domain:"hiido.net",key:"hiidonet"},{domain:"bengou.com",key:"bengou"},{domain:"5253.com",key:"5253"},{domain:"duowan.cn",key:"duowancn"},{domain:"zzvv.com",key:"zzvv"},{domain:"99d.com",key:"99d"},{domain:"sc2.com.cn",key:"sc2"},{domain:"100.com",key:"100"},{domain:"5153.com",key:"5153"},{domain:"huya.com",key:"huya"},{domain:"1931.com",key:"1931"},{domain:"fengkaobiguo.com",key:"fengkaobiguo"},{domain:"up24.com",key:"up24"},{domain:"edu24ol.com",key:"edu24ol"},{domain:"ruixueys.com",key:"ruixueys"},{domain:"hqgwy.cn",key:"hqgwy"},{domain:"erdmusic.com",key:"erdmusic"},{domain:"zhiniu8.com",key:"zhiniu8"},{domain:"100yy.com",key:"100yy"},{domain:"dwmoniqi.com",key:"dwmoniqi"},{domain:"bigo.tv",key:"bigotv"},{domain:"bigo.sg",key:"bigosg"},{domain:"like.video",key:"bigolike"},{domain:"mcpemaster.com",key:"mcpemaster"},{domain:"cubetv.sg",key:"cubetvsg"}];function W(e){this.name="HiidoJSError",this.message="[HiidoJS]: "+e||!1}function X(){var e=function(){var e,t,n=document.getElementById("_hiido_script_id_")||document.currentScript||(t=document.getElementsByTagName("script"))[t.length-1];if(!n||!n.src)throw new W("Cannot find Script!");if((e=n.src.split("?")).length>1){for(var i=e[1].split("&"),r={},o=0;o<i.length;o++){var s=i[o].split("=");r[s[0]]=s[1]}return r}return{}}();return e.siteid?e.siteid:""}function Q(e,t){if("wechat"===e)return"wechat";for(var n=null,i=h,r=i.length,o=0;o<r&&null===n;o++)t.engine===i[o].value&&(n=i[o].engine);return"s.weibo.com"===n?"weibo":""}function Y(e){var t=G("hd_newui"),n=window.location.hostname;return n=n.split("."),t||(t=Math.random(),e&&n.length>1?H("hd_newui",t,{expires:36500,domain:"."+n[n.length-2]+"."+n[n.length-1]}):H("hd_newui",t,{expires:36500})),t}function Z(){var e=Math.random()+"";return H("hdjs_session_id",e),e}function ee(){var e=new Date;return H("hdjs_session_time",e=e.getTime()),e}W.prototype=new Error,W.prototype.constructor=W;var te=a,ne=Object.prototype.hasOwnProperty,ie=window.location.protocol+"//ylog.hiido.com/j.gif";function re(e){var t=re.isInternal;e=e.toLowerCase();var n=function(e){return e?{host:e.split("/")[2],origin:e}:{host:"",origin:""}}(document.referrer),i=function(e){var t=e.host,n=e.origin;if(!t)return{engine:"",key:""};for(var i=h.length,r=!1,o={engine:"",key:""},s=0;s<i&&!r;s++){var a=h[s],u=a.engine;if(t.indexOf(u)>-1){r=!0,o.engine=a.value;var l,c=a.rule;if("function"==typeof c)o.key=c(n);else{l=c.split("|");for(var d=0;d<l.length;d++){var p=l[d],f=new RegExp("(^|)"+p+"=([^&]*)(&|$)","gi").exec(n);if(null!==f){o.key=f[2];break}}}}}return o}(n),r=t?function(e){for(var t,n,i,r,o="",s=e.split("."),a="",u=0;u<z.length;u++)if(n=(t=z[u]).domain,e.indexOf(n)>-1){if(i=n.split("."),s[r=s.length-i.length]!==i[0]||e.substr(e.length-n.length)!==n)continue;var l=window._hiido_no;o=void 0!==l&&0===l?t.key:(0===r?"www":s[r-1])+"@"+t.key,a=t.domain;break}var c=G("hiido_ui");return c||H("hiido_ui",c=Math.random(),{expires:700,domain:"."+a}),o}(window.location.hostname):X(),o=D(e),s=!G("hd_newui");if(void 0===window["_hdjs_loaded_"+r]){window["_hdjs_loaded_"+r]=!0,this.isInternal=t,this.detect=o,this.data={ht:window.location.hostname,siteid:r,speid:V(),ui:Y(t),sc:window.screen.width+"."+window.screen.height,cl:(window.screen.colorDepth||0)+"-bit",pcmb:o.pcmb,os:o.os,bs:o.bs,mb:o.mb,se:i.engine,wd:i.key,rfh:n.host,rf:n.origin,sns:Q(o.bs,i),fl:K(),ln:navigator.language||"",ja:F(),ck:navigator.cookieEnabled?1:0,ot:"",lt:"",xy:"",ext:"",v:"v2.2.0",pl:window.location.href},this.options={isOversea:!1},s&&(this.data.isnew=1),this._hasBootstrapReport=!1,this._inactiveThreshold=2e4,this.data.hsid=this.getSessionId(),re.module||window._HIIDO_DEFER_||this._bootstrapReport();var a=this;this.report=window.hd=function(e,t,n){n=n||{},a.options.isOversea=!!n.isOversea,t=t||{};var i=new Date-0+"",r={hsid:G("hdjs_session_id"),ht:a.data.ht,ui:a.data.ui,siteid:a.data.siteid,pl:a.data.pl,v:a.data.v,rf:a.data.rf,rfh:a.data.rfh,pcmb:a.data.pcmb,rnd:a.data.ui+i,ut:i};if("event"===e){if(!t.eventAction)return void window.console.warn("[HiidoJS] ;  https://hdjs.hiido.com/docs/#/events");r.ea=t.eventAction,r.ec=t.eventCategory||"",r.el=t.eventLabel||"",r.ev=t.eventValue||"",a.log("webaction",r)}else"view"===e&&(re.module||window._HIIDO_DEFER_?(t.uid&&(a.data.uid=t.uid),t.reserve&&(a.data.reserve=re.JSON.stringify(t.reserve)),a._bootstrapReport()):window.console.warn("[HiidoJS] hiido.jsdefer,:","http://hdjs.hiido.com/docs/#/usage?id="))},this.attachMetricMethods()}}re.prototype={constructor:re,_bootstrapReport:function(){this._hasBootstrapReport?window.console.warn("[HiidoJS] !"):(this._hasBootstrapReport=!0,this.reportEnter(),this.recordLifetime(),this.attachEvents())},attachMetricMethods:function(){var e=this;this.oldMetrics=null,window.Metrics&&(window.__oldMetrics__=window.Metrics,this.oldMetrics=window.__oldMetrics__),window.__Metrics__=window.Metrics=this.Metrics={setOptions:function(t){e.setOptions(t)},serviceReport:function(t){if(e.validateMetricsReportData(t)){var n=(new Date).getTime(),i=e.generateMetricBasicData(n,t);i.reqdata=JSON.stringify([{scode:t.scode,uri:t.uri,reqtime:t.timeSpent,ret:t.code,rtime:n}]),e.log("mmetric",i)}},countReport:function(t){if(e.validateMetricsReportData(t)){var n=(new Date).getTime(),i=e.generateMetricBasicData(n,t);i.counterdata=JSON.stringify([{scode:t.scode,uri:t.uri,counterName:t.countName,value:t.count,invokecount:1}]),e.log("mmetric",i)}},customReport:function(t){if(e.validateMetricsReportData(t)){var n=(new Date).getTime(),i=e.generateMetricBasicData(n,t);i.flatdata=JSON.stringify([{scode:t.scode,uri:t.uri,topic:t.topic,val:t.val,extra:t.extra}]),e.log("mmetric",i)}},noConflict:function(){window.__oldMetrics__&&(window.Metrics=window.__oldMetrics__)}}},generateActKey:function(e,t){return o(e+t+"HiidoYYSystem").toLowerCase()},generateMetricBasicData:function(e,t){var n=e;e=Math.round(e/1e3);var i=this.generateActKey("mmetric",e),r=this.detect,o=r.os.split("|"),s=r.bs,a=o[0],u={ios:0,wp:1,android:2,macosx:3,win:4},l=re.JSON.stringify([]);return{time:e,key:i,appkey:"",ver:t.ver,sdkver:(this.isInternal,"v2.2.0"),sys:ne.call(u,a)?u[a]:a,osver:s,model:r.mb,sjp:r.mb,net:"",clienttime:n,reqdata:l,counterdata:l,flatdata:l}},reportEnter:function(){if(!this._enterReportSent){var e=new Date-0+"",t=re.assign(this.data,{io:1,ut:e,rnd:this.data.ui+e});this.log("webstat",t),this._enterReportSent=!0}},recordLifetime:function(){var e,t=this,n=window.requestAnimationFrame,i=window.cancelAnimationFrame;function r(){e.start()}function o(){e.stop()}this.data.lt=0,e=this._heartbeat=function(){var e;function r(){var i=new Date,o=i-t._ltStart;t.data.lt=t.data.lt+o,t._inactiveTime=t._inactiveTime+o,t._ltStart=i,e=t._inactiveTime<=t._inactiveThreshold?n(r):null}return{start:function(){e||(t._ltStart=new Date,e=n(r))},stop:function(){e&&(i(e),e=null)}}}(),"onfocusin"in document?(document.onfocusin=r,document.onfocusout=o):(window.onfocus=r,window.onblur=o);var s,a,u,l=["","webkit","moz","ms","o"];if(this.data.pcmb===te){for(var c=0;c<l.length;c++)if((a=(s=l[c])?s+"Hidden":"hidden")in document){u=s+"visibilitychange";break}u&&re.addEvent(document,u,(function(){document[a]?o():r()}))}this._inactiveTime=0,e.start()},reportLeave:function(){if(!this._leaveReportSent){var e=new Date-0+"",t=re.assign(this.data,{io:0,ut:e,rnd:this.data.ui+e,hsid:G("hdjs_session_id")});this.log("webstat",t),this._leaveReportSent=!0}},log:function(e,t){var n=this,i=[];for(var r in t)i.push(encodeURIComponent(r)+"="+encodeURIComponent(t[r]));var o,s=i.join("&"),a="log_"+(new Date).getTime(),u=new Image(1,1);if(window[a]=u,u.onerror=function(){(!0===window._HIIDO_OVERSEA_||n.options.isOversea)&&(u.src=ie+"?act="+e+"&"+s,u.onerror=function(){window[a]=null}),window[a]=null},u.onload=function(){window[a]=null},!function(e){return"string"==typeof e&&e.length<=2e3}(o=!0===window._HIIDO_OVERSEA_||n.options.isOversea?"//hlog.hiido.com/j.gif?act="+e+"&"+s:ie+"?act="+e+"&"+s))throw new W("Exceeding Maximum URL length - 2000 Characters");u.src=o},attachEvents:function(){var e=this;re.addEvent(document,"click",(function(t){var n=t.target||t.srcElement;(function(e){for(var t;e&&"a"!==(t=e.tagName.toLowerCase())&&"html"!==t;)e=e.parentNode;return"a"===t})(n)&&(e.data.ot=n.href),e.data.xy=t.clientX+","+t.clientY}),!0),window.onbeforeunload=function(){e.reportLeave()},window.onunload=function(){e.reportLeave()},this.data.pcmb===te&&(re.addEvent(window,"pageshow",(function(t){t.persisted&&(e._leaveReportSent=!1,e._enterReportSent=!1,e.data.lt=0,e.reportEnter())})),re.addEvent(window,"pagehide",(function(t){t.persisted&&e.reportLeave()})),re.addEvent(window,"touchstart",(function(){e._inactiveTime=0,e._heartbeat.start()})))},getSessionId:function(){var e,t=G("hdjs_session_time");return""===t?(e=Z(),ee()):""!==this.data.rfh&&-1===this.data.rfh.indexOf(this.data.ht)?e=Z():(t=G("hdjs_session_time"),e=(new Date).getTime()-t>18e5?Z():G("hdjs_session_id")),ee(),e},validateMetricsReportData:function(e){for(var t,n=["scode","ver","uri"],i=0;i<n.length;i++)if(!e[t=n[i]])return window.console.warn("HiidoJS: Metrics "+t+".  https://hdjs.hiido.com/docs/#/metrics"),!1;return!0},setOptions:function(e){this.options=re.assign({},this.options,e)}};var oe,se=r((function(e,t){(function(){var n={function:!0,object:!0},r=t&&!t.nodeType&&t,o=n["undefined"==typeof window?"undefined":p(window)]&&window||this,s=r&&n.object&&e&&!e.nodeType&&"object"==p(i)&&i;function a(e,t){e||(e=o.Object()),t||(t=o.Object());var i=e.Number||o.Number,r=e.String||o.String,s=e.Object||o.Object,u=e.Date||o.Date,l=e.SyntaxError||o.SyntaxError,c=e.TypeError||o.TypeError,d=e.Math||o.Math,h=e.JSON||o.JSON;"object"==(void 0===h?"undefined":p(h))&&h&&(t.stringify=h.stringify,t.parse=h.parse);var f,g,m,y=s.prototype,b=y.toString,v=new u(-0xc782b5b800cec);try{v=-109252==v.getUTCFullYear()&&0===v.getUTCMonth()&&1===v.getUTCDate()&&10==v.getUTCHours()&&37==v.getUTCMinutes()&&6==v.getUTCSeconds()&&708==v.getUTCMilliseconds()}catch(e){}function I(e){if(I[e]!==m)return I[e];var n;if("bug-string-char-index"==e)n="a"!="a"[0];else if("json"==e)n=I("json-stringify")&&I("json-parse");else{var o,s='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var a=t.stringify,l="function"==typeof a&&v;if(l){(o=function(){return 1}).toJSON=o;try{l="0"===a(0)&&"0"===a(new i)&&'""'==a(new r)&&a(b)===m&&a(m)===m&&a()===m&&"1"===a(o)&&"[1]"==a([o])&&"[null]"==a([m])&&"null"==a(null)&&"[null,null,null]"==a([m,b,null])&&a({a:[o,!0,!1,null,"\0\b\n\f\r\t"]})==s&&"1"===a(null,o)&&"[\n 1,\n 2\n]"==a([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==a(new u(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==a(new u(864e13))&&'"-000001-01-01T00:00:00.000Z"'==a(new u(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==a(new u(-1))}catch(e){l=!1}}n=l}if("json-parse"==e){var c=t.parse;if("function"==typeof c)try{if(0===c("0")&&!c(!1)){var d=5==(o=c(s)).a.length&&1===o.a[0];if(d){try{d=!c('"\t"')}catch(e){}if(d)try{d=1!==c("01")}catch(e){}if(d)try{d=1!==c("1.")}catch(e){}}}}catch(e){d=!1}n=d}}return I[e]=!!n}if(!I("json")){var S=I("bug-string-char-index");if(!v)var w=d.floor,_=[0,31,59,90,120,151,181,212,243,273,304,334],O=function(e,t){return _[t]+365*(e-1970)+w((e-1969+(t=+(t>1)))/4)-w((e-1901+t)/100)+w((e-1601+t)/400)};if((f=y.hasOwnProperty)||(f=function(e){var t,n={};return(n.__proto__=null,n.__proto__={toString:1},n).toString!=b?f=function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(t=n.constructor,f=function(e){var n=(this.constructor||t).prototype;return e in this&&!(e in n&&this[e]===n[e])}),n=null,f.call(this,e)}),g=function(e,t){var i,r,o,s=0;for(o in(i=function(){this.valueOf=0}).prototype.valueOf=0,r=new i)f.call(r,o)&&s++;return i=r=null,s?g=2==s?function(e,t){var n,i={},r="[object Function]"==b.call(e);for(n in e)r&&"prototype"==n||f.call(i,n)||!(i[n]=1)||!f.call(e,n)||t(n)}:function(e,t){var n,i,r="[object Function]"==b.call(e);for(n in e)r&&"prototype"==n||!f.call(e,n)||(i="constructor"===n)||t(n);(i||f.call(e,n="constructor"))&&t(n)}:(r=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],g=function(e,t){var i,o,s="[object Function]"==b.call(e),a=!s&&"function"!=typeof e.constructor&&n[p(e.hasOwnProperty)]&&e.hasOwnProperty||f;for(i in e)s&&"prototype"==i||!a.call(e,i)||t(i);for(o=r.length;i=r[--o];a.call(e,i)&&t(i));}),g(e,t)},!I("json-stringify")){var U={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},k=function(e,t){return("000000"+(t||0)).slice(-e)},T=function(e){for(var t='"',n=0,i=e.length,r=!S||i>10,o=r&&(S?e.split(""):e);n<i;n++){var s=e.charCodeAt(n);switch(s){case 8:case 9:case 10:case 12:case 13:case 34:case 92:t+=U[s];break;default:if(s<32){t+="\\u00"+k(2,s.toString(16));break}t+=r?o[n]:e.charAt(n)}}return t+'"'};t.stringify=function(e,t,i){var r,o,s,a;if(n[void 0===t?"undefined":p(t)]&&t)if("[object Function]"==(a=b.call(t)))o=t;else if("[object Array]"==a){s={};for(var u,l=0,d=t.length;l<d;u=t[l++],("[object String]"==(a=b.call(u))||"[object Number]"==a)&&(s[u]=1));}if(i)if("[object Number]"==(a=b.call(i))){if((i-=i%1)>0)for(r="",i>10&&(i=10);r.length<i;r+=" ");}else"[object String]"==a&&(r=i.length<=10?i:i.slice(0,10));return function e(t,n,i,r,o,s,a){var u,l,d,h,y,v,I,S,_,U,R,E,x,A,M,N;try{u=n[t]}catch(e){}if("object"==(void 0===u?"undefined":p(u))&&u)if("[object Date]"!=(l=b.call(u))||f.call(u,"toJSON"))"function"==typeof u.toJSON&&("[object Number]"!=l&&"[object String]"!=l&&"[object Array]"!=l||f.call(u,"toJSON"))&&(u=u.toJSON(t));else if(u>-1/0&&u<1/0){if(O){for(y=w(u/864e5),d=w(y/365.2425)+1970-1;O(d+1,0)<=y;d++);for(h=w((y-O(d,0))/30.42);O(d,h+1)<=y;h++);y=1+y-O(d,h),I=w((v=(u%864e5+864e5)%864e5)/36e5)%24,S=w(v/6e4)%60,_=w(v/1e3)%60,U=v%1e3}else d=u.getUTCFullYear(),h=u.getUTCMonth(),y=u.getUTCDate(),I=u.getUTCHours(),S=u.getUTCMinutes(),_=u.getUTCSeconds(),U=u.getUTCMilliseconds();u=(d<=0||d>=1e4?(d<0?"-":"+")+k(6,d<0?-d:d):k(4,d))+"-"+k(2,h+1)+"-"+k(2,y)+"T"+k(2,I)+":"+k(2,S)+":"+k(2,_)+"."+k(3,U)+"Z"}else u=null;if(i&&(u=i.call(n,t,u)),null===u)return"null";if("[object Boolean]"==(l=b.call(u)))return""+u;if("[object Number]"==l)return u>-1/0&&u<1/0?""+u:"null";if("[object String]"==l)return T(""+u);if("object"==(void 0===u?"undefined":p(u))){for(A=a.length;A--;)if(a[A]===u)throw c();if(a.push(u),R=[],M=s,s+=o,"[object Array]"==l){for(x=0,A=u.length;x<A;x++)E=e(x,u,i,r,o,s,a),R.push(E===m?"null":E);N=R.length?o?"[\n"+s+R.join(",\n"+s)+"\n"+M+"]":"["+R.join(",")+"]":"[]"}else g(r||u,(function(t){var n=e(t,u,i,r,o,s,a);n!==m&&R.push(T(t)+":"+(o?" ":"")+n)})),N=R.length?o?"{\n"+s+R.join(",\n"+s)+"\n"+M+"}":"{"+R.join(",")+"}":"{}";return a.pop(),N}}("",((u={})[""]=e,u),o,s,r,"",[])}}if(!I("json-parse")){var R,E,x=r.fromCharCode,A={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},M=function(){throw R=E=null,l()},N=function(){for(var e,t,n,i,r,o=E,s=o.length;R<s;)switch(r=o.charCodeAt(R)){case 9:case 10:case 13:case 32:R++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=S?o.charAt(R):o[R],R++,e;case 34:for(e="@",R++;R<s;)if((r=o.charCodeAt(R))<32)M();else if(92==r)switch(r=o.charCodeAt(++R)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=A[r],R++;break;case 117:for(t=++R,n=R+4;R<n;R++)(r=o.charCodeAt(R))>=48&&r<=57||r>=97&&r<=102||r>=65&&r<=70||M();e+=x("0x"+o.slice(t,R));break;default:M()}else{if(34==r)break;for(r=o.charCodeAt(R),t=R;r>=32&&92!=r&&34!=r;)r=o.charCodeAt(++R);e+=o.slice(t,R)}if(34==o.charCodeAt(R))return R++,e;M();default:if(t=R,45==r&&(i=!0,r=o.charCodeAt(++R)),r>=48&&r<=57){for(48==r&&(r=o.charCodeAt(R+1))>=48&&r<=57&&M(),i=!1;R<s&&(r=o.charCodeAt(R))>=48&&r<=57;R++);if(46==o.charCodeAt(R)){for(n=++R;n<s&&(r=o.charCodeAt(n))>=48&&r<=57;n++);n==R&&M(),R=n}if(101==(r=o.charCodeAt(R))||69==r){for(43!=(r=o.charCodeAt(++R))&&45!=r||R++,n=R;n<s&&(r=o.charCodeAt(n))>=48&&r<=57;n++);n==R&&M(),R=n}return+o.slice(t,R)}if(i&&M(),"true"==o.slice(R,R+4))return R+=4,!0;if("false"==o.slice(R,R+5))return R+=5,!1;if("null"==o.slice(R,R+4))return R+=4,null;M()}return"$"},C=function(e,t,n){var i=P(e,t,n);i===m?delete e[t]:e[t]=i},P=function(e,t,n){var i,r=e[t];if("object"==(void 0===r?"undefined":p(r))&&r)if("[object Array]"==b.call(r))for(i=r.length;i--;)C(r,i,n);else g(r,(function(e){C(r,e,n)}));return n.call(e,t,r)};t.parse=function(e,t){var n,i;return R=0,E=""+e,n=function e(t){var n,i;if("$"==t&&M(),"string"==typeof t){if("@"==(S?t.charAt(0):t[0]))return t.slice(1);if("["==t){for(n=[];"]"!=(t=N());i||(i=!0))i&&(","==t?"]"==(t=N())&&M():M()),","==t&&M(),n.push(e(t));return n}if("{"==t){for(n={};"}"!=(t=N());i||(i=!0))i&&(","==t?"}"==(t=N())&&M():M()),","!=t&&"string"==typeof t&&"@"==(S?t.charAt(0):t[0])&&":"==N()||M(),n[t.slice(1)]=e(N());return n}M()}return t}(N()),"$"!=N()&&M(),R=E=null,t&&"[object Function]"==b.call(t)?P(((i={})[""]=n,i),"",t):n}}}return t.runInContext=a,t}if(!s||s.global!==s&&s.window!==s&&s.self!==s||(o=s),r)a(o,r);else{var u=o.JSON,l=o.JSON3,c=!1,d=a(o,o.JSON3={noConflict:function(){return c||(c=!0,o.JSON=u,o.JSON3=l,u=l=null),d}});o.JSON={parse:d.parse,stringify:d.stringify}}}).call(i)}));(function(e){for(var t=0,n=["ms","moz","webkit","o"],i=0;i<n.length&&!e.requestAnimationFrame;++i)e.requestAnimationFrame=e[n[i]+"RequestAnimationFrame"],e.cancelAnimationFrame=e[n[i]+"CancelAnimationFrame"]||e[n[i]+"CancelRequestAnimationFrame"];if(e.requestAnimationFrame||(e.requestAnimationFrame=function(n){var i=(new Date).getTime(),r=Math.max(0,16-(i-t)),o=e.setTimeout((function(){n(i+r)}),r);return t=i+r,o}),e.cancelAnimationFrame||(e.cancelAnimationFrame=function(t){e.clearTimeout(t)}),!window.console){var r={log:function(){},dir:function(e){for(var t in e)r.log(t+" ",e[t])}};r.warn=r.log,window.console=r}window.console.dir||(window.console.dir=function(e){for(var t in e)window.console.log(t+" ",e[t])}),window.console.warn||(window.console.warn=window.console.log)})(window),re.addEvent=function(e,t,n,i){e.addEventListener?e.addEventListener(t,n,!!i):e.attachEvent&&(e["e"+t+n]=n,e[t+n]=function(){e["e"+t+n](window.event)},e.attachEvent("on"+t,e[t+n]))},re.assign=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n},re.isInternal=!0,re.module=!0,re.JSON=se,re.prototype.setSiteId=function(e){re.isInternal||(this.data.siteid=e)},re.prototype.setSpeId=function(e){this.data&&(this.data.speid=V(e))},function(){try{var e=navigator.userAgent;oe=new re(e)}catch(s){if(s instanceof W)throw s;window.console.dir(s);var t=new Image(1,1),n="";for(var i in s)n+=i+":"+s[i]+";";var r=encodeURIComponent,o=s.stack?r(s.stack):"";t.src=window.location.protocol+"//wbugs.hiido.com/c.gif?e="+r(n)+"|"+o+"|"+r(window.location.href)+"|"+r(e),t.onload=function(){}}}();var ae=oe.report,ue=oe.Metrics,le=oe.oldMetrics,ce=oe.setSiteId.bind(oe),de=oe.setSpeId.bind(oe)}.call(this,n(14))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.context="",this.uid="0",this.appid=0,this.instId=0,this.svcName="",this.fnName="",this.protoType="",this.data=null,this.dataCRC=0,this.serverId="",this.seqId="",this.traceId=""}unmarshall(e){this.context=e.popString(),this.uid=e.popUInt64String(),this.appid=e.popUInt32(),this.instId=e.popUInt32(),this.svcName=e.popString(),this.fnName=e.popString(),this.protoType=e.popString(),this.data=e.popUint8Array32(),this.dataCRC=e.popUInt32(),this.serverId=e.popUInt64String(),this.seqId=e.popUInt64String(),this.traceId=e.popString()}toString(){return"context="+this.context+" uid="+this.uid+" appid="+this.appid+" instId="+this.instId+" svcName="+this.svcName+" fnName="+this.fnName+" protoType="+this.protoType+" dataCRC="+this.dataCRC+" serverId="+this.serverId+" seqId="+this.seqId+" traceId="+this.traceId}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1),r=n(9);t.default=class{constructor(){this.context=""}marshall(){let e=new i.default;return e.setUri(r.default.PSvcUnicastResURI),e.pushString(this.context),e.marshall()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.appid=0,this.groupType="0",this.groupId="0",this.svcName="",this.fnName="",this.protoType="",this.data=null,this.dataCRC=0,this.serverId="0",this.seqId="0",this.traceId=""}unmarshall(e){this.appid=e.popUInt32(),this.groupType=e.popUInt64String(),this.groupId=e.popUInt64String(),this.svcName=e.popString(),this.fnName=e.popString(),this.protoType=e.popString(),this.data=e.popUint8Array32(),this.dataCRC=e.popUInt32(),this.serverId=e.popUInt64String(),this.seqId=e.popUInt64String(),this.traceId=e.popString()}toString(){return"appid="+this.appid+" groupType="+this.groupType+" groupId="+this.groupId+" svcName="+this.svcName+" fnName="+this.fnName+" protoType="+this.protoType+" dataCRC="+this.dataCRC+" serverId="+this.serverId+" seqId="+this.seqId+" traceId="+this.traceId}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.uid="0",this.appid=0,this.instId=0,this.code=0,this.desc=""}unmarshall(e){this.uid=e.popUInt64String(),this.appid=e.popUInt32(),this.instId=e.popUInt32(),this.code=e.popUInt32(),this.desc=e.popUtf8String()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.appid=0,this.ugid="",this.svcName="",this.fnName="",this.protoType="",this.data=null,this.dataCRC=0,this.serverId=null,this.seqId=null,this.traceId=""}unmarshall(e){this.appid=e.popUInt32(),this.ugid=e.popString(),this.svcName=e.popString(),this.fnName=e.popString(),this.protoType=e.popString(),this.data=e.popUint8Array32(),this.dataCRC=e.popUInt32(),this.serverId=e.popUInt64(),this.seqId=e.popUInt64(),this.traceId=e.popString()}toString(){return"appid="+this.appid+" ugid="+this.ugid+" svcName="+this.svcName+" fnName="+this.fnName+" protoType="+this.protoType+" dataCRC="+this.dataCRC+" serverId="+JSON.stringify(this.serverId)+" seqId="+JSON.stringify(this.seqId)+" traceId="+this.traceId}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0);t.default=class{constructor(){this.context="",this.rescode=0,this.msg="",this.svcName="",this.fnName="",this.protoType="",this.data=null,this.dataCRC=0,this.serverHeaders=new Map,this.traceId=""}unmarshall(e){this.context=e.popString(),this.rescode=e.popUInt32(),this.msg=e.popString(),this.svcName=e.popString(),this.fnName=e.popString(),this.protoType=e.popString(),this.data=e.popUint8Array32(),this.dataCRC=e.popUInt32();let t=e.popUInt32();for(let n=0;n<t;n++)this.serverHeaders.set(e.popString(),e.popString());this.traceId=e.popString()}toString(){return"context="+this.context+" rescode="+this.rescode+" msg="+this.msg+" svcName="+this.svcName+" fnName="+this.fnName+" traceId="+this.traceId+" serverHeaders="+i.default.stringfyMap(this.serverHeaders)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.context="",this.rescode=0}unmarshall(e){this.context=e.popString(),this.rescode=e.popUInt32()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1),r=n(9),o=n(4);t.default=class{constructor(){this.context="",this.appid=0,this.joinGroups=new Array,this.leaveGroups=new Array}marshall(){let e=new i.default;e.setUri(r.default.PSvcSubsGroupReqURI),e.pushString(this.context),e.pushUInt32(this.appid);let t=this.joinGroups.length;if(0==t)e.pushUInt32(0);else{e.pushUInt32(t);for(let n=0;n<t;n++){let t=o.fromString(this.joinGroups[n].grpType.toString());e.pushUInt32(t.low),e.pushUInt32(t.high);let i=o.fromString(this.joinGroups[n].grpId.toString());e.pushUInt32(i.low),e.pushUInt32(i.high)}}if(t=this.leaveGroups.length,0==t)e.pushUInt32(0);else{e.pushUInt32(t);for(let n=0;n<t;n++){let t=o.fromString(this.leaveGroups[n].grpType.toString());e.pushUInt32(t.low),e.pushUInt32(t.high);let i=o.fromString(this.leaveGroups[n].grpId.toString());e.pushUInt32(i.low),e.pushUInt32(i.high)}}return e.marshall()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1),r=n(9);t.default=class{constructor(){this.context="",this.appid=0,this.join=[],this.leave=[],this.traceId=""}marshall(){let e=new i.default;e.setUri(r.default.PCS_ServiceSubcribeUserGroupV2URI),e.pushString(this.context),e.pushUInt32(this.appid);let t=this.join.length;e.pushUInt32(t);for(let n=0;n<t;n++)e.pushString(this.join[n]);t=this.leave.length,e.pushUInt32(t);for(let n=0;n<t;n++)e.pushString(this.leave[n]);return e.pushString(this.traceId),e.marshall()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.context="",this.rescode=0,this.traceId="",this.msg=""}unmarshall(e){this.context=e.popString(),this.rescode=e.popUInt32(),this.traceId=e.popString(),this.msg=e.popString()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.context="",this.rescode=0,this.msg="",this.serverHeaders={}}unmarshall(e){this.context=e.popString(),this.rescode=e.popUInt32(),this.msg=e.popString();let t=e.popUInt32();for(let n=0;n<t;n++){let t=e.popString(),n=e.popString();this.serverHeaders[t]=n}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.context="",this.rescode=0,this.msg=""}unmarshall(e){this.context=e.popString(),this.rescode=e.popUInt32(),this.msg=e.popString()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(36),r=n(7);t.default=class{constructor(e){this.appid=0,this.userRegion="cn",this.heartBeatTimeoutSecs=60,this.appid=e,this.bShareAnonymousUid=!0,this.wxAppid="",this.hiidoHost="",this.scode=0,this.bRetry=!1,this.seqId=0,this.seqContext={},this.domain="",this.chlAppkey=0,this.chlPassword="",this.uid="0",this.anonymousUid=0,this.instId=Math.round(4294967295*Math.random()),this.tokenType=r.TokenType.TOKEN_3RD,this.token="",this.topSid=0,this.subSid=0,this.asid=0,this.channelJoined=!1,this.exclusiveJoin=!1,this.lastSentJoinChl=-2e3,this.lastSendLeaveChl=0,this.userType=r.UserType.ANONYMOUS,this.userGroups={subs:{},unsubs:{}},this.innerBcGroups={},this.userGroupsV2={subs:[],unsubs:[]},this.uuid=i.v4(),this.bLostConnection=!1,this.everJoinChannel=!1,this.loginUdbStartTs=0,this.logoutUdbStartTs=0,this.loginApStartTs=0,this.logoutApStartTs=0}getSeqId(){return this.seqId+=1,this.seqId}logout(){this.bRetry=!1,this.seqContext={},this.uid="0",this.token=null,this.topSid=0,this.subSid=0,this.asid=0,this.channelJoined=!1,this.userType=r.UserType.ANONYMOUS,this.userGroups={subs:{},unsubs:{}},this.innerBcGroups={},this.userGroupsV2={subs:[],unsubs:[]}}get isAnonymous(){return this.userType===r.UserType.ANONYMOUS}get isMiniProgram(){return"undefined"==typeof window}}},function(e,t,n){var i,r,o=n(37),s=n(38),a=0,u=0;e.exports=function(e,t,n){var l=t&&n||0,c=t||[],d=(e=e||{}).node||i,h=void 0!==e.clockseq?e.clockseq:r;if(null==d||null==h){var p=o();null==d&&(d=i=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==h&&(h=r=16383&(p[6]<<8|p[7]))}var f=void 0!==e.msecs?e.msecs:(new Date).getTime(),g=void 0!==e.nsecs?e.nsecs:u+1,m=f-a+(g-u)/1e4;if(m<0&&void 0===e.clockseq&&(h=h+1&16383),(m<0||f>a)&&void 0===e.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=f,u=g,r=h;var y=(1e4*(268435455&(f+=122192928e5))+g)%4294967296;c[l++]=y>>>24&255,c[l++]=y>>>16&255,c[l++]=y>>>8&255,c[l++]=255&y;var b=f/4294967296*1e4&268435455;c[l++]=b>>>8&255,c[l++]=255&b,c[l++]=b>>>24&15|16,c[l++]=b>>>16&255,c[l++]=h>>>8|128,c[l++]=255&h;for(var v=0;v<6;++v)c[l+v]=d[v];return t||s(c)}},function(e,t,n){var i=n(37),r=n(38);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||i)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[o+a]=s[a];return t||r(s)}},function(e,t,n){"use strict";var i=t;i.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var r=new Array(64),o=new Array(123),s=0;s<64;)o[r[s]=s<26?s+65:s<52?s+71:s<62?s-4:s-59|43]=s++;i.encode=function(e,t,n){for(var i,o=null,s=[],a=0,u=0;t<n;){var l=e[t++];switch(u){case 0:s[a++]=r[l>>2],i=(3&l)<<4,u=1;break;case 1:s[a++]=r[i|l>>4],i=(15&l)<<2,u=2;break;case 2:s[a++]=r[i|l>>6],s[a++]=r[63&l],u=0}a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0)}return u&&(s[a++]=r[i],s[a++]=61,1===u&&(s[a++]=61)),o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};i.decode=function(e,t,n){for(var i,r=n,s=0,a=0;a<e.length;){var u=e.charCodeAt(a++);if(61===u&&s>1)break;if(void 0===(u=o[u]))throw Error("invalid encoding");switch(s){case 0:i=u,s=1;break;case 1:t[n++]=i<<2|(48&u)>>4,i=u,s=2;break;case 2:t[n++]=(15&i)<<4|(60&u)>>2,i=u,s=3;break;case 3:t[n++]=(3&i)<<6|u,s=0}}if(1===s)throw Error("invalid encoding");return n-r},i.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},function(e,t,n){"use strict";function i(){this._listeners={}}e.exports=i,i.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},i.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===t?n.splice(i,1):++i;return this},i.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,n)}return this}},function(e,t,n){"use strict";function i(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),i=128===n[3];function r(e,i,r){t[0]=e,i[r]=n[0],i[r+1]=n[1],i[r+2]=n[2],i[r+3]=n[3]}function o(e,i,r){t[0]=e,i[r]=n[3],i[r+1]=n[2],i[r+2]=n[1],i[r+3]=n[0]}function s(e,i){return n[0]=e[i],n[1]=e[i+1],n[2]=e[i+2],n[3]=e[i+3],t[0]}function a(e,i){return n[3]=e[i],n[2]=e[i+1],n[1]=e[i+2],n[0]=e[i+3],t[0]}e.writeFloatLE=i?r:o,e.writeFloatBE=i?o:r,e.readFloatLE=i?s:a,e.readFloatBE=i?a:s}():function(){function t(e,t,n,i){var r=t<0?1:0;if(r&&(t=-t),0===t)e(1/t>0?0:2147483648,n,i);else if(isNaN(t))e(2143289344,n,i);else if(t>34028234663852886e22)e((r<<31|2139095040)>>>0,n,i);else if(t<11754943508222875e-54)e((r<<31|Math.round(t/1401298464324817e-60))>>>0,n,i);else{var o=Math.floor(Math.log(t)/Math.LN2);e((r<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,n,i)}}function n(e,t,n){var i=e(t,n),r=2*(i>>31)+1,o=i>>>23&255,s=8388607&i;return 255===o?s?NaN:r*(1/0):0===o?1401298464324817e-60*r*s:r*Math.pow(2,o-150)*(s+8388608)}e.writeFloatLE=t.bind(null,r),e.writeFloatBE=t.bind(null,o),e.readFloatLE=n.bind(null,s),e.readFloatBE=n.bind(null,a)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),i=128===n[7];function r(e,i,r){t[0]=e,i[r]=n[0],i[r+1]=n[1],i[r+2]=n[2],i[r+3]=n[3],i[r+4]=n[4],i[r+5]=n[5],i[r+6]=n[6],i[r+7]=n[7]}function o(e,i,r){t[0]=e,i[r]=n[7],i[r+1]=n[6],i[r+2]=n[5],i[r+3]=n[4],i[r+4]=n[3],i[r+5]=n[2],i[r+6]=n[1],i[r+7]=n[0]}function s(e,i){return n[0]=e[i],n[1]=e[i+1],n[2]=e[i+2],n[3]=e[i+3],n[4]=e[i+4],n[5]=e[i+5],n[6]=e[i+6],n[7]=e[i+7],t[0]}function a(e,i){return n[7]=e[i],n[6]=e[i+1],n[5]=e[i+2],n[4]=e[i+3],n[3]=e[i+4],n[2]=e[i+5],n[1]=e[i+6],n[0]=e[i+7],t[0]}e.writeDoubleLE=i?r:o,e.writeDoubleBE=i?o:r,e.readDoubleLE=i?s:a,e.readDoubleBE=i?a:s}():function(){function t(e,t,n,i,r,o){var s=i<0?1:0;if(s&&(i=-i),0===i)e(0,r,o+t),e(1/i>0?0:2147483648,r,o+n);else if(isNaN(i))e(0,r,o+t),e(2146959360,r,o+n);else if(i>17976931348623157e292)e(0,r,o+t),e((s<<31|2146435072)>>>0,r,o+n);else{var a;if(i<22250738585072014e-324)e((a=i/5e-324)>>>0,r,o+t),e((s<<31|a/4294967296)>>>0,r,o+n);else{var u=Math.floor(Math.log(i)/Math.LN2);1024===u&&(u=1023),e(4503599627370496*(a=i*Math.pow(2,-u))>>>0,r,o+t),e((s<<31|u+1023<<20|1048576*a&1048575)>>>0,r,o+n)}}}function n(e,t,n,i,r){var o=e(i,r+t),s=e(i,r+n),a=2*(s>>31)+1,u=s>>>20&2047,l=4294967296*(1048575&s)+o;return 2047===u?l?NaN:a*(1/0):0===u?5e-324*a*l:a*Math.pow(2,u-1075)*(l+4503599627370496)}e.writeDoubleLE=t.bind(null,r,0,4),e.writeDoubleBE=t.bind(null,o,4,0),e.readDoubleLE=n.bind(null,s,0,4),e.readDoubleBE=n.bind(null,a,4,0)}(),e}function r(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function o(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function s(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function a(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=i(i)},function(e,t,n){"use strict";e.exports=function(e,t,n){var i=n||8192,r=i>>>1,o=null,s=i;return function(n){if(n<1||n>r)return e(n);s+n>i&&(o=e(i),s=0);var a=t.call(o,s,s+=n);return 7&s&&(s=1+(7|s)),a}}},function(e,t,n){"use strict";e.exports=r;var i=n(8);function r(e,t){this.lo=e>>>0,this.hi=t>>>0}var o=r.zero=new r(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var s=r.zeroHash="\0\0\0\0\0\0\0\0";r.fromNumber=function(e){if(0===e)return o;var t=e<0;t&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return t&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new r(n,i)},r.from=function(e){if("number"==typeof e)return r.fromNumber(e);if(i.isString(e)){if(!i.Long)return r.fromNumber(parseInt(e,10));e=i.Long.fromString(e)}return e.low||e.high?new r(e.low>>>0,e.high>>>0):o},r.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},r.prototype.toLong=function(e){return i.Long?new i.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;r.fromHash=function(e){return e===s?o:new r((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},r.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},r.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},r.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},r.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},function(e,t,n){"use strict";e.exports=o;var i=n(19);(o.prototype=Object.create(i.prototype)).constructor=o;var r=n(8);function o(){i.call(this)}function s(e,t,n){e.length<40?r.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}o._configure=function(){o.alloc=r._Buffer_allocUnsafe,o.writeBytesBuffer=r.Buffer&&r.Buffer.prototype instanceof Uint8Array&&"set"===r.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var i=0;i<e.length;)t[n++]=e[i++]}},o.prototype.bytes=function(e){r.isString(e)&&(e=r._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(o.writeBytesBuffer,t,e),this},o.prototype.string=function(e){var t=r.Buffer.byteLength(e);return this.uint32(t),t&&this._push(s,t,e),this},o._configure()},function(e,t,n){"use strict";e.exports=o;var i=n(20);(o.prototype=Object.create(i.prototype)).constructor=o;var r=n(8);function o(e){i.call(this,e)}o._configure=function(){r.Buffer&&(o.prototype._slice=r.Buffer.prototype.slice)},o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},o._configure()},function(e,t,n){"use strict";e.exports=r;var i=n(8);function r(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");i.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(r.prototype=Object.create(i.EventEmitter.prototype)).constructor=r,r.prototype.rpcCall=function e(t,n,r,o,s){if(!o)throw TypeError("request must be specified");var a=this;if(!s)return i.asPromise(e,a,t,n,r,o);if(a.rpcImpl)try{return a.rpcImpl(t,n[a.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,n){if(e)return a.emit("error",e,t),s(e);if(null!==n){if(!(n instanceof r))try{n=r[a.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return a.emit("error",e,t),s(e)}return a.emit("data",n,t),s(null,n)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){s(e)}),0)}else setTimeout((function(){s(Error("already ended"))}),0)},r.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(46),r=n(4),o=n(39),s=n(5),a=n(103);i.util.Long=r,i.configure();const u=new s.Logger("HummerProto");t.default=class{static decodeRouteRes(e){if(u.debug("decodeRouteRes:",e),"cim.proto.ProxyService.SetUserRegion"==e.fnName)return o.hummerProto.SetUserRegionResponse.decode(new Uint8Array(e.data));if("CreateChatRoom"==e.fnName){let t=new a.default;return t.unmarshall(e.data),t}return null}}},function(e,t,n){"use strict";var i=e.exports=n(97);i.build="full",i.tokenize=n(52),i.parse=n(101),i.common=n(102),i.Root._configure(i.Type,i.parse,i.common)},function(e,t,n){"use strict";var i=e.exports=n(41);i.build="light",i.load=function(e,t,n){return"function"==typeof t?(n=t,t=new i.Root):t||(t=new i.Root),t.load(e,n)},i.loadSync=function(e,t){return t||(t=new i.Root),t.loadSync(e)},i.encoder=n(47),i.decoder=n(48),i.verifier=n(49),i.converter=n(50),i.ReflectionObject=n(11),i.Namespace=n(13),i.Root=n(26),i.Enum=n(6),i.Type=n(21),i.Field=n(10),i.OneOf=n(17),i.MapField=n(22),i.Service=n(23),i.Method=n(24),i.Message=n(25),i.wrappers=n(51),i.types=n(12),i.util=n(3),i.ReflectionObject._configure(i.Root),i.Namespace._configure(i.Type,i.Service,i.Enum),i.Root._configure(i.Type),i.Field._configure(i.Type)},function(e,t,n){"use strict";function i(e,t){"string"==typeof e&&(t=e,e=void 0);var n=[];function r(e){if("string"!=typeof e){var t=o();if(i.verbose&&console.log("codegen: "+t),t="return "+t,e){for(var s=Object.keys(e),a=new Array(s.length+1),u=new Array(s.length),l=0;l<s.length;)a[l]=s[l],u[l]=e[s[l++]];return a[l]=t,Function.apply(null,a).apply(null,u)}return Function(t)()}for(var c=new Array(arguments.length-1),d=0;d<c.length;)c[d]=arguments[++d];if(d=0,e=e.replace(/%([%dfijs])/g,(function(e,t){var n=c[d++];switch(t){case"d":case"f":return String(Number(n));case"i":return String(Math.floor(n));case"j":return JSON.stringify(n);case"s":return String(n)}return"%"})),d!==c.length)throw Error("parameter count mismatch");return n.push(e),r}function o(i){return"function "+(i||t||"")+"("+(e&&e.join(",")||"")+"){\n  "+n.join("\n  ")+"\n}"}return r.toString=o,r}e.exports=i,i.verbose=!1},function(e,t,n){"use strict";e.exports=o;var i=n(42),r=n(43)("fs");function o(e,t,n){return"function"==typeof t?(n=t,t={}):t||(t={}),n?!t.xhr&&r&&r.readFile?r.readFile(e,(function(i,r){return i&&"undefined"!=typeof XMLHttpRequest?o.xhr(e,t,n):i?n(i):n(null,t.binary?r:r.toString("utf8"))})):o.xhr(e,t,n):i(o,this,e,t)}o.xhr=function(e,t,n){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(4===i.readyState){if(0!==i.status&&200!==i.status)return n(Error("status "+i.status));if(t.binary){var e=i.response;if(!e){e=[];for(var r=0;r<i.responseText.length;++r)e.push(255&i.responseText.charCodeAt(r))}return n(null,"undefined"!=typeof Uint8Array?new Uint8Array(e):e)}return n(null,i.responseText)}},t.binary&&("overrideMimeType"in i&&i.overrideMimeType("text/plain; charset=x-user-defined"),i.responseType="arraybuffer"),i.open("GET",e),i.send()}},function(e,t,n){"use strict";var i=t,r=i.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},o=i.normalize=function(e){var t=(e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),n=r(e),i="";n&&(i=t.shift()+"/");for(var o=0;o<t.length;)".."===t[o]?o>0&&".."!==t[o-1]?t.splice(--o,2):n?t.splice(o,1):++o:"."===t[o]?t.splice(o,1):++o;return i+t.join("/")};i.resolve=function(e,t,n){return n||(t=o(t)),r(t)?t:(n||(e=o(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?o(e+"/"+t):t)}},function(e,t,n){"use strict";e.exports=O,O.filename=null,O.defaults={keepCase:!1};var i=n(52),r=n(26),o=n(21),s=n(10),a=n(22),u=n(17),l=n(6),c=n(23),d=n(24),h=n(12),p=n(3),f=/^[1-9][0-9]*$/,g=/^-?[1-9][0-9]*$/,m=/^0[x][0-9a-fA-F]+$/,y=/^-?0[x][0-9a-fA-F]+$/,b=/^0[0-7]+$/,v=/^-?0[0-7]+$/,I=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,S=/^[a-zA-Z_][a-zA-Z_0-9]*$/,w=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,_=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function O(e,t,n){t instanceof r||(n=t,t=new r),n||(n=O.defaults);var U,k,T,R,E,x=i(e,n.alternateCommentMode||!1),A=x.next,M=x.push,N=x.peek,C=x.skip,P=x.cmnt,q=!0,B=!1,j=t,L=n.keepCase?function(e){return e}:p.camelCase;function D(e,t,n){var i=O.filename;return n||(O.filename=null),Error("illegal "+(t||"token")+" '"+e+"' ("+(i?i+", ":"")+"line "+x.line+")")}function G(){var e,t=[];do{if('"'!==(e=A())&&"'"!==e)throw D(e);t.push(A()),C(e),e=N()}while('"'===e||"'"===e);return t.join("")}function H(e){var t=A();switch(t){case"'":case'"':return M(t),G();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return function(e,t){var n=1;"-"===e.charAt(0)&&(n=-1,e=e.substring(1));switch(e){case"inf":case"INF":case"Inf":return n*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(f.test(e))return n*parseInt(e,10);if(m.test(e))return n*parseInt(e,16);if(b.test(e))return n*parseInt(e,8);if(I.test(e))return n*parseFloat(e);throw D(e,"number",t)}(t,!0)}catch(n){if(e&&w.test(t))return t;throw D(t,"value")}}function V(e,t){var n,i;do{!t||'"'!==(n=N())&&"'"!==n?e.push([i=F(A()),C("to",!0)?F(A()):i]):e.push(G())}while(C(",",!0));C(";")}function F(e,t){switch(e){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!t&&"-"===e.charAt(0))throw D(e,"id");if(g.test(e))return parseInt(e,10);if(y.test(e))return parseInt(e,16);if(v.test(e))return parseInt(e,8);throw D(e,"id")}function J(){if(void 0!==U)throw D("package");if(U=A(),!w.test(U))throw D(U,"name");j=j.define(U),C(";")}function $(){var e,t=N();switch(t){case"weak":e=T||(T=[]),A();break;case"public":A();default:e=k||(k=[])}t=G(),C(";"),e.push(t)}function K(){if(C("="),R=G(),!(B="proto3"===R)&&"proto2"!==R)throw D(R,"syntax");C(";")}function z(e,t){switch(t){case"option":return Q(e,t),C(";"),!0;case"message":return function(e,t){if(!S.test(t=A()))throw D(t,"type name");var n=new o(t);W(n,(function(e){if(!z(n,e))switch(e){case"map":!function(e){C("<");var t=A();if(void 0===h.mapKey[t])throw D(t,"type");C(",");var n=A();if(!w.test(n))throw D(n,"type");C(">");var i=A();if(!S.test(i))throw D(i,"name");C("=");var r=new a(L(i),F(A()),t,n);W(r,(function(e){if("option"!==e)throw D(e);Q(r,e),C(";")}),(function(){ee(r)})),e.add(r)}(n);break;case"required":case"optional":case"repeated":X(n,e);break;case"oneof":!function(e,t){if(!S.test(t=A()))throw D(t,"name");var n=new u(L(t));W(n,(function(e){"option"===e?(Q(n,e),C(";")):(M(e),X(n,"optional"))})),e.add(n)}(n,e);break;case"extensions":V(n.extensions||(n.extensions=[]));break;case"reserved":V(n.reserved||(n.reserved=[]),!0);break;default:if(!B||!w.test(e))throw D(e);M(e),X(n,"optional")}})),e.add(n)}(e,t),!0;case"enum":return function(e,t){if(!S.test(t=A()))throw D(t,"name");var n=new l(t);W(n,(function(e){switch(e){case"option":Q(n,e),C(";");break;case"reserved":V(n.reserved||(n.reserved=[]),!0);break;default:!function(e,t){if(!S.test(t))throw D(t,"name");C("=");var n=F(A(),!0),i={};W(i,(function(e){if("option"!==e)throw D(e);Q(i,e),C(";")}),(function(){ee(i)})),e.add(t,n,i.comment)}(n,e)}})),e.add(n)}(e,t),!0;case"service":return function(e,t){if(!S.test(t=A()))throw D(t,"service name");var n=new c(t);W(n,(function(e){if(!z(n,e)){if("rpc"!==e)throw D(e);!function(e,t){var n=P(),i=t;if(!S.test(t=A()))throw D(t,"name");var r,o,s,a,u=t;C("("),C("stream",!0)&&(o=!0);if(!w.test(t=A()))throw D(t);r=t,C(")"),C("returns"),C("("),C("stream",!0)&&(a=!0);if(!w.test(t=A()))throw D(t);s=t,C(")");var l=new d(u,i,r,s,o,a);l.comment=n,W(l,(function(e){if("option"!==e)throw D(e);Q(l,e),C(";")})),e.add(l)}(n,e)}})),e.add(n)}(e,t),!0;case"extend":return function(e,t){if(!w.test(t=A()))throw D(t,"reference");var n=t;W(null,(function(t){switch(t){case"required":case"repeated":case"optional":X(e,t,n);break;default:if(!B||!w.test(t))throw D(t);M(t),X(e,"optional",n)}}))}(e,t),!0}return!1}function W(e,t,n){var i=x.line;if(e&&("string"!=typeof e.comment&&(e.comment=P()),e.filename=O.filename),C("{",!0)){for(var r;"}"!==(r=A());)t(r);C(";",!0)}else n&&n(),C(";"),e&&"string"!=typeof e.comment&&(e.comment=P(i))}function X(e,t,n){var i=A();if("group"!==i){if(!w.test(i))throw D(i,"type");var r=A();if(!S.test(r))throw D(r,"name");r=L(r),C("=");var a=new s(r,F(A()),i,t,n);W(a,(function(e){if("option"!==e)throw D(e);Q(a,e),C(";")}),(function(){ee(a)})),e.add(a),B||!a.repeated||void 0===h.packed[i]&&void 0!==h.basic[i]||a.setOption("packed",!1,!0)}else!function(e,t){var n=A();if(!S.test(n))throw D(n,"name");var i=p.lcFirst(n);n===i&&(n=p.ucFirst(n));C("=");var r=F(A()),a=new o(n);a.group=!0;var u=new s(i,r,n,t);u.filename=O.filename,W(a,(function(e){switch(e){case"option":Q(a,e),C(";");break;case"required":case"optional":case"repeated":X(a,e);break;default:throw D(e)}})),e.add(a).add(u)}(e,t)}function Q(e,t){var n=C("(",!0);if(!w.test(t=A()))throw D(t,"name");var i=t;n&&(C(")"),i="("+i+")",t=N(),_.test(t)&&(i+=t,A())),C("="),Y(e,i)}function Y(e,t){if(C("{",!0))do{if(!S.test(E=A()))throw D(E,"name");"{"===N()?Y(e,t+"."+E):(C(":"),"{"===N()?Y(e,t+"."+E):Z(e,t+"."+E,H(!0))),C(",",!0)}while(!C("}",!0));else Z(e,t,H(!0))}function Z(e,t,n){e.setOption&&e.setOption(t,n)}function ee(e){if(C("[",!0)){do{Q(e,"option")}while(C(",",!0));C("]")}return e}for(;null!==(E=A());)switch(E){case"package":if(!q)throw D(E);J();break;case"import":if(!q)throw D(E);$();break;case"syntax":if(!q)throw D(E);K();break;case"option":Q(j,E),C(";");break;default:if(z(j,E)){q=!1;continue}throw D(E)}return O.filename=null,{package:U,imports:k,weakImports:T,syntax:R,root:t}}},function(e,t,n){"use strict";e.exports=o;var i,r=/\/|\./;function o(e,t){r.test(e)||(e="google/protobuf/"+e+".proto",t={nested:{google:{nested:{protobuf:{nested:t}}}}}),o[e]=t}o("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}}),o("duration",{Duration:i={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),o("timestamp",{Timestamp:i}),o("empty",{Empty:{fields:{}}}),o("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),o("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),o("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}}),o.get=function(e){return o[e]||null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(2),r=n(0);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomid=0,this.rescode=0,this.props={},this.msg=""}unmarshall(e){let t=r.default.payload2DataView(e);e=null;let n=new i.default(t,!1);this.appid=n.popUInt32(),n.popUInt32(),this.uid=n.popUInt64String(),this.roomid=n.popUInt32(),this.rescode=n.popUInt32();let o=n.popUInt32();for(let e=0;e<o;e++){let e=n.popString(),t=n.popUtf8String();this.props[e]=t}this.msg=n.popUtf8String()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1);t.default=class{constructor(){this.appid=0,this.uid="0",this.props=new Map}marshall(){let e=new i.default(!1);e.pushUInt32(this.appid),e.pushUInt64String(this.uid),e.pushUInt32(this.props.size);for(let[t,n]of this.props)e.pushString(t.toString()),e.pushUtf8String(n.toString());return e.marshall()}}},function(module,exports,__webpack_require__){(function(global){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(e,t){module.exports=t(e)}("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==global?global:this,(function(global){"use strict";global=global||{};var _Base64=global.Base64,version="2.5.1",buffer;if(module.exports)try{buffer=eval("require('buffer').Buffer")}catch(e){buffer=void 0}var b64chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64tab=function(e){for(var t={},n=0,i=e.length;n<i;n++)t[e.charAt(n)]=n;return t}(b64chars),fromCharCode=String.fromCharCode,cb_utob=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?fromCharCode(192|t>>>6)+fromCharCode(128|63&t):fromCharCode(224|t>>>12&15)+fromCharCode(128|t>>>6&63)+fromCharCode(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return fromCharCode(240|t>>>18&7)+fromCharCode(128|t>>>12&63)+fromCharCode(128|t>>>6&63)+fromCharCode(128|63&t)},re_utob=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,utob=function(e){return e.replace(re_utob,cb_utob)},cb_encode=function(e){var t=[0,2,1][e.length%3],n=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0);return[b64chars.charAt(n>>>18),b64chars.charAt(n>>>12&63),t>=2?"=":b64chars.charAt(n>>>6&63),t>=1?"=":b64chars.charAt(63&n)].join("")},btoa=global.btoa?function(e){return global.btoa(e)}:function(e){return e.replace(/[\s\S]{1,3}/g,cb_encode)},_encode=buffer?buffer.from&&Uint8Array&&buffer.from!==Uint8Array.from?function(e){return(e.constructor===buffer.constructor?e:buffer.from(e)).toString("base64")}:function(e){return(e.constructor===buffer.constructor?e:new buffer(e)).toString("base64")}:function(e){return btoa(utob(e))},encode=function(e,t){return t?_encode(String(e)).replace(/[+\/]/g,(function(e){return"+"==e?"-":"_"})).replace(/=/g,""):_encode(String(e))},encodeURI=function(e){return encode(e,!0)},re_btou=new RegExp(["[-][-]","[-][-]{2}","[-][-]{3}"].join("|"),"g"),cb_btou=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return fromCharCode(55296+(t>>>10))+fromCharCode(56320+(1023&t));case 3:return fromCharCode((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return fromCharCode((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},btou=function(e){return e.replace(re_btou,cb_btou)},cb_decode=function(e){var t=e.length,n=t%4,i=(t>0?b64tab[e.charAt(0)]<<18:0)|(t>1?b64tab[e.charAt(1)]<<12:0)|(t>2?b64tab[e.charAt(2)]<<6:0)|(t>3?b64tab[e.charAt(3)]:0),r=[fromCharCode(i>>>16),fromCharCode(i>>>8&255),fromCharCode(255&i)];return r.length-=[0,0,2,1][n],r.join("")},_atob=global.atob?function(e){return global.atob(e)}:function(e){return e.replace(/\S{1,4}/g,cb_decode)},atob=function(e){return _atob(String(e).replace(/[^A-Za-z0-9\+\/]/g,""))},_decode=buffer?buffer.from&&Uint8Array&&buffer.from!==Uint8Array.from?function(e){return(e.constructor===buffer.constructor?e:buffer.from(e,"base64")).toString()}:function(e){return(e.constructor===buffer.constructor?e:new buffer(e,"base64")).toString()}:function(e){return btou(_atob(e))},decode=function(e){return _decode(String(e).replace(/[-_]/g,(function(e){return"-"==e?"+":"/"})).replace(/[^A-Za-z0-9\+\/]/g,""))},noConflict=function(){var e=global.Base64;return global.Base64=_Base64,e};if(global.Base64={VERSION:version,atob:atob,btoa:btoa,fromBase64:decode,toBase64:encode,utob:utob,encode:encode,encodeURI:encodeURI,btou:btou,decode:decode,noConflict:noConflict,__buffer__:buffer},"function"==typeof Object.defineProperty){var noEnum=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};global.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",noEnum((function(){return decode(this)}))),Object.defineProperty(String.prototype,"toBase64",noEnum((function(e){return encode(this,e)}))),Object.defineProperty(String.prototype,"toBase64URI",noEnum((function(){return encode(this,!0)})))}}return global.Meteor&&(Base64=global.Base64),module.exports?module.exports.Base64=global.Base64:(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){return global.Base64}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)),{Base64:global.Base64}}))}).call(this,__webpack_require__(14))},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(e){o(e)}}function a(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(s,a)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),o=n(7),s=n(107),a=n(148),u=n(30),l=n(149),c=new r.Logger("RtsService");class d extends a.default{constructor(e){super(e),this.rooms=[]}createRoom(e){const t=e.region?e.region:this.userRegion;let n=this.getRegionRoomId(t,e.roomId);if(this.rooms[n])return c.info(`createRoom: [${n}] exists!`),this.rooms[n].room;let i=new s.default(this.hummer,t,e.roomId);return this.rooms[n]={room:i,region:t,roomId:e.roomId},c.info(`createRoom: [${n}]`),i}getRoomMemberCount(e){if(0===e.roomIds.length)return Promise.resolve({rescode:o.kInvalid_Parameters,msg:o.INVALID_PARAMETERS});let t=new l.default;t.appid=this.appid,t.roomIds=e.roomIds,c.debug("getRoomMemberCount: pkg="+JSON.stringify(t));let n=t.marshall();const i=this.getQueryService(e.region);return this.sendData(i,"BatchGetChannelUserCount",n)}getQueryService(e){return`svc_${e||this.userRegion}_channel_service_query`}sendData(e,t,n){return this.h5_g_globals.bLostConnection?Promise.reject({rescode:o.kOperationTimeout,msg:o.OPERATION_TIMEOUT}):new Promise((r,o)=>i(this,void 0,void 0,(function*(){try{const i=yield this.ap.sendData(this.appid,e,t,n),o=u.default.decodeRouteRes(i);r(o)}catch(e){o(e)}})))}}t.default=d},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(e){o(e)}}function a(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(s,a)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(29),s=n(30),a=n(4),u=n(5),l=n(7),c=n(131),d=n(132),h=n(133),p=n(134),f=n(135),g=n(136),m=n(27),y=n(137),b=n(15),v=n(28),I=n(16),S=n(138),w=n(139),_=n(140),O=n(141),U=n(142),k=n(143),T=n(144),R=n(145),E=n(146),x=n(147),A=new u.Logger("Room");class M{constructor(e,t,n){this.roomInfos=[],this.heartbeat={need_ping:0,heartbeat_duration:20,pollHeartbeatTimer:null},this.queueEnable=!1,this.queueCount=1,this.emitOffline=!1,this.offlineTimer=null,this.pollRoomTimer=[],this.offline_check_duration=75,this.region=null,this.roomId=null,this.handlers={},this.mutex=new m.default,this.hummer=e,r.default.isEmpty(n)&&A.warn("constructor: roomId invalid!"),this.roomId=n,this.region=t,this.env=l.parseEnvParams(t),null!=this.env?(this.addEventListener(),this.start()):A.error("constructor: region error")}get ap(){return this.hummer.ap}get appid(){return this.h5_g_globals.appid}get uid(){return this.h5_g_globals.uid}get h5_g_globals(){return this.hummer.h5_g_globals}get regionRoomId(){return`${this.region}:${this.roomId}`}isValidQueueId(e){return!!(e<this.queueCount&&this.roomInfos[e])}addEventListener(){this.ap.on(I.AP_EVENTS.CONNECTION_STATE_CHANGED,e=>{this.onConnectionStateChange(e)}),this.ap.on(I.AP_EVENTS.BROADCAST_V2,e=>{this.onBroadcast(e)}),this.ap.on(I.AP_EVENTS.TRY_LOGOUT,()=>{this.queueEnable&&this.leave().catch(e=>{console.warn("leave: e=",e)})})}get connectState(){return this.ap.connectState}get cimService(){return`svc_${this.env.area}_cim_${this.env.type}_${this.env.name}_proxy`}get regionCode(){return"china"===this.env.area||"shenzhen"===this.env.area?"chn":this.env.area}get autherService(){return`svc_${this.regionCode}_channel_service_auther`}get queryService(){return`svc_${this.regionCode}_channel_service_query`}get sinfoService(){return`svc_${this.regionCode}_channel_service_sinfo`}start(){this.onConnectionStateChange(this.connectState)}get connected(){return this.ap.connectState.state==l.ConnectionState.CONNECTED}stop(){this.clearRoomTimer(),this.clearHeartbeatTimer(),this.queueEnable=!1}getFirstGrpSysMaxSeqId(e){return i(this,void 0,void 0,(function*(){if(!e)return;const t=l.getMutexKey(l.MutexKey.getGroupMaxSeqId,e.queueId);try{yield this.mutex.wait(t),this.mutex.lock(t);const n=yield this.getGrpSysMaxSeqId(e.queueId);A.log(`getFirstGrpSysMaxSeqId[${e.queueId}]: res=`,n,typeof n.maxSeqId),n&&0===n.code&&(e.receivedBcMaxSeqId=n.maxSeqId,e.hasBcFirstGetMaxSeqSuccess=!0,A.log(`getFirstGrpSysMaxSeqId[${e.queueId}]: receivedBcMaxSeqId=`,e.receivedBcMaxSeqId.toString()),this.pullGroupSysMsgIfAny(e.queueId),this.pollRoomTimer[e.queueId]||(this.pollRoomTimer[e.queueId]=setInterval(this.pullGroupMsgPeriod.bind(this),9e5,e.queueId)))}catch(t){A.warn(`getFirstGrpSysMaxSeqId[${e.queueId}] failed`,t)}finally{this.mutex.unlock(t)}}))}onConnectionStateChange(e){switch(e.state){case l.ConnectionState.RECONNECTING:if(this.queueEnable&&!this.offlineTimer){const e=1e3*r.default.MAX(this.offline_check_duration-11,5);A.debug("start offlineTimer: dt="+e),this.offlineTimer=setTimeout(this.onRoomMemberOffline.bind(this),e)}break;case l.ConnectionState.CONNECTED:this.clearOfflineTimer(),this.pullGroupMsgPeriodForQueue(),this.queueEnable?(this.heartbeatOnlineProc(),this.joinRoomBc()):this.emitOffline&&(this.emitOffline=!1,this.leaveRoomService().catch(e=>{A.warn(`leaveRoomService[${this.regionRoomId}]: e=`,e)}));break;case l.ConnectionState.DISCONNECTED:e.reason===l.ConnectionChangeReason.LOGOUT&&this.stop()}}onRoomMemberOffline(){if(this.connected)return;const e=this.genUserGroupId(this.roomId);A.debug("sub",e,"userGroupsV2.subs",this.h5_g_globals.userGroupsV2.subs);const t=this.h5_g_globals.userGroupsV2.subs.indexOf(e);-1!==t&&this.h5_g_globals.userGroupsV2.subs.splice(t,1),this.queueEnable=!1,this.emitOffline=!0,A.debug("emit offlineTimer"),this.emit(I.ROOM_EVENTS.ROOM_MEMBER_OFFLINE)}onBroadcast(e){const t=this.decodeBroadcastRes(e);t instanceof o.proto.IMPushGroupSysMsgRequest?this.onReceivePushGroupMsgRequest(t):t instanceof o.proto.UnreliableIMPushGroupSysMsgRequest?(A.debug("onBroadcast: UnreliableIMPushGroupSysMsgRequest=",t),this.notifyMessageUnreliableRoomListener(t)):A.debug("ignore onBroadcast")}decodeBroadcastRes(e){return s.default.decodeBroadcastRes(e)}decodeRouteRes(e){return s.default.decodeRouteRes(e)}onReceivePushGroupMsgRequest(e){if(e.region!==this.env.region||e.envType!==this.env.type||e.envName!==this.env.name)return void A.debug("ignore IMPushGroupSysMsgRequest as it not match env:",this.env);if(this.getRoomIdFromTopic(e.topic)!==this.roomId)return void A.debug("IMPushGroupSysMsgRequest: not found group_id="+e.groupId.toString()+" regionRoomId="+this.regionRoomId+" queueId="+e.queueId);const t=e.queueId||0;if(!this.isValidQueueId(t))return void A.warn(`onReceivePushGroupMsgRequest: queue[${t}] not exists`);A.log(`onReceivePushGroupMsgRequest[${t}]:`,e);const n=l.getMutexKey(this.roomId,t);if(this.mutex.islock(n))return void A.log(`onReceivePushGroupMsgRequest[${t}]: pulling is going...`);const i=this.roomInfos[t];if(e.prevSeqId.equals(i.receivedBcMaxSeqId))i.receivedBcMaxSeqId=e.seqId,A.log(`onReceivePushGroupMsgRequest receivedBcMaxSeqId[${i.queueId}] is updated to`,i.receivedBcMaxSeqId.toString()),this.processReliableChannelMsg(e.msg);else{if(i.maxBcPushSeqId=e.seqId,!i.hasBcFirstGetMaxSeqSuccess)return void A.log("receive room push msg. but wait for first get max seq success");this.pullGroupSysMsgIfAny(i.queueId).catch(e=>{A.warn("pullGroupsysMsgIfAny: e=",e)})}}pullGroupSysMsgIfAny(e){return i(this,void 0,void 0,(function*(){let t=this.roomInfos[e];if(!t)return;const n=l.getMutexKey(this.roomId,t.queueId);try{yield this.mutex.wait(n),this.mutex.lock(n);const e=yield this.pullGroupSysMsgOnce(t);e&&e.hasMore&&(A.log("has more. schedule a new pull"),setTimeout(this.pullGroupSysMsgIfAny.bind(this),100,t.queueId))}catch(e){A.warn("pull room msgs: ",e)}finally{this.mutex.unlock(n)}}))}notifyRoomMessageListener(e){for(const t of e.msgs)this.processReliableChannelMsg(t)}processReliableChannelMsg(e){switch(e.action){case o.proto.Action.kNotifyJoinSignalGroup:case o.proto.Action.kNotifyLeaveSignalGroup:break;case o.proto.Action.kNotifySignalMessage:{const t=o.proto.SignalMessage.decode(e.content),n={message:{type:t.type,data:t.content,appExtras:t.extensions,serverReceivedTs:e.timestamp.toString()},fromUid:t.fromUid.toString()};this.emit(I.ROOM_EVENTS.ROOM_MESSAGE,n);break}case o.proto.Action.kNotifyUinfoChange:{const t=o.proto.NotifyUinfoChange.decode(e.content);this.notifyUserAttributesChange(t);break}case o.proto.Action.kNotifyUserOnlineStatusChange:{const t=o.proto.NotifyUserStatusChange.decode(e.content);A.log("userOnlineGrp:",t),this.notifyUserOnlineStatusChange(t);break}case o.proto.Action.kNotifyUserCountChange:{const t=o.proto.NotifyChannelUserCountChange.decode(e.content);A.log("userOnlineGrp:",t),this.notifyUserCountChange(t);break}case o.proto.Action.kNotifyChannelPropsChange:{const t=o.proto.NotifyChannelPropsChange.decode(e.content);this.notifyRoomAttributesChange(t);break}default:A.debug("unexpected room action:",e.action)}}notifyUserOnlineStatusChange(e){if(e.joinuids.length>0){const t={uids:r.default.LongToUint64StringArray(e.joinuids)};this.emit(I.ROOM_EVENTS.MEMBER_JOINED,t)}if(e.leaveuids.length>0){const t={uids:r.default.LongToUint64StringArray(e.leaveuids)};A.debug(""+I.ROOM_EVENTS.MEMBER_LEFT,t),this.emit(I.ROOM_EVENTS.MEMBER_LEFT,t)}}notifyUserCountChange(e){const t={count:e.count};this.emit(I.ROOM_EVENTS.MEMBER_COUNT_UPDATED,t)}notifyMessageUnreliableRoomListener(e){if(e.region!==this.env.region)return void A.debug("ignore UnreliableIMPushGroupSysMsgRequest as it not match env:",this.env);let t=this.getRoomIdFromTopic(e.topic);if(this.roomId===t){if(e.msg instanceof o.proto.UnreliableMsg){if("ChannelService"!==e.msg.uri)return void A.warn("invalid uri:"+e.msg.uri);if(e.msg.action===o.proto.Action.kNotifySignalMessage){const t=o.proto.SignalMessage.decode(e.msg.content),n={message:{type:t.type,data:t.content,appExtras:t.extensions,serverReceivedTs:e.msg.timestamp.toString()},fromUid:t.fromUid.toString()};this.emit(I.ROOM_EVENTS.ROOM_MESSAGE,n)}}}else A.debug("UnreliableIMPushGroupSysMsgRequest: not found group_id="+e.groupId.toString()+" regionRoomId="+this.regionRoomId)}notifyUserAttributesChange(e){A.debug(`notifyUserAttributesChange[${this.regionRoomId}]:`,e);const t={uid:e.uid.toString(),attributes:e.infos};switch(e.opType){case o.proto.NotifyUinfoChange.OpType.kOpUpdate:A.info(I.ROOM_EVENTS.MEMBER_ATTRIBUTES_ADDED_OR_UPDATED+": "+JSON.stringify(t)),this.emit(I.ROOM_EVENTS.MEMBER_ATTRIBUTES_ADDED_OR_UPDATED,t);break;case o.proto.NotifyUinfoChange.OpType.kOpSet:A.info(I.ROOM_EVENTS.MEMBER_ATTRIBUTES_SET+": "+JSON.stringify(t)),this.emit(I.ROOM_EVENTS.MEMBER_ATTRIBUTES_SET,t);break;case o.proto.NotifyUinfoChange.OpType.kOpDel:A.info(I.ROOM_EVENTS.MEMBER_ATTRIBUTES_DELETED+": "+JSON.stringify(t)),this.emit(I.ROOM_EVENTS.MEMBER_ATTRIBUTES_DELETED,t);break;case o.proto.NotifyUinfoChange.OpType.kOpClear:A.info(I.ROOM_EVENTS.MEMBER_ATTRIBUTES_CLEARED+": "+JSON.stringify(t)),this.emit(I.ROOM_EVENTS.MEMBER_ATTRIBUTES_CLEARED,t);break;default:A.debug("not support opType=",e.opType)}}notifyRoomAttributesChange(e){A.debug(`notifyRoomAttributesChange[${this.regionRoomId}]:`,e);const t={lastUpdateUid:e.uid.toString(),attributes:e.props};switch(e.opType){case o.proto.NotifyChannelPropsChange.OpType.kOpUpdate:A.info(I.ROOM_EVENTS.ROOM_ATTRIBUTES_ADDED_OR_UPDATED+": "+JSON.stringify(t)),this.emit(I.ROOM_EVENTS.ROOM_ATTRIBUTES_ADDED_OR_UPDATED,t);break;case o.proto.NotifyChannelPropsChange.OpType.kOpSet:A.info(I.ROOM_EVENTS.ROOM_ATTRIBUTES_SET+": "+JSON.stringify(t)),this.emit(I.ROOM_EVENTS.ROOM_ATTRIBUTES_SET,t);break;case o.proto.NotifyChannelPropsChange.OpType.kOpDel:A.info(I.ROOM_EVENTS.ROOM_ATTRIBUTES_DELETED+": "+JSON.stringify(t)),this.emit(I.ROOM_EVENTS.ROOM_ATTRIBUTES_DELETED,t);break;case o.proto.NotifyChannelPropsChange.OpType.kOpClear:A.info(I.ROOM_EVENTS.ROOM_ATTRIBUTES_CLEARED+": "+JSON.stringify(t)),this.emit(I.ROOM_EVENTS.ROOM_ATTRIBUTES_CLEARED,t);break;default:A.debug("not support opType=",e.opType)}}pullGroupMsgPeriodForQueue(){if(this.queueEnable){A.log(`pullGroupMsgPeriodForQueue[${this.regionRoomId}]`);for(let e of this.roomInfos)setTimeout(this.pullGroupMsgPeriod.bind(this),200,e.queueId)}}pullGroupMsgPeriod(e){return i(this,void 0,void 0,(function*(){if(!this.queueEnable)return;const t=this.roomInfos[e];if(!this.connected||!t)return;A.debug(`pullGroupMsgPeriod[${this.regionRoomId}][${e}]`);const n=l.getMutexKey(this.roomId,t.queueId);try{yield this.mutex.wait(n),this.mutex.lock(n);const e=yield this.pullGroupSysMsgOnce(t);e&&e.hasMore&&setTimeout(this.pullGroupMsgPeriod.bind(this),100,t.queueId)}catch(e){A.warn("pullGroupMsgPeriod:",e)}finally{this.mutex.unlock(n)}}))}pullGroupSysMsgOnce(e){return i(this,void 0,void 0,(function*(){if(!e)return null;const t={startSeqId:e.receivedBcMaxSeqId,limit:l.SIZE_LIMIT,roomId:this.roomId,queueId:e.queueId};A.debug(`pullGroupSysMsg[${this.regionRoomId}][${e.queueId}]: req=`,t);const n=yield this.pullGroupSysMsg(t);return A.debug(`pullGroupSysMsg[${this.regionRoomId}][${e.queueId}]: res=`,n),n.maxSeqId instanceof a&&n.maxSeqId.greaterThan(0)?(e.receivedBcMaxSeqId=n.maxSeqId,A.log(`pullGroupSysMsgOnce receivedBcMaxSeqId[${e.queueId}] is updated to`,e.receivedBcMaxSeqId.toString())):A.log(`pullGroupSysMsgOnce[${e.queueId}]: has_more=`,n.hasMore),n instanceof o.proto.PullGroupSysMsgResponse?(this.notifyRoomMessageListener(n),n):(A.debug(`pullGroupSysMsgOnce[${e.queueId}]: unkown group msg`),null)}))}initRoomStatus(e){this.roomInfos[e]={queueId:e,hasBcFirstGetMaxSeqSuccess:!1,receivedBcMaxSeqId:a.fromNumber(0),maxBcPushSeqId:a.fromNumber(0)}}initQueue(){return i(this,void 0,void 0,(function*(){if(!this.queueEnable)try{const e=yield this.getQueueConfig(this.region);if(A.log(`initQueue[${this.regionRoomId}]: res=`,e),e&&0===e.rescode){this.queueEnable=!0,this.queueCount=r.default.MIN(e.queueCount,l.MAX_QUEUE_SIZE);for(let e=0;e<this.queueCount;e++){this.initRoomStatus(e);let t=this.roomInfos[e];t.hasBcFirstGetMaxSeqSuccess||this.getFirstGrpSysMaxSeqId(t).catch(t=>{A.warn(`getFirstGrpSysMaxSeqId[${this.regionRoomId}][${e}]: e=`,t)})}}}catch(e){A.warn("initQueue: e=",e)}}))}getQueueConfig(e){return i(this,void 0,void 0,(function*(){const t=o.proto.GetQueueConfigRequest;let n=t.create({logId:this.generateLogId(),appId:a.fromNumber(this.appid),region:e,selfUid:a.fromString(this.uid)});A.debug("getQueueConfig: req=",n,"logId=",n.logId.toString());let i=t.encode(n).finish();const r=yield this.send(this.cimService,"cim.proto.ProxyService.GetQueueConfig",i);return r instanceof o.proto.GetQueueConfigResponse?(A.info("getQueueConfig: res=",r),{rescode:r.code,msg:r.msg,queueCount:r.queueCount}):(A.warn("getQueueConfig: unexpected res=",r),{rescode:l.UNKOWN,msg:"unexpected response: "+r})}))}getGrpSysMaxSeqId(e=0){return i(this,void 0,void 0,(function*(){const t="SignalService/"+this.roomId;let n=this.calcDJBHash(t);const i=o.proto.GetGrpSysMaxSeqIdRequest;let r=i.create({logId:this.generateLogId(),appId:a.fromNumber(this.appid),selfUid:a.fromString(this.uid),groupId:n,topic:t,queueId:e});A.log(`getGrpSysMaxSeqId[${e}]: req=`,r,"logId=",r.logId.toString());let s=i.encode(r).finish();const u=yield this.send(this.cimService,"cim.proto.ProxyService.GetGrpSysMaxSeqId",s);return u instanceof o.proto.GetGrpSysMaxSeqIdResponse?0===u.code?(A.log(`getGrpSysMaxSeqId[${e}] res= `,u,", type=",typeof u.maxSeqId),"number"==typeof u.maxSeqId?{code:u.code,maxSeqId:a.fromNumber(u.maxSeqId)}:{code:u.code,maxSeqId:u.maxSeqId}):(A.warn("getGrpSysMaxSeqId failed",u),{code:u.code,msg:u.msg}):(A.warn(`getGrpSysMaxSeqId[${e}]: unexpected res=`,u),{code:l.UNKOWN,msg:"unexpected response: "+u})}))}sendMessage(e){let t=!0;t=!e.option||"yes"===e.option.reliable;let n=new d.default;n.appid=this.appid,n.uid=this.uid,n.roomId=this.roomId,n.type=e.type,n.content=e.content,n.reliable=t,e.appExtras&&(n.extra=r.default.toMap(e.appExtras));const i=n.marshall();return A.debug("sendMessage: pkg=",n),this.send(this.autherService,"SendBroadcast",i)}getMembers(){let e=new c.default;e.appid=this.appid,e.roomId=this.roomId,A.debug("getMembers: ",e);let t=e.marshall();return this.send(this.queryService,"GetUserList",t)}setUserAttributes(e){let t=new p.default;t.appid=this.appid,t.uid=this.uid,t.roomId=this.roomId,e.attributes&&(t.infos=r.default.toMap(e.attributes)),e&&e.options?t.noneedbroadcast=!e.options.enableNotification:t.noneedbroadcast=!0;let n=t.marshall();return this.send(this.autherService,"SetUserInfo",n)}deleteUserAttributesByKeys(e){let t=new h.default;t.appid=this.appid,t.uid=this.uid,t.roomId=this.roomId,t.keys=e.keys,e&&e.options?t.noneedbroadcast=!e.options.enableNotification:t.noneedbroadcast=!0;let n=t.marshall();return this.send(this.autherService,"DeleteUserInfo",n)}clearUserAttributes(e=null){let t=new S.default;t.appid=this.appid,t.uid=this.uid,t.roomId=this.roomId,e&&e.options?t.noneedbroadcast=!e.options.enableNotification:t.noneedbroadcast=!0;let n=t.marshall();return this.send(this.autherService,"DeleteAllUserInfo",n)}addOrUpdateUserAttributes(e){let t=new w.default;t.appid=this.appid,t.uid=this.uid,t.roomId=this.roomId,e.attributes&&(t.infos=r.default.toMap(e.attributes)),e&&e.options?t.noneedbroadcast=!e.options.enableNotification:t.noneedbroadcast=!0;let n=t.marshall();return this.send(this.autherService,"AddOrUpdateUserInfo",n)}getUserAttributes(e){if(!r.default.isUint64String(e.uid))return Promise.reject({rescode:l.kInvalid_Parameters,msg:l.INVALID_PARAMETERS});let t=new _.default;t.appid=this.appid,t.roomId=this.roomId,t.uid=e.uid,A.debug("getUserAttributes: req=",JSON.stringify(t));let n=t.marshall();return this.send(this.queryService,"GetUserInfo",n)}getUserAttributesByKeys(e){if(!r.default.isUint64String(e.uid))return Promise.reject({rescode:l.kInvalid_Parameters,msg:l.INVALID_PARAMETERS});let t=new O.default;t.appid=this.appid,t.roomId=this.roomId,t.uid=e.uid,t.keys=e.keys,A.debug("getUserAttributesByKeys: req=",JSON.stringify(t));let n=t.marshall();return this.send(this.queryService,"GetUserInfoByKey",n)}setRoomAttributes(e){let t=new U.default;t.appid=this.appid,t.uid=this.uid,t.roomId=this.roomId,e.attributes&&(t.props=r.default.toMap(e.attributes)),e&&e.options?t.noneedbroadcast=!e.options.enableNotification:t.noneedbroadcast=!0;let n=t.marshall();return this.send(this.autherService,"SetChannelProps",n)}addOrUpdateRoomAttributes(e){let t=new k.default;t.appid=this.appid,t.uid=this.uid,t.roomId=this.roomId,e.attributes&&(t.props=r.default.toMap(e.attributes)),e&&e.options?t.noneedbroadcast=!e.options.enableNotification:t.noneedbroadcast=!0;let n=t.marshall();return this.send(this.autherService,"AddOrUpdateChannelProps",n)}deleteRoomAttributesByKeys(e){let t=new T.default;t.appid=this.appid,t.uid=this.uid,t.roomId=this.roomId,t.keys=e.keys,e&&e.options?t.noneedbroadcast=!e.options.enableNotification:t.noneedbroadcast=!0;let n=t.marshall();return this.send(this.autherService,"DeleteChannelProps",n)}clearRoomAttributes(e=null){let t=new R.default;t.appid=this.appid,t.uid=this.uid,t.roomId=this.roomId,e&&e.options?t.noneedbroadcast=!e.options.enableNotification:t.noneedbroadcast=!0;let n=t.marshall();return this.send(this.autherService,"DeleteAllChannelProps",n)}getRoomAttributesByKeys(e){let t=new E.default;t.appid=this.appid,t.uid=this.uid,t.roomId=this.roomId,t.keys=e.keys,A.debug("getRoomAttributesByKeys",t);let n=t.marshall();return this.send(this.sinfoService,"GetChannelProps",n)}getRoomAttributes(){let e=new x.default;e.appid=this.appid,e.uid=this.uid,e.roomId=this.roomId,A.debug("getRoomAttributes",JSON.stringify(e));let t=e.marshall();return this.send(this.sinfoService,"GetAllChannelProps",t)}joinRoom(e=null){return new Promise((t,n)=>i(this,void 0,void 0,(function*(){try{const n=yield this.joinRoomService(e);if(A.debug("joinRoomService: "+JSON.stringify(n)),n&&0===n.rescode){this.queueEnable||this.initQueue(),this.setCheckOfflineTime(n.props),this.setCrossRegionHeartbeatParams(n.props),setTimeout(this.heartbeatOnlineProc.bind(this),500);const e=yield this.joinRoomBcV2(this.roomId);t(e)}else t({rescode:n.rescode,msg:n.msg})}catch(e){n(e)}})))}setCheckOfflineTime(e){r.default.hasOwn(e,"props_offline_check_duration")&&(this.offline_check_duration=Number(e.props_offline_check_duration)),A.debug("offline_check_duration="+this.offline_check_duration)}joinRoomService(e=null){let t=new f.default;t.appid=this.appid,t.uid=this.uid,t.roomId=this.roomId,e&&e.extra&&(t.extra=r.default.toMap(e.extra)),A.debug("joinChannelService: pkg="+JSON.stringify(t));let n=t.marshall();return this.send(this.autherService,"JoinChannelService",n)}leaveRoomService(e=null){let t=new g.default;t.appid=this.appid,t.uid=this.uid,t.roomId=this.roomId,e&&e.extra&&(t.extra=r.default.toMap(e.extra));let n=t.marshall();return A.debug("leaveRoomService: pkg="+JSON.stringify(t)),this.send(this.autherService,"LeaveChannelService",n)}join(e){return new Promise((t,n)=>i(this,void 0,void 0,(function*(){try{if(yield this.mutex.wait(l.MutexKey.join),this.mutex.lock(l.MutexKey.join),this.queueEnable)A.info(`already in room[${this.regionRoomId}]`);else{let e="SignalService/"+this.roomId;this.group_id=this.calcDJBHash(e).toNumber(),A.debug("join: group_id=",this.group_id)}const n=yield this.joinRoom(e);t(n)}catch(e){this.queueEnable=!1,n(e)}finally{this.mutex.unlock(l.MutexKey.join)}})))}leave(e=null){return new Promise((t,n)=>i(this,void 0,void 0,(function*(){try{yield this.mutex.wait(l.MutexKey.leave),this.mutex.lock(l.MutexKey.leave),this.queueEnable||A.log(`not in room[${this.regionRoomId}]`);const n=yield this.leaveRoomService(e);if(A.debug("leaveRoomService: res="+JSON.stringify(n)),n&&0===n.rescode){const e=yield this.leaveRoomBcV2(this.roomId);e&&0===e.rescode&&this.clearRoomInfo(),t(e)}else t({rescode:n.rescode,msg:n.msg})}catch(e){n(e)}finally{this.mutex.unlock(l.MutexKey.leave)}})))}pingOnlineUserHeartBeatPeriod(){return i(this,void 0,void 0,(function*(){if(!this.connected)return A.log("stop heartbeat because not connected"),void this.clearHeartbeatTimer();try{const e=yield this.pingOnlineUserHeartBeat();A.debug("pingOnlineUserHeartBeat res:",e)}catch(e){A.warn("pingOnlineUserHeartBeat period: e=",e)}}))}pingOnlineUserHeartBeat(){let e=new y.default;e.appid=this.appid,e.uid=this.uid,e.roomId=this.roomId,A.debug("pingOnlineUserHeartBeat: "+JSON.stringify(e));let t=e.marshall();return this.send(`svc_${this.regionCode}_channel_service_heartbeat`,"OnlineUserHeartBeat",t)}setCrossRegionHeartbeatParams(e){r.default.hasOwn(e,"props_need_ping")&&r.default.hasOwn(e,"props_cross_region_heartbeat_duration")?(this.heartbeat.need_ping=Number(e.props_need_ping),this.heartbeat.heartbeat_duration=Number(e.props_cross_region_heartbeat_duration)):(this.heartbeat.need_ping=0,this.heartbeat.heartbeat_duration=20),A.log("heartbeat=",this.heartbeat),this.modifyOfflineCheckDuration()}modifyOfflineCheckDuration(){this.heartbeat.need_ping&&(this.offline_check_duration=this.heartbeat.heartbeat_duration,A.log("modify offline_check_duration="+this.offline_check_duration))}heartbeatOnlineProc(){if(this.heartbeat.need_ping){if(A.log("heartbeatOnlineProc start"),this.pingOnlineUserHeartBeat().catch(e=>{A.warn("heartbeatOnlineProc e=",e)}),!this.heartbeat.pollHeartbeatTimer){const e=r.default.MAX(5,this.heartbeat.heartbeat_duration/3);this.heartbeat.pollHeartbeatTimer=setInterval(this.pingOnlineUserHeartBeatPeriod.bind(this),1e3*e)}}else this.clearHeartbeatTimer()}pullGroupSysMsg(e){return i(this,void 0,void 0,(function*(){if(r.default.isEmpty(e.startSeqId))return Promise.reject({code:l.UNKOWN,msg:"startSeqId is empty!"});if(0===e.limit)return Promise.reject({code:l.UNKOWN,msg:"limit is zero!"});let t;t="string"==typeof e.startSeqId?a.fromString(e.startSeqId):e.startSeqId,A.debug(`pullGroupSysMsg[${e.queueId}]: startSeqId=`,t,"req=",e);let n="SignalService/"+e.roomId,i=this.calcDJBHash(n);const s=o.proto.PullGroupSysMsgRequest;let u=s.create({logId:this.generateLogId(),appId:a.fromNumber(this.appid),selfUid:a.fromString(this.uid),groupId:i,exclusiveStartSeqId:t,limit:e.limit,statisDeliveryDelay:!0,topic:n,queueId:e.queueId});A.log(`pullGroupSysMsg[${e.queueId}]: req=`,u);let c=s.encode(u).finish();const d=yield this.send(this.cimService,"cim.proto.ProxyService.PullGroupSysMsg",c);return d instanceof o.proto.PullGroupSysMsgResponse?(A.log(`pullGroupSysMsg[${e.queueId}]: res=`,d),0===d.code?d:{code:d.code,msg:d.msg}):(A.warn(`pullGroupSysMsg[${e.queueId}]: unexpected res=`,d),{code:l.UNKOWN,msg:"unexpected response: "+d})}))}joinRoomBcV2(e){return new Promise((t,n)=>i(this,void 0,void 0,(function*(){try{let n={subs:[this.genUserGroupId(e)]};const i=yield this.subscribeBcV2(n);t({rescode:i.rescode,msg:i.msg})}catch(e){n(e)}})))}joinRoomBc(){this.queueEnable&&this.joinRoomBcV2(this.roomId).catch(e=>{A.warn(e)})}leaveRoomBcV2(e){return i(this,void 0,void 0,(function*(){return A.log("leaveRoomBcV2"),new Promise((t,n)=>i(this,void 0,void 0,(function*(){let i={unsubs:[this.genUserGroupId(e)]};this.subscribeBcV2(i).then(e=>{t({rescode:e.rescode,msg:e.msg})}).catch(e=>{n(e)})})))}))}subscribeBcV2(e){return i(this,void 0,void 0,(function*(){return this.ap.subscribeBcV2(e)}))}clearRoomInfo(){this.clearHeartbeatTimer(),this.roomInfos=[],this.queueEnable=!1}clearOfflineTimer(){this.offlineTimer&&(clearTimeout(this.offlineTimer),delete this.offlineTimer,this.offlineTimer=null)}clearRoomTimer(){for(const e of this.pollRoomTimer)clearInterval(e);this.pollRoomTimer=[]}clearHeartbeatTimer(){this.heartbeat.pollHeartbeatTimer&&(clearInterval(this.heartbeat.pollHeartbeatTimer),delete this.heartbeat.pollHeartbeatTimer,this.heartbeat.pollHeartbeatTimer=null,A.log(`clearHeartbeatTimer[${this.regionRoomId}]`))}genUserGroupId(e){let t="SignalService/"+e,n=this.calcDJBHash(t);return`hydra:${this.region}:${t}:${n}`}send(e,t,n){return this.h5_g_globals.bLostConnection?Promise.reject({rescode:l.kOperationTimeout,msg:l.OPERATION_TIMEOUT}):new Promise((r,o)=>i(this,void 0,void 0,(function*(){try{const i=yield this.ap.sendData(this.appid,e,t,n),o=this.decodeRouteRes(i);r(o)}catch(e){o(e)}})))}}t.default=M,l.applyMixins(M,[b.Emitter,v.Base])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(2),r=n(0);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.rescode=0,this.msg="",this.props={}}unmarshall(e){let t=r.default.payload2DataView(e);e=null;let n=new i.default(t,!1);this.appid=n.popUInt32(),this.uid=n.popUInt64String(),this.roomId=n.popUtf8String(),this.rescode=n.popUInt32(),this.msg=n.popString();let o=n.popUInt32();for(let e=0;e<o;e++){let e=n.popString(),t=n.popUtf8String();this.props[e]=t}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(2),r=n(0);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.rescode=0,this.msg=""}unmarshall(e){let t=r.default.payload2DataView(e);e=null;let n=new i.default(t,!1);this.appid=n.popUInt32(),this.uid=n.popUInt64String(),this.roomId=n.popUtf8String(),this.rescode=n.popUInt32(),this.msg=n.popString()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.content="",this.reliable=!0}unmarshall(e){this.appid=e.popUInt32(),this.uid=e.popUInt64String(),this.roomId=e.popString(),this.content=e.popUtf8String(),this.reliable=e.popBool()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(2),r=n(0);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.content="",this.receiver="0",this.reliable=!0}unmarshall(e){let t=r.default.payload2DataView(e);e=null;let n=new i.default(t);this.appid=n.popUInt32(),this.uid=n.popUInt64String(),this.roomId=n.popString(),this.content=n.popUtf8String(),this.receiver=n.popUInt64String(),this.reliable=n.popBool()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.appid=0,this.roomId="",this.joinUsers=[],this.leaveUsers=[]}unmarshall(e){this.appid=e.popUInt32(),this.roomId=e.popString();let t=e.popUInt32();for(let n=0;n<t;n++){let t=e.popUInt64String();this.joinUsers.push(t)}t=e.popUInt32();for(let n=0;n<t;n++){let t=e.popUInt64String();this.leaveUsers.push(t)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.appid=0,this.roomId="",this.updateInfo=new Map,this.deleteInfo=new Map}unmarshall(e){this.appid=e.popUInt32(),this.roomId=e.popUtf8String();let t=e.popUInt32();for(let n=0;n<t;n++){let t=e.popString(),n=new Map,i=e.popUInt32();for(let t=0;t<i;t++){let t=e.popString(),i=e.popUtf8String();n.set(t,i)}this.updateInfo.set(t,n)}t=e.popUInt32();for(let n=0;n<t;n++){let t=e.popString(),n=e.popUInt32(),i=[];for(let t=0;t<n;t++){let t=e.popString();i.push(t)}this.deleteInfo.set(t,i)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(2),r=n(0);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.rescode=0,this.msg=""}unmarshall(e){let t=r.default.payload2DataView(e);e=null;let n=new i.default(t,!1);this.appid=n.popUInt32(),this.uid=n.popUInt64String(),this.roomId=n.popUtf8String(),this.rescode=n.popUInt32(),this.msg=n.popString()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(2),r=n(0);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.rescode=0,this.msg=""}unmarshall(e){let t=r.default.payload2DataView(e);e=null;let n=new i.default(t,!1);this.appid=n.popUInt32(),this.uid=n.popUInt64String(),this.roomId=n.popUtf8String(),this.rescode=n.popUInt32(),this.msg=n.popString()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(2),r=n(0);t.default=class{constructor(){this.appid=0,this.roomId="",this.uids=[],this.rescode=0,this.msg=""}unmarshall(e){let t=r.default.payload2DataView(e);e=null;let n=new i.default(t,!1);this.appid=n.popUInt32(),this.roomId=n.popString();let o=n.popUInt32();for(let e=0;e<o;e++){let e=n.popUInt64String();this.uids.push(e)}this.rescode=n.popUInt32(),this.msg=n.popString()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(2),r=n(0);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.rescode=0,this.msg=""}unmarshall(e){let t=r.default.payload2DataView(e);e=null;let n=new i.default(t,!1);this.appid=n.popUInt32(),this.uid=n.popUInt64String(),this.roomId=n.popString(),this.rescode=n.popUInt32(),this.msg=n.popString()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(2),r=n(0);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.rescode=0,this.msg=""}unmarshall(e){let t=r.default.payload2DataView(e);e=null;let n=new i.default(t,!1);this.appid=n.popUInt32(),this.uid=n.popUInt64String(),this.roomId=n.popString(),this.rescode=n.popUInt32(),this.msg=n.popString()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(2),r=n(0);t.default=class{constructor(){this.appid=0,this.userCount={},this.rescode=0,this.msg=""}unmarshall(e){let t=r.default.payload2DataView(e);e=null;let n=new i.default(t,!1);this.appid=n.popUInt32();let o=n.popUInt32();for(let e=0;e<o;e++){let e=n.popString(),t=n.popUInt32();this.userCount[e]=t}this.rescode=n.popUInt32(),this.msg=n.popString()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(2),r=n(0);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.rescode=0,this.ext={},this.msg=""}unmarshall(e){let t=r.default.payload2DataView(e);e=null;let n=new i.default(t,!1);this.appid=n.popUInt32(),this.uid=n.popUInt64String(),this.roomId=n.popString(),this.rescode=n.popUInt32();let o=n.popUInt32();for(let e=0;e<o;e++){let e=n.popString(),t=n.popUtf8String();this.ext[e]=t}this.msg=n.popString()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(2),r=n(0);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.rescode=0,this.msg=""}unmarshall(e){let t=r.default.payload2DataView(e);e=null;let n=new i.default(t,!1);this.appid=n.popUInt32(),this.uid=n.popUInt64String(),this.roomId=n.popString(),this.rescode=n.popUInt32(),this.msg=n.popString()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(2),r=n(0);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.rescode=0,this.msg=""}unmarshall(e){let t=r.default.payload2DataView(e);e=null;let n=new i.default(t,!1);this.appid=n.popUInt32(),this.uid=n.popUInt64String(),this.roomId=n.popUtf8String(),this.rescode=n.popUInt32(),this.msg=n.popString()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(2),r=n(0);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.rescode=0,this.msg=""}unmarshall(e){let t=r.default.payload2DataView(e);e=null;let n=new i.default(t,!1);this.appid=n.popUInt32(),this.uid=n.popUInt64String(),this.roomId=n.popUtf8String(),this.rescode=n.popUInt32(),this.msg=n.popString()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(2),r=n(0);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.rescode=0,this.msg=""}unmarshall(e){let t=r.default.payload2DataView(e);e=null;let n=new i.default(t,!1);this.appid=n.popUInt32(),this.uid=n.popUInt64String(),this.roomId=n.popUtf8String(),this.rescode=n.popUInt32(),this.msg=n.popString()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(2),r=n(0);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.rescode=0,this.msg=""}unmarshall(e){let t=r.default.payload2DataView(e);e=null;let n=new i.default(t,!1);this.appid=n.popUInt32(),this.uid=n.popUInt64String(),this.roomId=n.popString(),this.rescode=n.popUInt32(),this.msg=n.popString()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(2),r=n(0);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.rescode=0,this.msg=""}unmarshall(e){let t=r.default.payload2DataView(e);e=null;let n=new i.default(t,!1);this.appid=n.popUInt32(),this.uid=n.popUInt64String(),this.roomId=n.popString(),this.rescode=n.popUInt32(),this.msg=n.popString()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(2),r=n(0);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.rescode=0,this.msg="",this.attributes={}}unmarshall(e){let t=r.default.payload2DataView(e);e=null;let n=new i.default(t,!1);this.appid=n.popUInt32(),this.uid=n.popUInt64String(),this.roomId=n.popUtf8String(),this.rescode=n.popUInt32(),this.msg=n.popString();let o=n.popUInt32();for(let e=0;e<o;e++){let e=n.popString(),t=n.popUtf8String();this.attributes[e]=t}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(2),r=n(0);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.rescode=0,this.msg="",this.attributes={}}unmarshall(e){let t=r.default.payload2DataView(e);e=null;let n=new i.default(t,!1);this.appid=n.popUInt32(),this.uid=n.popUInt64String(),this.roomId=n.popUtf8String(),this.rescode=n.popUInt32(),this.msg=n.popString();let o=n.popUInt32();for(let e=0;e<o;e++){let e=n.popString(),t=n.popUtf8String();this.attributes[e]=t}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(2),r=n(0);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.attributes={},this.rescode=0,this.msg=""}unmarshall(e){let t=r.default.payload2DataView(e);e=null;let n=new i.default(t,!1);this.appid=n.popUInt32(),this.roomId=n.popUtf8String(),this.uid=n.popUInt64String();let o=n.popUInt32();for(let e=0;e<o;e++){let e=n.popString(),t=n.popUtf8String();this.attributes[e]=t}this.rescode=n.popUInt32(),this.msg=n.popString()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(2),r=n(0);t.default=class{constructor(){this.appid=0,this.roomId="",this.uid="0",this.attributes={},this.rescode=0,this.msg=""}unmarshall(e){let t=r.default.payload2DataView(e);e=null;let n=new i.default(t,!1);this.appid=n.popUInt32(),this.roomId=n.popUtf8String(),this.uid=n.popUInt64String();let o=n.popUInt32();for(let e=0;e<o;e++){let e=n.popString(),t=n.popUtf8String();this.attributes[e]=t}this.rescode=n.popUInt32(),this.msg=n.popString()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1);t.default=class{constructor(){this.appid=0,this.roomId=""}marshall(){let e=new i.default(!1);return e.pushUInt32(this.appid),e.pushUtf8String(this.roomId),e.marshall()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.type="",this.content=null,this.reliable=!0,this.extra=new Map}marshall(){let e=new i.default(!1);e.pushUInt32(this.appid),e.pushUInt64String(this.uid),e.pushString(this.roomId),e.pushString(this.type),"string"==typeof this.content?e.pushString32(this.content):e.pushUint8Array32(this.content),e.pushBool(this.reliable);let t=this.extra.size;e.pushUInt32(t);for(let[t,n]of this.extra)e.pushUtf8String(t.toString()),e.pushUtf8String(n.toString());return e.marshall()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.keys=[],this.noneedbroadcast=!1}marshall(){let e=new i.default(!1);e.pushUInt32(this.appid),e.pushUInt64String(this.uid),e.pushUtf8String(this.roomId);let t=this.keys.length;e.pushUInt32(t);for(let t of this.keys)e.pushUtf8String(t);return e.pushBool(this.noneedbroadcast),e.marshall()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.infos=new Map,this.noneedbroadcast=!1}marshall(){let e=new i.default(!1);e.pushUInt32(this.appid),e.pushUInt64String(this.uid),e.pushUtf8String(this.roomId);let t=this.infos.size;e.pushUInt32(t);for(let[t,n]of this.infos)e.pushUtf8String(t.toString()),e.pushUtf8String(n.toString());return e.pushBool(this.noneedbroadcast),e.marshall()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.extra=new Map}marshall(){let e=new i.default(!1);e.pushUInt32(this.appid),e.pushUInt64String(this.uid),e.pushUtf8String(this.roomId);let t=this.extra.size;e.pushUInt32(t);for(let[t,n]of this.extra)e.pushUtf8String(t.toString()),e.pushUtf8String(n.toString());return e.marshall()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.extra=new Map}marshall(){let e=new i.default(!1);e.pushUInt32(this.appid),e.pushUInt64String(this.uid),e.pushUtf8String(this.roomId);let t=this.extra.size;e.pushUInt32(t);for(let[t,n]of this.extra)e.pushString(t.toString()),e.pushUtf8String(n.toString());return e.marshall()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.ext=new Map}marshall(){let e=new i.default(!1);e.pushUInt32(this.appid),e.pushUInt64String(this.uid),e.pushString(this.roomId),e.pushUInt32(this.ext.size);for(let[t,n]of this.ext)e.pushUtf8String(t.toString()),e.pushUtf8String(n.toString());return e.marshall()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.noneedbroadcast=!1}marshall(){let e=new i.default(!1);return e.pushUInt32(this.appid),e.pushUInt64String(this.uid),e.pushUtf8String(this.roomId),e.pushBool(this.noneedbroadcast),e.marshall()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.infos=new Map,this.noneedbroadcast=!1}marshall(){let e=new i.default(!1);e.pushUInt32(this.appid),e.pushUInt64String(this.uid),e.pushUtf8String(this.roomId);let t=this.infos.size;e.pushUInt32(t);for(let[t,n]of this.infos)e.pushUtf8String(t.toString()),e.pushUtf8String(n.toString());return e.pushBool(this.noneedbroadcast),e.marshall()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1);t.default=class{constructor(){this.appid=0,this.roomId="",this.uid="0"}marshall(){let e=new i.default(!1);return e.pushUInt32(this.appid),e.pushUtf8String(this.roomId),e.pushUInt64String(this.uid),e.marshall()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.keys=[]}marshall(){let e=new i.default(!1);e.pushUInt32(this.appid),e.pushUtf8String(this.roomId),e.pushUInt64String(this.uid),e.pushUInt32(this.keys.length);for(let t of this.keys)e.pushUtf8String(t);return e.marshall()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.props=new Map,this.noneedbroadcast=!1}marshall(){let e=new i.default(!1);e.pushUInt32(this.appid),e.pushUInt64String(this.uid),e.pushUtf8String(this.roomId);let t=this.props.size;e.pushUInt32(t);for(let[t,n]of this.props)e.pushUtf8String(t.toString()),e.pushUtf8String(n.toString());return e.pushBool(this.noneedbroadcast),e.marshall()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.props=new Map,this.noneedbroadcast=!1}marshall(){let e=new i.default(!1);e.pushUInt32(this.appid),e.pushUInt64String(this.uid),e.pushUtf8String(this.roomId);let t=this.props.size;e.pushUInt32(t);for(let[t,n]of this.props)e.pushUtf8String(t.toString()),e.pushUtf8String(n.toString());return e.pushBool(this.noneedbroadcast),e.marshall()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.keys=[],this.noneedbroadcast=!1}marshall(){let e=new i.default(!1);e.pushUInt32(this.appid),e.pushUInt64String(this.uid),e.pushUtf8String(this.roomId);let t=this.keys.length;e.pushUInt32(t);for(let n=0;n<t;n++)e.pushUtf8String(this.keys[n]);return e.pushBool(this.noneedbroadcast),e.marshall()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.noneedbroadcast=!1}marshall(){let e=new i.default(!1);return e.pushUInt32(this.appid),e.pushUInt64String(this.uid),e.pushUtf8String(this.roomId),e.pushBool(this.noneedbroadcast),e.marshall()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId="",this.keys=[]}marshall(){let e=new i.default(!1);e.pushUInt32(this.appid),e.pushUInt64String(this.uid),e.pushUtf8String(this.roomId),e.pushUInt32(this.keys.length);for(let t of this.keys)e.pushUtf8String(t);return e.marshall()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1);t.default=class{constructor(){this.appid=0,this.uid="0",this.roomId=""}marshall(){let e=new i.default(!1);return e.pushUInt32(this.appid),e.pushUInt64String(this.uid),e.pushUtf8String(this.roomId),e.marshall()}}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(e){o(e)}}function a(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(s,a)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(29),s=n(30),a=n(4),u=n(36),l=n(5),c=n(7),d=n(27),h=n(15),p=n(28),f=n(16),g=new l.Logger("PeerService");class m{constructor(e){this.queueEnable=!1,this.queueCount=1,this.peerInfos=[],this.pollTimer=[],this.handlers={},this.mutex=new d.default,this.hummer=e,this.env=c.parseEnvParams(this.userRegion),null!=this.env?(this.addEventListener(),this.start()):g.error("constructor: userRegion error")}get ap(){return this.hummer.ap}get appid(){return this.h5_g_globals.appid}get uid(){return this.h5_g_globals.uid}get h5_g_globals(){return this.hummer.h5_g_globals}get userRegion(){return this.h5_g_globals.userRegion}addEventListener(){this.ap.on(f.AP_EVENTS.CONNECTION_STATE_CHANGED,e=>{this.onConnectionStateChange(e)}),this.ap.on(f.AP_EVENTS.UNICAST,e=>{this.onUnicast(e)})}get cimService(){return`svc_${this.env.area}_cim_${this.env.type}_${this.env.name}_proxy`}initPeerStatus(e){this.peerInfos[e]={queueId:e,hasFirstGetMaxSeqSuccess:!1,receivedMaxSeqId:a.fromNumber(0),maxPushSeqId:a.fromNumber(0)}}start(){this.onConnectionStateChange(this.connectState)}get connected(){return this.ap.connectState.state==c.ConnectionState.CONNECTED}stop(){this.resetTimer(),this.queueEnable=!1}get connectState(){return this.ap.connectState}getFirstMaxSeqId(e){return i(this,void 0,void 0,(function*(){if(!e)return;const t=c.getMutexKey(c.MutexKey.getMaxSeqId,e.queueId);try{yield this.mutex.wait(t),this.mutex.lock(t);const n=yield this.getMaxSeqId(e.queueId);g.log(`getMaxSeqId[${e.queueId}]: maxSeqId=`,n,typeof n.maxSeqId),n&&0===n.code&&(e.receivedMaxSeqId=n.maxSeqId,e.hasFirstGetMaxSeqSuccess=!0,g.debug(`getMaxSeqId[${e.queueId}]: receivedMaxSeqId=`,e.receivedMaxSeqId),this.pullMsgIfAny(e.queueId),this.pollTimer[e.queueId]||(this.pollTimer[e.queueId]=setInterval(this.pullMsgPeriod.bind(this),3e5,e.queueId)))}catch(t){g.warn(`getFirstMaxSeqId[${e.queueId}]: e=`,t),setTimeout(this.getFirstMaxSeqId.bind(this),2e3,e)}finally{this.mutex.unlock(t)}}))}onConnectionStateChange(e){switch(e.state){case c.ConnectionState.CONNECTED:this.initQueue().catch(e=>{g.warn("onConnectionStateChange:",e)}),this.pullMsgPeriodForQueue();break;case c.ConnectionState.DISCONNECTED:e.reason===c.ConnectionChangeReason.LOGOUT&&this.stop()}}pullMsgPeriodForQueue(){if(this.queueEnable){g.debug("pullMsgPeriodForQueue");for(let e of this.peerInfos)setTimeout(this.pullMsgPeriod.bind(this),200,e.queueId)}}onUnicast(e){const t=this.decodeUnicastRes(e);if(t instanceof o.proto.IMPushMsgRequest){g.debug("onUnicast: res=",t);const e=t.queueId||0;if(!this.isValidQueueId(e))return void g.warn(`onUnicast: queue[${e}] not exists`);this.onReceivePushMsgRequest(t,this.peerInfos[e])}else t instanceof o.proto.UnreliableIMPushMsgRequest?(g.debug("UnreliableIMPushMsgRequest:",t),t.msg instanceof o.proto.UnreliableMsg&&this.notifyUnreliableMessageListener(t)):g.log("ignore this unicast msg")}onReceivePushMsgRequest(e,t){g.debug(`PeerService[${t.queueId}]: receive IMPushMsgRequest:`,e),"SignalService/P2P"===e.topic&&e.region===this.env.region&&e.envType===this.env.type&&e.envName===this.env.name?(t.maxPushSeqId=e.seqId,t.hasFirstGetMaxSeqSuccess?this.pullMsgIfAny(t.queueId).catch(e=>{g.warn("pullMsgIfAny failed:",e)}):g.log("receive push msg. but wait for first get max seq success")):g.log("ignore IMPushMsgRequest as it not match topic or env:",this.env)}pullMsgIfAny(e){return i(this,void 0,void 0,(function*(){let t=this.peerInfos[e];if(!t)return;const n=c.getMutexKey(c.MutexKey.pullMsg,t.queueId);try{yield this.mutex.wait(n),this.mutex.lock(n);const e=yield this.pullMsgOnce(t);e&&e.hasMore&&(g.info("has more. schedule a new pull"),setTimeout(this.pullMsgIfAny.bind(this),100,t.queueId))}catch(e){g.warn("pull msgs: ",e)}finally{this.mutex.unlock(n)}}))}notifyMessageListener(e){for(const t of e.msgs)if(t.action==o.proto.Action.kNotifySignalMessage){let e=o.proto.SignalMessage.decode(t.content),n={message:{type:e.type,data:e.content,appExtras:this.filterInnerKeys(e.extensions),serverReceivedTs:t.timestamp.toString()},fromUid:e.fromUid.toString()};this.emit(f.PEER_EVENTS.MESSAGE_FROM_USER,n)}else g.warn("unexpected action:",t.action)}notifyUnreliableMessageListener(e){if(e.msg.action==o.proto.Action.kNotifySignalMessage){let t=o.proto.SignalMessage.decode(e.msg.content),n={message:{type:t.type,data:t.content,appExtras:this.filterInnerKeys(t.extensions),serverReceivedTs:e.msg.timestamp.toString()},fromUid:t.fromUid.toString()};this.emit(f.PEER_EVENTS.MESSAGE_FROM_USER,n)}else g.warn("unexpected action:",e.msg.action)}pullMsgOnce(e){return i(this,void 0,void 0,(function*(){if(!e.hasFirstGetMaxSeqSuccess)return g.log("the first GetMaxSeq request it not finished yet. wait"),null;const t=yield this.pullMsg({startSeqId:e.receivedMaxSeqId,queueId:e.queueId,limit:c.SIZE_LIMIT});return t.maxSeqId instanceof a&&t.maxSeqId.greaterThan(0)?(e.receivedMaxSeqId=t.maxSeqId,g.log(`pullMsgOnce receivedMaxSeqId[${e.queueId}] is updated to`,e.receivedMaxSeqId.toString())):g.log(`pullMsgOnce[${e.queueId}]: has_more=`,t.hasMore),t instanceof o.proto.PullMsgResponse?(this.notifyMessageListener(t),t):(g.log("pullMsgOnce: unkown sys msg"),null)}))}pullMsgPeriod(e){return i(this,void 0,void 0,(function*(){const t=this.peerInfos[e];if(!this.connected||!t)return;const n=c.getMutexKey(c.MutexKey.pullMsg,t.queueId);try{yield this.mutex.wait(n),this.mutex.lock(n);const e=yield this.pullMsgOnce(t);e&&e.hasMore&&setTimeout(this.pullMsgPeriod.bind(this),100,t.queueId)}catch(e){g.warn("pullMsgPeriod: ",e)}finally{this.mutex.unlock(n)}}))}decodeUnicastRes(e){return s.default.decodeUnicastRes(e)}decodeRouteRes(e){return s.default.decodeRouteRes(e)}getMaxSeqId(e=0){return i(this,void 0,void 0,(function*(){const t=o.proto.GetMaxSeqIdRequest,n=t.create({logId:this.generateLogId(),appId:a.fromNumber(this.appid),selfUid:a.fromString(this.uid),topic:"SignalService/P2P",queueId:e});g.log(`getMaxSeqId[${e}]: req=`,n,"logId=",n.logId);let i=t.encode(n).finish();const r=yield this.send(this.cimService,"cim.proto.ProxyService.GetMaxSeqId",i);return r instanceof o.proto.GetMaxSeqIdResponse?0===r.code?(g.debug(`getMaxSeqId[${e}] res=`,r,", maxSeqId type=",typeof r.maxSeqId),"number"==typeof r.maxSeqId?{code:r.code,maxSeqId:a.fromNumber(r.maxSeqId)}:{code:r.code,maxSeqId:r.maxSeqId}):(g.warn("getMaxSeqId failed",r),{code:r.code,msg:r.msg}):(g.warn("getMaxSeqId: unexpected response:",r),{code:c.UNKOWN,msg:"unexpected response: "+r})}))}initQueue(){return i(this,void 0,void 0,(function*(){if(!this.queueEnable)try{const e=yield this.getQueueConfig(this.userRegion);if(g.log("initQueue: res=",e),e&&0===e.rescode){this.queueEnable=!0,this.queueCount=r.default.MIN(e.queueCount,c.MAX_QUEUE_SIZE);for(let e=0;e<this.queueCount;e++){this.initPeerStatus(e);let t=this.peerInfos[e];t.hasFirstGetMaxSeqSuccess||this.getFirstMaxSeqId(t).catch(t=>{g.warn(`getFirstMaxSeqId[${e}]: e=`,t)})}}}catch(e){g.warn("initQueue: e=",e)}}))}getQueueConfig(e){return i(this,void 0,void 0,(function*(){const t=o.proto.GetQueueConfigRequest;let n=t.create({logId:this.generateLogId(),appId:a.fromNumber(this.appid),region:e,selfUid:a.fromString(this.uid)});g.debug("getQueueConfig: req=",n,"logId=",n.logId.toString());let i=t.encode(n).finish();const r=yield this.send(this.cimService,"cim.proto.ProxyService.GetQueueConfig",i);return r instanceof o.proto.GetQueueConfigResponse?(g.debug("getQueueConfig: res=",r),{rescode:r.code,msg:r.msg,queueCount:r.queueCount}):(g.warn("getQueueConfig: unexpected res=",r),{rescode:c.UNKOWN,msg:"unexpected response: "+r})}))}sendMessageToUser(e){return i(this,void 0,void 0,(function*(){if(!r.default.isUint64String(e.receiver))return Promise.reject({rescode:c.kInvalid_Parameters,msg:c.INVALID_PARAMETERS});let t="yes";t=e.option?e.option.reliable:"yes";const n=o.proto.P2PSignalRequest;let i=n.create({logId:this.generateLogId(),appId:a.fromNumber(this.appid),fromUid:a.fromString(this.uid),toUid:a.fromString(e.receiver),type:e.type,content:e.content,option:{reliable:t},uuid:u.v4(),extension:e.extension,extensions:e.appExtras});g.log("sendMessageToUser: req=",i,"logId=",i.logId.toString());let s=n.encode(i).finish();const l=yield this.send(this.cimService,"cim.proto.ProxyService.P2PSignal",s);return l instanceof o.proto.P2PSignalResponse?{rescode:l.code,msg:l.msg,timestamp:l.timestamp.toString()}:(g.warn("sendMessageToUser: unexpected res=",l),{rescode:c.UNKOWN,msg:"unexpected response: "+l})}))}pullMsg(e){return i(this,void 0,void 0,(function*(){if(r.default.isEmpty(e.startSeqId))return{code:c.UNKOWN,msg:"start_seq_id is empty!"};if(0===e.limit)return{code:c.UNKOWN,msg:"limit is zero!"};let t;t="string"==typeof e.startSeqId?a.fromString(e.startSeqId):e.startSeqId;const n=o.proto.PullMsgRequest;let i=n.create({logId:this.generateLogId(),appId:a.fromNumber(this.appid),selfUid:a.fromString(this.uid),exclusiveStartSeqId:t,limit:e.limit,statisDeliveryDelay:!0,topic:"SignalService/P2P",queueId:e.queueId});g.log(`pullMsg[${e.queueId}]: req=`,i);let s=n.encode(i).finish();const u=yield this.send(this.cimService,"cim.proto.ProxyService.PullMsg",s);return u instanceof o.proto.PullMsgResponse?0===u.code?(g.log(`pullMsg[${e.queueId}]: res=`,u),u):(g.warn("pullMsg failed",u),{code:u.code,msg:u.msg}):(g.warn("pullMsg: unexpected res=",u),{code:c.UNKOWN,msg:"unexpected response: "+u})}))}queryUsersOnlineStatus(e){return i(this,void 0,void 0,(function*(){if(!r.default.isUint64StringArray(e.uids))return Promise.reject({rescode:c.kInvalid_Parameters,msg:c.INVALID_PARAMETERS});const t=r.default.Uint64StringToLongArray(e.uids),n=o.proto.BatchCheckUserIsOnlineRequest;let i=n.create({logId:this.generateLogId(),appId:a.fromNumber(this.appid),selfUid:a.fromString(this.uid),uids:t});g.log("queryUsersOnlineStatus: req=",i);let s=n.encode(i).finish();const u=yield this.send(this.cimService,"cim.proto.ProxyService.BatchCheckUserIsOnline",s);if(u instanceof o.proto.BatchCheckUserIsOnlineResponse){if(g.debug("queryUsersOnlineStatus: res=",u),0===u.code){const t=r.default.LongToUint64StringArray(u.onlineUids),n=this.onlineUidsToStatus(e.uids,t);return{rescode:u.code,msg:u.msg,onlineStatus:n}}return{rescode:u.code,msg:u.msg}}return g.error("BatchCheckUserIsOnline: unexpected res=",u),{rescode:c.UNKOWN,msg:"unexpected response "+u}}))}onlineUidsToStatus(e,t){let n={};return e.forEach(e=>{n[e]=-1!==t.indexOf(e)}),n}isValidQueueId(e){return!!(e<this.queueCount&&this.peerInfos[e])}resetTimer(){for(let e of this.pollTimer)e&&clearInterval(e);this.pollTimer=[]}filterInnerKeys(e){const t={},n=["hmr_offline","hmr_timestamp"];for(let i of Object.keys(e))-1===n.indexOf(i)&&(t[i]=e[i]);return t}send(e,t,n){return this.h5_g_globals.bLostConnection?Promise.reject({rescode:c.kOperationTimeout,msg:c.OPERATION_TIMEOUT}):new Promise((r,o)=>i(this,void 0,void 0,(function*(){try{const i=yield this.ap.sendData(this.appid,e,t,n),o=this.decodeRouteRes(i);r(o)}catch(e){o(e)}})))}}t.default=m,c.applyMixins(m,[h.Emitter,p.Base])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1);t.default=class{constructor(){this.appid=0,this.roomIds=[]}marshall(){let e=new i.default(!1);e.pushUInt32(this.appid);let t=this.roomIds.length;e.pushUInt32(t);for(let t of this.roomIds)e.pushUtf8String(t);return e.marshall()}}}]).default}));